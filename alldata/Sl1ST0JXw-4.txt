wait so how do I take it off now ah I've been in the market for a new smartwatch recently because the one that I have makes me look way too cool instead of buying a new 700 smart watch I decided to use an Arduino I had laying around the house which cost me about 20 bucks I figured I could use the array of 8 by 12 LEDs to display the time which I could pull off the internet using the esp32 over Wi-Fi to power it I could use an external power supply like a battery and uh yeah we should be good to go to get started we'll need a source of time and preferably one with less ads luckily we can do that pretty easily using the esp32 that's on the Arduino this board has a full IP stack and an SDK that allows us to create UDP packets so we can send an ntp request ntp being a network time protocol not nacho time protocol which got me laughed out of the DMV anyway the esp32 STK for Arduino makes this really easy so all I have to do is initialize a buffer for our packet data and free a UDP packet in that packet we'll set it all to zero and set some ntp specific data like what stratum we need the polling interval of our clock and then set up that packet to go to our ntp server on Port 123. we'll send the packet to the server and wait for a response for a second and if we get one we'll clear out our LED frame space and read the UDP data now I'm going to be honest I stole this algorithm off the internet all it does is it converts the data from our response into Unix epic time or the amount of seconds that have occurred since 1970 January 1st which I'm pretty sure is the day that Linus torvald rose from the dead anyway using the Arduino serial monitor we can print those out and see okay cool it's 723 but now we have another problem how do we convert that hour and minute into a format that we can use and display on the LED Matrix now the Arduino LED Matrix has a really nice API where you can draw predefined pictures but we have to put numbers on this display and manually bit banging numbers is kind of complicated it took me a while to figure these out but luckily the Arduino IDE has an LED editor online where you can create cool animations like this and actually output them as code this sequence of numbers is the numerical representation of an animation that I'm going to use to show when we're waiting for our ntp response and here it is kind of cool just three dots going across the screen now for the clock itself I wanted to do what is called a bitmap or a literal map of single bits that represent the pixels on the LED screen this gives me more granular control that I can use to draw exactly what I want on the screen I use the LED Matrix Editor to kind of help me out and figure out what pixels I need to illuminate but eventually wrote functions that account for creating a single number on the screen here for example my set one function sets the specific values that need to be turned on for the number one to appear in the bitmap and so when I render this bitmap the one does appear but I have to be able to display four digits so how do I do that in a way that is good modular code now I could write code where I have have multiple functions per digit like set one at one set two at two Etc but this code absolutely sucks it would become extremely hard to maintain there's got to be a better way well by adding a position variable into my function I can have the x value be offset by three to account for the four possible digits on the LED display by doing this I can use the same code in positions 0 1 2 and 3 to display four ones using that same logic I created 10 functions that are able to display the digits 0 through 9 on the LED display at positions 0 through 3. so now I can display an arbitrary time on the LED Matrix great we're making progress so here we go 1719 a random time that I chose to prove that I could render arbitrary digits on The Matrix but now comes the hard part actually writing good code I have to take the hours and minutes from the ntp server and use that to determine what function to call to display our digits on the LED Matrix now I could do it this way where I make an infinitely long list of if statements where I say if hour equals zero do this else if R equals one and but God I hate this kind of code so I'm going to do it a different way I decided to organize all the functions responsible for rendering digits on the display into a function pointer table where if you call the zero with function it renders a zero the first function A1 Etc with this logic we can use some basic modulo math in index into our function pointer table by the hours one place the hours 10 place and then do the same thing for the minutes we'll render that bitmap to the screen and then wait 10 seconds and do it all over again set another ntp packet render the packet Etc now there is a problem that if I leave my house and my Wi-Fi disconnects this watch will not work but luckily that won't be a problem because I have a good solution no I just don't leave my house at this point we have a pretty cool watch we turn it on and it shows us the I'm loading animation and then it renders the time and it'll automatically update every minute on the minute but this isn't really a smart watch this is a watch so I wanted to add additional features to kind of spruce it up and make it the real smart watch that I know it could be so I bought a 20 heart rate monitor off Amazon and wanted to see if I could integrate it into the watch the monitor is pretty simple it has three wires ground power and Signal it will output how much light it sees when this green light is bounced off your skin it uses the color green because obviously that's the opposite of blood and it can figure out how much light gets absorbed by your blood and you use that to figure out your heart rate the end result is when I put this on my wrist the device outputs an analog value that I can read with the Arduino to get a sense of how fast my heart is beating now because all the sensor is doing is reporting the amount of light that it sees I have to implement a little bit of logic to actually convert that to beats per minute so we start out by measuring the time currently on the device before we measure 500 cycles for every cycle we measure the current amount that the sensor sees and if it goes over some threshold and we haven't seen a beat yet we consider that one beat and then say that a beat has been seen and then if it goes below that threshold and we have seen a beat we turn that trigger off basically this allows us to see the top and bottom of a heartbeat graph from there we measure how much time has passed and how many beats that we've seen over the course of that duration and convert that to a beats per minute value from there we convert our float beats per minute to an INT beats per minute and then render it on the device just like we did with the clock we'll do this every five seconds while the ntp packet comes back from the server and of course this wouldn't be a fun project without setting a heart and finally the build begins found this strap that I put through the Arduino case and I can use that to actually pretty cleanly put it on my wrist now I need to put the battery somewhere so duct tape should probably work pretty good if you plug it in we wait for it to connect and there we go 1256 is the time and I get 57 beats per minute I'm actually really surprised how accurate this heart rate monitor is now all we have left to do is go try it outside oh yeah right there's no Wi-fi okay anyway guys I had a blast making this video If you enjoyed this and want to see more builder videos leave a comment and let me know then go watch this other video where I built something wacky all right