You may have heard that there's no formula But that's not exactly true! In 1964, C. P. Willans found this beast of We'll break it down into pieces, but feel free or for it to digest you. Its components are all basic arithmetic and along with some 1s and 2s and this pi sitting And somehow this particular assemblage of that have nothing to do with primes on their own actually computes primes. Plug in 1, and it gives you the 1st prime. Plug in 4; it gives you the 4th prime. Plug in 1000; it gives you the 1000th prime. So what kind of sorcery is this? are supposed to be kind of randomly so there shouldn't be a formula for them. But on the other hand, if you type Willans' it really does compute primes for you, before precision starts to become an issue. Symbolic software like Mathematica The thing is, it's not particularly fast. And this is a hint about what the formula So let's see how it works, working our way The innermost piece is j-1 factorial. For example, when j is 5, this is Then Willans tells us to add 1 and divide by j. What if we change j to be 6? Add 1 and divide by 6, and we get 121 over 6. Here's a table with more values. Do you see a pattern? When j is a prime, and when j is not a prime and not 1, And this is the secret behind Willans' formula. There's a theorem called Wilson's theorem that says that (j-1)!+1 is divisible by j This implies that when we divide by j, we and a non-integer when j is composite. We've just built a detector for prime numbers! So how do we turn a prime detector We can certainly use a prime detector For example, to compute the 4th prime, we could start checking each using our prime detector. Keep track of how many primes we've seen, Ready? 1 is not prime even though our detector throws it in with primes, so we But after 1, we're good to go. 2 is prime according to our detector, 3 is also prime according to our detector, 4 isn't prime according to our detector. But 5 is, so it's the 3rd prime, and so on. What Willans does is method in a very clever way. Because the thing is, if we were using a standard this with a while loop and a counter to keep But what if we don't have a standard programming Well, Willans was still able to do it, using First, it helps to modify our prime detector rather than integers and non-integers. To convert integers to 1s and non-integers to 0s, What kind of traditional function can distinguish If we look back at the formula, The next operation is to multiply by pi Let's see why this works. Here's a plot of cosine of pi x. It hits is maximum value of 1 at 0, And it hits its minimum value So when x is an integer, and when x is not an integer, cosine This means that the cosine in Willans' formula And it spits out a number strictly between What's next? Then we square the cosine. The negative 1s become positive 1s when we so the squared cosine in Willans' And it's a non-negative number that is strictly Then we take the floor. This leaves the 1s alone and So we get our improved prime It's 1 if j is prime or 1, Isn't it beautiful that this is possible? With this prime detector, we can start counting For concreteness, here's the sum when i is 10. j takes each value from 1 to 10, and the detector contributes a 1 to There are 4 primes in this range, In other words, this is the number of primes In general, if we sum up to i, we'll get the So this whole complicated denominator It just counts primes. But wait; why are we counting primes? Willans' formula is supposed to compute the We just determined that there but we want to determine the 4th prime. Well, that's basically the inverse function The idea is that if we want to know the 4th prime, Is the number of primes up through 1 Is the number of primes up through 2 Eventually the answer will be &quot;no&quot;, and the first time it's &quot;no&quot; So the rest of Willans' formula loops through &quot;Is the number of primes up through and this will tell us when It requires another clever Let's look at the next component, It divides n by the number of primes up through and then raises the whole When we evaluate Willans' formula we're going but this part is actually fix i and think of varying n. Take i to be 10 again; Here is what the curve x over 4 plus 1 to the 1/x We're going to take the so let's see where it reaches height 1. Looks like it's at x equals 5. This makes sense, because when x is 5 What happens to this curve for larger values of x? It looks like it might keep going up, but if we increase the range we see that it hits That means that when we take the floor we'll and 1 for integer values of x greater than 4. The result is that we've just implemented We have a detector for numbers It takes some thought, but you can check for when you change this 4 to other values, In our current example, In general, this will be replaced by This lets us answer the question &quot;Is the number of primes Of course, when we go to use Willans' formula it's not n that will change; because of the summation we're about to get to. So let's rewrite the conditions in this equation so they look more like The condition that n is greater than the number is equivalent to the condition that the nth For example, n is greater than 4 precisely Now reorder each inequality to put the focus on i. This is now a detector for numbers i And from here, it's smooth sailing. The final step (well, almost final) Again let's look at an example. If n is 4, we're letting i go from 1 to 16. For each value of i less than the 4th prime, So overall we end up with 6, But why is it enough to stop the sum at 16? Well, we need to go high enough to guarantee Of course, we're trying to compute the nth prime, A very rough estimate is provided by which was conjectured by Bertrand in 1845 It says that, for every integer there exists a prime number p between m and 2m. That means there's a prime between 2 and 4, another prime between 8 and 16, Since 2 is prime itself, Bertrand's postulate so the nth prime is somewhere less than 2^n. In reality, the nth prime is far less than 2^n, but by now it's pretty clear that Willans So the sum up to 2^n is guaranteed to include Therefore, in general this sum This is why the very last step is to add 1. And there it is. Or do we? In practice, Willans' formula We have a ridiculous sum up to 2^n, evaluating each term in that sum requires and in that sum we have to which involves roughly j multiplications each. So even for reasonably small values of n, In 1982, 18 years after Willans' formula appeared, Herb Wilf (who has yet wrote an article called &quot;What is an answer?&quot;, in which he argues that we should -- by how quickly it produces results. We shouldn't accept an answer to a question the original definition of the thing it is He writes &quot;The point, of course, is that sometimes that is so messy and long, and sign alternations and whatnot, that we may feel the disease Ouch. Wilf doesn't mention but his description hits pretty Willans' formula definitely doesn't pass Wilf's &quot;What is the nth prime number?&quot;, since there are faster and less complicated So... what's the point of Willans' formula? Well, you could think of it as a joke, that is correct but totally useless. But there's something more At its core, Willans' formula isn't telling It's telling us about what's possible to engineer a pinch of trigonometry, and a dollop of number It shows that you can use basic arithmetic and that that programming language is expressive And that's pretty surprising. know anything about divisibility or primality It can tell when a number j is a prime. And it can compute the nth prime number. And in 1964, you wouldn't expect any of that. By the way, essentially nothing seems to be The formula appears in a 3-page article called &quot;On formulae for the nth prime number&quot; And yes, there are other formulas in the article so check it out if you're interested. But Willans has no other I don't even know Willans' first name. Could it be a pseudonym for someone who by writing about useless The article lists &quot;The University, Birmingham&quot; If anyone can dig up more information,