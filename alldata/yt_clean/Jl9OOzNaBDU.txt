Welcome to Jeremy's IT Lab. This is a free, complete course for the CCNA. If you like these videos, please subscribe Also, please like and leave a comment, and of videos. Thanks for your help. In this video we will continue with the topic In the last video, Day 16, we covered the what their purpose is, and the most basic However, that's not really enough information, to be able to understand and use VLANs. That's what we'll cover in today's video. So let's take a look at what we'll cover, exactly. This will be a fairly long video I think, First of all, what is a trunk port? I mentioned trunk ports briefly in the last Whereas an access port belongs to a single VLANs on a single interface. Next, what is the purpose of trunk ports? How are they actually used? Next I will talk about 802.1Q encapsulation. This is an additonal tag added to an Ethernet traffic belongs to on a trunk. Next, we'll go into trunk port configuration, learn a few more commands. Finally, we'll cover 'router on a stick'. It's a bit of an odd name, but this is something It's a more efficient way of performing a separate router interface for every VLAN. So, let's get started. For a quick review, here is the network topology There is a single switch, and three VLANs. All of the switch interfaces are access ports VLAN20, or VLAN30. Three interfaces are used to connect to the For this video, let's use a different network Here's the network topology we'll start This time, there are two switches used. Note that VLAN10, the VLAN for the engineering This is very common, as departments in a company You might have some engineers on one on another floor. We are still using only access ports. There are two links between SW1 and SW2, one There must be a link in VLAN10 between the to both SW1 and SW2, and also because the R1 via SW2. As for the link in VLAN30, it is necessary able to reach R1 via SW2. There is no link in VLAN20 between SW1 and This is because there are no PCs in VLAN20 PCs in VLAN20 can still reach PCs connected Let me demonstrate that inter-VLAN routing. Let's say this PC in VLAN20 wants to send to SW1. It will send the frame with a destination R1 then forwards it back to SW2. Note that this traffic arrived at SW2 on the so it forwards it to SW1 on the VLAN10 connection to the destination PC. So, you can see that, even though there isn't PC in VLAN20 can still send traffic to the inter-VLAN routing. In a small network with few VLANs, it is possible when connecting switches to switches, and However, when the number of VLANs increases, It will result in wasted interfaces, and often each VLAN. You can use 'trunk ports' to carry traffic from Once again, these are different than access ports, which belong to a single VLAN only. Let's take a quick look at how trunk ports So, now I've replaced those separate connections between SW1 and SW2, and SW2 and R1. However, to make it more clear, let's add Okay, so now you can see which VLANs are allowed Remember, these are single physical connections, over each trunk. Let's say this PC in VLAN10 wants to send It sends the traffic to SW2, which then sends Now here's a question. How does SW1 know which VLAN the traffic belongs Both VLANs 10 and 30 are allowed on the interface SW1 know which VLAN it belongs to? The answer is VLAN tagging. Switches will 'tag' all frames that they This allows the receiving switch to know which In fact, another name for a trunk port is an access port is an 'untagged' port. Frames sent over access ports aren't tagged, interface belongs to a single VLAN. If a frame arrives on a switchport in VLAN10, Let's talk about those VLAN tags. There are two main trunking protocols: ISL we call 802.1Q 'dot1q'. ISL is an old Cisco proprietary protocol, 802.1Q. Dot1q is an industry standard Electrical and Electronics Engineers). Remember the IEEE? How about IEEE 802.3? That's Ethernet, another industry standard You will probably NEVER use ISL in the real Even modern Cisco equipment doesn't support For the CCNA, you only need to learn dot1q. You should know what ISL is, but you don't Okay here's an old slide, back from Day Do you remember the fields of the Ethernet If you don't, I recommend going back to time explaining it all again here. However, the reason I am showing this is because two fields of the Ethernet header. So, here's just the Ethernet header. Dot1q inserts a 4-byte, or 32-bit field between Let's take a look. As you can see here, the dot1q tag is inserted or length fields of the Ethernet header. Let's go over some basics. As I just said, the 802.1Q tag is inserted of the Ethernet frame. The tag is 4 bytes, or 32 bits, in length. The tag consists of two main fields. Those are the Tag Protocol Identifier, TPID, The TCI itself consists of three sub-fields. Let's quickly take a look at each field Here's a diagram of the dot1q tag format, Notice that it can be divided into two halves, Also, the TCI can be divided into three sub Okay first up lets look at the TPID field. The field is 16 bits, or 2 bytes, in length, The TPID is ALWAYS set to a value of 0x8100. Remember, 0x just means hexadecimal, so the actual digits. Each hexadecimal digit is 4 bits, so 4 x 4 This value of 8 1 0 0 indicates that the frame As I just showed you, the dot1q tag comes frame. This is where the TYPE field is usually located. When the switch sees this value of 8 1 0 0 Okay, that's all for the TPID field. Next up let's look at the first field of Point. The field is 3 bits in length. It is used for Class of Service, CoS, which networks. Don't worry about this field too much, just Next up is the DEI, Drop Eligible Indicator. This field is just a single bit in length. It is used to indicate frames that can be makes sure more important network traffic Once again, you don't really need to worry know the name and it's basic purpose. Okay, finally is a very important field, the It is 12 bits in length. It is the field that actually identifies the this is the most important field of the dot1q Because this field is 12 bits in length, that 2 to the power of 12 equals 4096. However, the first and last VLANs, 0 and 4095, Therefore, the actual range of VLANs that By the way, Cisco's proprietary ISL, which over trunk connections, also uses a VLAN range As I mentioned before, however, you don't completely replaced by the industry standard So, those are the fields of the dot1q tag. Take a look at this diagram, do you remember function? If you want to read a little bit about dot1q, for a solid overview of it. Okay let me talk about the VLAN ranges a little The range of VLANs, which as I mentioned is 'normal VLANs', which are numbered from 1 to from 1006 to 4094. Some older devices cannot use the extended that modern switches will support the extended I work with Cisco switches a lot in my job, doesn't support the entire range, from 1 Just be aware that some older switches might Okay, so let's look at this diagram once again. So, this PC in VLAN10 wants to send The traffic goes to SW2, which then forwards traffic belongs to VLAN10. SW1 receives the frame, and because the destination to the destination. Remember, a standard layer 2 switch like this it will not forward traffic between VLANs. Let me introduce another concept of dot1q. Dot1q has a feature called the NATIVE VLAN. Cisco's ISL does not have this feature, The native VLAN is VLAN 1 by default on all configured on each trunk port. It's important to remember that this has a global configuration on the switch. Now, what exactly does the native VLAN do? The switch does not add an 802.1Q tag to frames It will forward the frame normally, without So, what does the receiving switch do when port? When a switch receives an untagged frame on to the native VLAN. So, it's very important that the native Switches will still forward traffic if there occur. Let's look at an example. This time, let's say I've configured the between SW1 and SW2. Let's follow some traffic on the same path This PC sends the traffic to SW2. It will send the traffic to SW1, but because tag it as being in VLAN10. The untagged frame arrives at SW1, which assumes forwards it to the destination. This time, let's look at if there is a native On SW2's interface I've configured VLAN10 However, on SW1's interface I've configured Let's see what happens. Up to the point the traffic reaches SW1, it's However, when SW1 receives the frame this This frame has no VLAN tag. Therefore, it must belong to VLAN30. But, the destination is in VLAN10, not VLAN30. So, I won't forward the frame. So, I think you can see why it is important between switches. Okay, let's finally get into the I've added the interface numbers to the So, we will be configuring G0/0 on SW1, Let's go on SW1 first. First let's look at the most basic trunk as a trunk. After entering interface configuration mode, manually configure the interface as a trunk. However, in this case we got an error message. Command rejected, an interface whose trunk to 'trunk' mode. This is a little tricky. Many modern switches do not support Cisco's They only support dot1q. Even though ISL is a proprietary Cisco protocol, only dot1q. However, switches that do support both dot1q example) have a trunk encapsulation of 'Auto' To manually configure the interface as a trunk to 802.1Q or ISL. On switches that only support dot1q, this After you set the encapsulation type, you So, let's see how to set the encapsulation You use the SWITCHPORT TRUNK ENCAPSULATION I used the question mark to see the options. There are dot1q, isl, and negotiate. Negotiate sets it to AUTO mode, so we cant I will talk more about AUTO mode in the next questions I will answer them there. I set the encapsulation to dot1q, and then is accepted. On switches that only support dot1q, you will but on some switches you will need to set I used the SHOW INTERFACES TRUNK command to First up, the trunk interfaces are listed 'Mode on' means that the interface was manually In the next lecture we will look at how a configuration, but we'll forget about that Encapsulation is dot1q as we configured, status mentioned before, is the default of 1. Under that, the VLANs allowed on the trunk By the default, ALL VLANs, 1 to 4094, are However, for security purposes, we might want trunk, so we'll look at that configuration next. Next up is VLANs allowed and active in management This includes the default VLAN of 1, as well on this switch. Note that, although VLAN1, which exists by which I showed you in the previous lecture As I mentioned before, don't worry about modern networks. The last field of the SHOW INTERFACES TRUNK state and not pruned'. I'll talk about this in a future lecture, pruning yet. Here is the command to configure the VLANs SWITCHPORT TRUNK ALLOWED VLAN, and then there WORD allows you to simply configure the list Let's see how that works. So, I used the command SWITCHPORT TRUNK ALLOWED Notice that the SHOW INTERFACES TRUNK command on the trunk. Now let's take a look at the ADD option. This allows you to add allowed VLANs to the Currently VLANs 10 and 30 are allowed, let's hosts in VLAN20 are connected to SW1. This time I used the command SWITCHPORT TRUNK The SHOW INTERFACES TRUNK command now shows added to the list. Note that, because I haven't actually created displayed in the VLANs allowed and active Next up I'll show you the 'remove' option. VLAN20 isn't necessary on this trunk, so I used the command SWITCHPORT TRUNK ALLOWED Now, as you can see, VLAN20 has been removed VLANs 10 and 30. Next up lets look at the ALL option. I think this one is fairly obvious, but lets This time I used the command SWITCHPORT TRUNK Now all VLANs are allowed on the trunk. This is the same as the default state, as Next up lets look at the EXCEPT option. It allows all VLANS except the ones you specify. Let's check it out. I used the command SWITCHPORT TRUNK ALLOWED As you can see it allows all VLANs except Okay, finally let's look at the NONE option, This time I used the command SWITCHPORT TRUNK are allowed on the trunk. This effectively allows no traffic to pass settings we want for this network. Here's the diagram once more. SW1 has hosts in VLAN 10 and VLAN 30 connected No hosts in VLAN20 are connected, so there's SW1 and SW2. So, let's set the allowed VLANs to 10 and Okay, there we go. Now the only VLANs allowed on the trunk are The reason to do this is for security purposes, VLANs can use that connection. Also, for network performance purposes, this and such in other VLANs won't be sent over Now, I said I'd show you how to change the For security purposes, it is best to change Network security will be explained more in-depth This video is already getting long so I won't about limiting unnecessary traffic in the Also, remember to make the native VLAN match Now let's look at how to change the native The command to change the native VLAN is SWITCHPORT I chose an unused VLAN, 1001. As you can see, the native VLAN has now been After configuring this trunk port, I did the SHOW VLAN BRIEF command. Notice that G0/0 is not listed anywhere. Not in VLAN10 or VLAN30, even though those are the VLANs allowed on the trunk. This is because the SHOW VLAN BRIEF command shows the access ports assigned to each VLAN, not the trunk ports that allow each VLAN. Use the SHOW INTERFACES TRUNK command instead to confirm trunk ports. Now that we've seen the configurations on SW2 as well. On SW2's G0/0 interface, we must allow VLANs On SW2's G0/1 interface, however, we must Here are the configurations for SW2's G0/0 These are the same as before, so I won't go You can pause the video if you want to take a look Now let's move on to G0/1, which is connected Okay, here are the configurations. Almost identical to G0/0, except I allowed Now, both G0/0 and G0/1 are displayed in the So, that's all for the switch configurations However, you may be wondering about the router. In the previous lecture, we used three separate R1, and assigned a separate IP address to Each one served as the default gateway address However, now we are using only one physical So, we must use 'subinterfaces' on Let's take a look. First of all, look at the title of the slide. ROUTER ON A STICK, also written as ROAS. It's a bit of a strange name, but it's routing, as there is only a single physical and it looks like a 'stick' on the network So, in this case that one physical interface It's connected to G0/1 on SW2. But, we can actually divide this one physical which will allow us to perform inter-VLAN So, it would look like this. G0/0.10 for VLAN10, G0/0.20 for VLAN20, and These three logical subinterfaces are really to SW2's G0/1 interface, but they can operate Before we look at the router configurations, configurations on SW2. We already configured G0/1 as a trunk, and That's all you need to do on the switch, configure Now let's look at the router configurations. Here are the configurations. First, make sure the interface is enabled are disabled by default. Next up is the first subinterface. Notice how to enter subinterface configuration Interface g0/0 DOT 10. This subinterface number does not have to However it is highly recommended that they If each subinterface's number matches the is used for each VLAN. The next command after that is ENCAPSULATION is 10 in this case. This tells the router to treat any arriving as if they arrived on this sub interface. If a frame arrives tagged with VLAN10, R1 G0/0.10. It will also tag all frames leaving this subinterface Finally, after the encapsulation dot1q command, Once again, I have assigned the last usable And that's all for this subinterface. Then I did the same thing with the other two Again, I made the subinterface and VLAN numbers of each subnet as the IP address of the subinterface. If you confirm with the SHOW IP INTERFACE subinterfaces appears, as well as the physical itself has no IP address assigned to it. And here is the routing table. Notice the connected and local routes are to regular physical interfaces. When R1 sends frames out of these subinterfaces, For example, if a packet arrives destined the packet out of it's G0/0 interface tagged Okay, let's review the important points ROAS is used to route between multiple VLANs switch. The switch interface is configured as a regular The router interface is configured using subinterfaces. You configure the VLAN tag and IP address The router will behave as if frames arriving subinterface configured with that VLAN tag. Finally, the router will tag frames sent out on the subinterface. Now that we have configured the router, let's routing works with these subinterfaces. This PC in VLAN10 is trying to reach this The frame is sent to SW2. SW2 sends the frame on its G0/1 interface R1 receives it on its G0/0 interface, identifying because of the VLAN10 tag. The destination is in the subnet 192.168.1.128/26, so it sends the frame out of its G0/0 interface. It tags it as VLAN30 because that is what SW2 then forwards it to SW1, tagging it as SW1 then forwards the frame to the destination. Okay, let's quickly review before moving I think I say this after every video these this video. Please rewatch certain parts of the video materials to help you practice and review First off, we answered the question WHAT IS It's a switch interface that carries traffic We also answered what the purpose of a trunk It allows switches to forward traffic from instead of having to use a separate physical I also introduced 802.1Q encapsulation, which and is used to identify which VLAN the frame I showed how to configure trunk ports on a type, allowed VLANs, and native VLAN. Finally, I showed you how to configure ROUTER subinterfaces on a single physical interface, VLANs and subnets to be routed without having one. It's like a trunk port on a router. Finally, let's move on to today's quiz. First up, question 1. You want to configure SW1 to send VLAN10 frames a trunk. Which command is appropriate? A, encapsulaton dot1q 10. B, switchport trunk allowed vlan 10. C, switchport trunk allowed vlan add 10. D, switchport trunk native vlan 10. Pause the video to think about your answer. The answer is D, switchport trunk native VLAN10. A, encapsulation dot1q 10 is used on a router to. B and C are used to modify the VLANs allowed D is used to specify the native VLAN, and over the trunk. Next let's go to question 2. After modifying the VLANs allowed on a trunk state. Which command will do this? A, switchport trunk allowed vlan default. B, switchport trunk allowed vlan all. C, switchport trunk allowed vlan none. Or D, switchport trunk allowed vlan 1 and Pause the video to think about your answer. The answer is B, switchport trunk allowed By default all VLANs are allowed on a trunk will return it to the default state. Answer D, by the way, lists the VLANs that different than the VLANs allowed on a trunk Okat, let's go to question 3. You try to configure an interface on a Cisco mode trunk, but the command is rejected. Which command might fix this issue? A, switch port mode trunk. B, switchport trunk encapsulation 802.1q. C, switchport trunk encapsulation dot1q. Or D, switchport trunk encapsulation auto. Pause the video to think about your answer. The answer is C, switchport trunk encapsulation On Cisco switches that support both 802.1Q you want to manually configure the interface encapsulation type with SWITCHPORT TRUNK You could use ISL instead, but ISL is almost Okay, let's go to question 4. Which field of the 802.1Q tag identifies the A, TPID. B, VID. C, TCI. Or D, VLN. Pause the video to think about your answer. The answer is B, VID. VID stands for VLAN ID, it is 12 bits long TPID stands for tag protocol identifier, and the frame as 802.1Q-tagged. PCP stands for priority code point and is VLAN ID. D, VLN, is not a real field of the 802.1Q Let's go to the last question, question You configured switchport trunk allowed vlan appear in the Vlans allowed and active in trunk command output. What might be the reason? A, VLAN10 doesn't exist on the switch. B, the command is invalid. C, the command should be switchport trunk and cannot be used. Pause the video to think about your answer. The answer is A, VLAN10 doesn't exist on If a VLAN doesn't exist on the switch, even appear in the 'Vlans allowed and active in trunk command output. That's all for the quiz. Okay, so as always there will be supplementary There will be flash cards to use with the learned in this video. There will also be a packet tracer practice learned in this video. That will be in a separate video. Before finishing this video, I want to think Thank you to Charlsetta, Lito, Yonatan, Mike, Sidi, Magrathea, and Devin. Sorry if I pronounced your names incorrectly, Extra shoutout to Boson software, I absolutely network simulator, check out the links in Thank you for watching. Please subscribe to the channel, like the with anyone else studying for the CCNA. If you want to leave a tip, check the links I'm also a Brave verified publisher and accept Brave browser. That's all for now.