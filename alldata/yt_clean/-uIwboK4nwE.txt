It's the mid-1930s. And as the economy recovers, more and high-tech device that's transforming how From 1933 on, the percentage of households in It'll reach 90% by 1970. And with rapid adoption in the 1930s, Their infrastructure may not be Do they need more phone lines to or do they have enough already? To answer this question, they need to predict future telephone and on the number of households Several methods have been proposed But in 1937 a Dutch engineer named Kruithof and pointing out ways that their assumptions are Kruithof then proposes a better method. But what Kruithof doesn't realize is that the Mathematically, these numbers won't and even now we don't have a complete picture. To understand Kruithof's method, let's work There are 4 towns: A, B, C, and D. This year, during peak hours, there where the caller lives in town A While those 1030 calls are happening, there are in town B and the receiver lives in town A. Here are the peak volumes between the other towns. These numbers are chosen to make some Notice we're including calls within each town. So for example there are 2000 calls where All this call data fits nicely in a 4 by 4 table, since there are 4 possible towns for So for example the number of is in the entry in the How many total outgoing calls are Well, that's just the rows sums of this table. From town A, there are 2000 + 1030 + 650 How many total incoming Those are the column sums. But next year, more households In town A, the number of households with So we expect the total number of outgoing The total number of incoming calls to In the other towns, telephone adoption 25% in town C, and remain the same in town D. From this information, can we determine the number of peak-hour calls between In other words, what are the Here's Kruithof's method. year's traffic data with this year's traffic Let's increase the precision to We have to fix the row sums because for the most part they We fix the first row sum by scaling the first row. so we multiply each entry by 6000/4000. the third row by 2500/2000, and Now the number of outgoing calls from The number of incoming calls to each To fix this, we scale each column. And then we're done, right? Wrong!, because by scaling the So what can we do? Then we have to scale the columns again. Then the rows, then columns, rows, columns, ... and now both the row sums and the So the entries in this table of the number of peak calls If we're building telephone lines, Great! In addition to predicting telephone traffic, Kruithof's method can also be used to In the 21st century it'll find But mathematically, what are the Take the top left entry: Is it rational? Or maybe it involves a square root? is it expressible in terms of pi? or e? But we don't have general When I first learned about this, my reaction We've been doing mathematics How can we not know what numbers we Well, a couple years ago, I started working on We thought, maybe we can use some And we ended up making We're posting our paper today link in the description. We will get to what this number is exactly. But we have work up to it, because the answer Let's start with 2 by 2 tables, because the then we'll graduate to 3 by 3 tables, and eventually to n by n tables. that the target row sums are all 1 For this table, the row sums are initially So we play the same game. and so on. The entries start to stabilize, and in They seem to be 1/4, 3/4, When the target row sums and column sums are 1 after Richard Sinkhorn, who wrote of Kruithof's earlier work. So in the Sinkhorn limit, each row What about another 2 by 2 table? Again let's iteratively These numbers are a little harder to recognize, might remind you of the square root of 2. Okay, one more. I'll be extremely impressed if They also involve a square root, but For a general 2 by 2 table with positive Sinkhorn limit was found by Nathanson in a paper So this is quite recent. of a d, the square root of b c, the square root Then we divide each of those by the square You can see that the row sums Let's check that it works on this example. and b times c is 36. Sinkhorn limit only involves rational numbers. You can check that Nathanson's formula Here's a question for you to think about: Why are the top left and bottom right And why are the bottom left and top right Okay, what about a larger table? even for 3 by 3 tables it wasn't known Let's see if we can determine it for this example. Start with a healthy amount of precision, and then iteratively scale the Now, there are 9 numbers here But actually it's enough to That's because the scaling process for When the target row sums are all the same it doesn't matter what order the rows So if we start reordering the rows the Sinkhorn limit will just This means that if we had a formula then we would get formulas for all the You can see this symmetry in Nathanson's formula. Well, if we reorder the rows, so we get the formula for the bottom left And if we reorder the columns So for 3 by 3 tables, let's just What is this number? A reasonable guess is that, since Sinkhorn then Sinkhorn limits of 3 by In that case, x would be a so we're looking for 4 coefficients For 2 by 2 tables, there's an analogous top left entry x and then doing What are the coefficients Well, for any given table with positive which is the technical name of a simple relation among a set of real numbers. PSLQ is what Simon Plouffe used to discover the which amazingly lets you compute the nth base-16 The hard part of discovering this formula is possibility that something like this even exists. details, but you look for relations When you get to the values of these four sums, says &quot;Guess what! You just discovered one of the Will we be as lucky with the top When we ask PSLQ for a relation we don't get small values for the coefficients. starting over and using more digits when we So a cubic equation doesn't In an act of desperation, we can hoping that at some point we get less And at degree 6, that's exactly what happens. Now, they're not exactly small, information than the approximation And if we increase the precision of x So that's really strong So x seems to be a solution Of course, x is not the only just like for 2 by 2 Sinkhorn limits the But if compute all 6 solutions, Okay, what about an explicit formula for x, like Well, if this were a degree-3 then there would be a But we've known since the 1820s that there's no general formula using radicals. That's a bit of a shame, because we like formulas. But guess what. The universe doesn't In the 1820s, we learned that formulas solutions of polynomial equations. This polynomial is the exact In 2019, I mentored two high to run PSLQ on a large number of examples Their experiments suggested the entries of the Sinkhorn limit always So why is it degree 6? particular coefficients for the top left entry of We'll answer the second question first. And we got them by solving a system of equations. Suppose the entries of the original table are a_ij Can we determine s_11, the top Well, we know each row sum And each column sum in the Sinkhorn limit is 1. How do we get the Sinkhorn limit? and then the columns by a bunch of numbers then the columns again, matter we can think of it as actually multiplying and then multiplying the columns If we collect all the numbers we multiplied the and similarly let c_1 be the product of all then, in the top left entry, we got from Similarly for the other 8 entries. at the cost of introducing 6 So overall, we have 15 equations. like to eliminate: the 8 s_ij's that aren't If these were all linear equations, we and end up with 1 equation. r's and c's are being multiplied by each other. elimination that works on polynomial equations. we can compute what's called a and this should give us a single equation The problem is it's much slower than computing a Grobner basis takes too much But with some tweaking, we were able And the result is a huge equation of this form. which is what we expected, because s_11 And brace yourself, because here are So is that the answer? a formula for the equation satisfied by But an obvious question is whether one that's maybe, you know, not awful. we can get here that will let us predict what 4 by 4 tables or 5 by 5 tables? To see it, let's first look at and the leading coefficient, b_6. b_6 is the product of 5 factors, This last factor is the determinant of The other factors are determinants of 2 by and two columns from the full matrix. since they all involve a_11, one row is the To write this in a more compact Each of these Deltas stands for a determinant. The upper set in each Delta indicates which and the lower set indicates which columns are For example, this first Delta is the by extracting rows 1 and 2 and columns 1 and 2. If we look at these five Deltas, the only determinant involving a_11 Let's include it for completeness and then a_11 is the determinant of the 1 by 1 And this determinant is obtained by except the first row and first column. So the leading coefficient is essentially The constant coefficient, b_0, is although not quite as impressively! We have a 2 by 2 determinant here, four 1 If we ignore the a_11 to the 5th, the rest are determinants not involving Is it a coincidence that we have five Probably not. Then we have five factors, all with the same form. Each Gamma stands for a_11 times a determinant certain set of columns, and these determinants Just like before, we're missing the determinant involving no rows and no columns -- You can check, from the that the determinant of the 0 by 0 matrix If we multiply by a_11 again, then we So the constant coefficient is essentially Now b_6 and b_0 are completely parallel; are the exactly same, and all that changes Great! What about the other Maybe we can get them by somehow Well, b_6 involves the product and b_0 involves the product So one guess is that b_k involves of the For example, let's look at b_1. The guess is that it involves Well, there isn't just one There are six, because we can choose any one Let's write these six products like this, where in each one we're indicating which So, for example, in M 2 2, the 2 2 factor is We're using M here for &quot;monomial&quot; because maybe, just maybe, we can write a_11 b_1 as a Now, it's hard to appreciate When you're climbing around in the and you're the first people to try to find a You have no idea whether there's even a nice So this guess, like many many others, But, by a huge stroke of luck, it did. In hindsight it feels inevitable, because it let us see the structure It turns out there's exactly one You can actually solve for the missing numbers. The first number is -3, the next four are And it's really nice that the since these four row and column specifications by reordering rows and In other words, they all belong So these four -1s reflect the where the row order and column order And since the number out front it makes sense to combine them into a single term. Here Sigma stands for the sum over the You can check that the other two products and we'll write them with What about the remaining coefficients? Well, first let's rewrite b_6 like this and b_0 like this since none of The remaining coefficients also linear combinations of the appropriate Sigmas. So here's our theorem. These are compact formulas for the satisfied by the top left entry of the As a bonus, there's a beautiful The numbers in the formula Guess what. They're exactly the And the same thing happens for b_2 and b_4. So the coefficients b_6 through b_0 are symmetric. equation contain the same information Remember this number? It's the top left entry of the Using our theorem, we can compute Here's what the theorem gives us. experimentally, just with an extra factor So this theorem gives the coefficients What about our other question? We can make a pretty good guess Remember that each coefficient b_k that do involve the first row and first column first row or first column. the largest that k can be is 6, Okay, but where does this come from? row and first column or excluding we always specify which of the other And how many ways are there to We have to choose the same number of rows so that we can take the determinant. there's only 1 way to do it. there are 2 choices for the row and 2 choices And if we choose 2 of each, we're forced so there's only 1 way to do it. That's where the degree 6 It actually counts something. It's the number of ways to take So what about larger tables? For 4 by 4 tables, what should Assuming the coefficients have the same to take subdeterminants of a 3 by 3 matrix. For 1 by 1, there are 3 choices for so there are 9 determinants. to choose 2 rows is 3, and same for And there's exactly one 3 by 3 determinant. So we expect the entries of a 4 by 4 Sinkhorn We can even work this out This sum adds up the number of j by j And it works out to be the binomial So conjecturally, for n by n tables, the entries of the Sinkhorn limit This means that entries of 5 by 5 Sinkhorn And entries of 6 by 6 Sinkhorn limits For 2 by 2 Sinkhorn limits, if we plug in n = 2, we get 2 choose 1, which is 2. The entries of 2 by 2 Sinkhorn Incidentally, for n = 1 this predicts You can think about why that makes sense. But to get this conjecture for the general degree, we assumed that the coefficients for n by n coefficients for 3 by 3 Sinkhorn limits. For 2 by 2 tables, earlier we wrote out the And its coefficients can That's a good sign. So what are the coefficients in general? Well, we got the equation for 3 by 3 Sinkhorn and we tried to do the same for 4 by 4. But we had a plan B, which was to interpolate the equation from numeric examples For that part of the story, I'll refer entries of 4 by 4 Sinkhorn limits coefficients can be written using the Sigmas. The same seems to be true In fact, for general n by n Sinkhorn limits, we have an almost-formula for the It's not quite a formula because there are some but we think we understand the So what does all this tell us about Kruithof's What's the top left entry in next year's table? This isn't a Sinkhorn limit, because instead we're scaling them to sum to the projected This shouldn't make a big difference Since this is a 4 by 4 table, we next year's table satisfy degree-20 equations, Well, for any particular table, a Grobner basis computation will give And for this table, indeed it We don't know how our formulas for Sinkhorn So we don't have formulas for these That's an open question.