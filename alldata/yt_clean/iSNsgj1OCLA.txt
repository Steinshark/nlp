There is a riddle that it still seems wrong even - You'd think it's an - I feel like you probably - I mean, if you're trying and you're trying to confuse people, you're gonna succeed. (both laughs) - There are a bunch of but I find all of them either So in this video, I'm going to dive deeper and explain it fully. Here is the setup. (suspenseful music) Say there are 100 prisoners Slips of paper containing are randomly placed in 100 One at a time, each prisoner and open any 50 of the 100 boxes, searching for their number. And afterwards, they must leave the room exactly as they found it, and they can't communicate in any way with the other prisoners. If all 100 prisoners find their own number during their turn in the room, they will all be freed. But if even one of them they will all be executed. The prisoners are allowed to strategize before any of them goes into the room. So what is their best strategy? If they each search for then each prisoner has a So the probability that all 100 is 1/2 times 1/2 times 1/2 a hundred times or 1/2 to the power of 100. This is equal to 0.00000000 30 zeros, and then an eight. To put this probability into perspective, two people have a better the same grain of sand from all the beaches and deserts on earth than by escaping this way. But what have I told you there's a way to raise their It improves their odds of a random chance by nearly 30 orders of magnitude. That's like taking a to the diameter of the - But they can only coordinate - Correct? - Is this true? - Yes. - Teach me. - This is not a trick question. The solution just involves an So what is this mathematical strategy? Well, if you don't feel free to pause the video And if you don't come you're in good company. Even the person who came computer scientist Peter Bro Miltersen, he didn't even think of this strategy until a colleague pointed it out. Miltersen, ultimately published where he generously left the solution as an exercise for the reader. So here is the solution. Pretend you are one of the prisoners, when you go into the room, open the box with your number on it, the number on the slip inside but that's okay. Go to the box with that number on it. look at the number inside, then go to the box with that Keep doing this until you find If you find your number, that essentially tells you to go back to the box where you started. It closes the loop of numbers But if you've found your You can stop and leave the room. This simple strategy that all the prisoners - The entire pool has a 30... - Everyone can find their - What? - But how does it work? The first thing to become part of a closed loop. The simplest loop would be a box that contains its own number. If you're prisoner number it contains slip one, then you're done. Your number was part of a loop of one, but you could also have a loop of two. Say box one points to box seven and box seven points back to box one. Or you could have a loop or any length all the way up to 100. The longest loop you all the numbers in a single loop. But more generally, any random arrangement of the slips in these boxes will result in a mixture of some shorter and some longer loops. When you start with a box you are guaranteed to be on the loop that includes your slip. So the thing that you find your slip is If your number is part of a then you will definitely find your slip. But if your number is part of you are in trouble. You won't find it before you've exhausted the 50 boxes you're allowed to search. When you open the box you are in fact starting at the farthest point on You wanna know where is the but to find it, you have to all the way around to the end. That means if the prisoners and the longest loop is 51, not just one or two prisoners will fail to find their number, but all 51 on this loop won't make it. They make it to the box just but they have to stop searching there. (both laughs) So the probability that all is just the probability of a hundred numbers contains Now I promised that this to around one in three, but how do we calculate it? Well, imagine writing down that you could connect of length 100. So you could have box box two points to box three all the way to 100, and then box 100 would or you could have something random. Box five points to box and let's pick the last one, is 63. And box 63 points back to box five. So how many different arrangements or permutations could you have? Well, for the first box, I have 100 different boxes The second box, because I can only pick from 99 boxes, and the next one, I can pick down to the very last box. I don't really have a choice. There's only one box left I So the total number of would be 100 times 99, times 98, times 97, all the way down to one. That is just 100 factorial. There are 100 factorial different ways that you could create a But what we can't forget is that these are not They are loops. So some of these lines that look different are actually the same loop. For example, two, three, up to 100 and then 1 is the same thing as 1, 2, 3, 4, 5 to 100. You can rearrange the way a hundred different ways, but they all represent the same loop. So the total number of is 100 factorial divided by 100. So what is the probability that any random arrangement of 100 boxes will contain a loop of length 100? Well, it's just equal to the that we just calculated, 100 factorial over 100, divided by the total number of ways that you could put a which is 100 factorial. So the answer is 1 over 100. So there is a 1% chance that results in a loop of length 100, and this is a general result. The probability that you is 1 over 99. The probability that you is 1 over 98. So the probability that there is 1 over 51 plus 1 over 52 plus one over 53, et cetera. Add all these up, and it equals .69. There is a 69% chance of meaning a 31% chance of success where the longest loop is 50 or shorter. - I still find it difficult to believe. - [Derek] This feels a bit like magic. Using the loop strategy, all the prisoners are more than even just two prisoners So using the loop strategy, what is the probability finds their number? It is still 50%. Each prisoner can still so their individual chance is still 1/2, but these probabilities are no longer independent of each other. Imagine running this experiment If everyone is guessing randomly, you'd expect that on most would find their number. On lucky runs, the number on unlucky runs, a bit lower. But using the loop strategy, all of the prisoners 31% of the time. And 69% of the time, fewer The prisoners all win together or the majority loses together. That's how this strategy works. - Why are you assuming that on the loop that you're on? - I feel like- - This is a key question, right? - 'Cause I feel like and go on a complete loop and not come back to your own number because you got on the wrong loop and then you'd have to so I don't know that I'd buy this. - Right, right, right, Now, the big question everyone asks is how do you know that if you start with a box with your number on it you are guaranteed to be on the loop that contains your slip? Well, if you think about it, the slip that says 73, they will definitely go to So the slip and box with the same number essentially form a unit. They're like a little Lego brick. And then every slip is So as I start laying out you can see that there's no way that we can end up with a dead end. It's not like you can just because every box contains a slip and that points at another box. So the only way for you to see only boxes when you walk into the room is for every slip to be and that necessarily will mean that we are forming loops. So when I start with box 73, I must eventually find slip 73, because then and only then will I be directed to go back to box 73 which closes the loop. - Who is the warden to this prison? And what kind of sadistic are you dealing with here? This is awful. - Now, what if there is a who sneaks into the room before Well, then they can guarantee by swapping the contents That's because there that is longer than 50, and you can break it in half just by swapping the And now I have two separate loops that are each shorter than 50. But what if there was a malicious guard who figured out that the prisoners were going to use this loop strategy? Well, then they could to ensure they formed In this case, are the prisoners doomed? Surprisingly, no. They can counter by arbitrarily They could, for example, The loops are set both by and by the box numbers. Renumbering the boxes as redistributing the slips. So the problem is back to a meaning the prisoners are back to their 31% chance of survival. Now, what happens if you - Fun fact, nobody knows if as you have more and more prisoners it's going towards a limit, or if it'll eventually - That is my friend Matt Parker, and I think what he meant to say is we know exactly what happens as you increase the number of prisoners. With a thousand prisoners each you might expect their chance of success to drop dramatically, but you can calculate and it comes out to 30.74%, only half a percentage point For 1 million prisoners, the probability of success is 30.685%, which is only a little Of course, their bigger problem would be the time it takes to open all the boxes. So your probability of winning this game does indeed approach a limit. So what is that limit? The formula we've been using is one minus the chance of failure, which is the series 1 and so on, up to 1 over 100. We can depict this series as and there is a curve that follows the heights of these blocks. That curve is one over X. The area under that curve from 50 to 100 approximates the area And as the number of it becomes a better and So to find the probability of failure, we can just take the from n to 2n. And we find that it's equal to This gives a probability of success of one minus the natural log of two, which is about 30.7%. The bottom line is that no matter how many you'll always end up of escaping using this strategy. And that feels really wrong. I mean, at first it seemed for all 100 prisoners But now we're seeing that you could have a hundred, a million, or any arbitrarily large with at least a 30% chance that The beauty of the loop strategy is linking everyone's outcomes together, instead of each prisoner walking in with their own 50-50 shot. Following the same loops the exact same chance as everyone else in their loop. And once the boxes and slips are arranged, that chance is set at either 100% or 0%. With this strategy, you can't with only a few people You can only fail hard Now, if you like solving puzzles even outside of life-threatening well, you'll love Brilliant, Brilliant is a website and app that builds problem-solving skills and guides you through in math and science. They have great courses on tons of topics, from statistics to astrophysics to logic. Now, if you liked this riddle and you want more just like it, I'd recommend their featuring other seemingly impossible odds and even another mathematically They've also got a joy to take you through some of their most delightful math puzzles. Every lesson builds on to give you an in-depth understanding with any course you take. Your knowledge is constantly developed and tested through interactive And if you get stuck, there's Head over to brilliant.org/veritasium to check out all these courses and test your instincts the 100 prisoners riddle. If you click through right 20% off an annual premium subscription to the first 200 people to sign up. So I wanna thank brilliant and I want to thank you for watching.