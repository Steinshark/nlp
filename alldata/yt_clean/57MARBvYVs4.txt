It's time to talk about an old school, undercover Excel formula two LOOKUP problems we can't Problem number one, is on multiple conditions, and number two, is looking up a value to the Now I know I cover a lot of futuristic, superhero formulas like that can do all this, but get these functions soon. So it's time to take a look back, specifically take a look DGET is a database function. It's easy to use once you know the rules. It can be your go to formula So let's take a look. (upbeat music) First of all, we're going DGET with using one criteria and then we're going to use Here I have a list of What I want to to is for the name and I want On this side here, I that I'm going to use for that dropdown. So let's quickly insert Click on the cell where we want it. Go to Data, Data Validation, select List. First Source is sitting right Now one thing I'm going to the Error Alert because you can get DGET to work for In our first example, let's so let's go with Kim West and for Kim West using the DGET formula. So with DGET we get to do a live filter. The formula is really simple once you know what the syntax is. First one is database. This means that your in a tabular format, which needs to have a column header. And the headers are really the DGET formula because you So for database here we Control+Shift+Down, select Now if you're going to you can include more cells, and if you have this already as a table, you just select the entire table. So in this case, this is so I'm just going to add in more cells. The next criteria is the field. What the field means is the column or the information that You have different options of You can either type in numbers based on the position of the column, So in our case what Simple, right, it would just be a one. The other option for field is to actually type in the header or And I'll show you that but let's just do the numbering first. The next argument is the criteria. Our criteria is right to be Kim West. Now the way you give it the criteria is that you need to because the formula needs to know which column in the database and it only knows that if and it matches the header with which means you need to make sure you have the exact same spelling here. That's basically it. Close parentheses and press Enter. Kim West works in the utility division. Now let me show you the One is to hard code division in here. The second way is to do a cell reference. I'm going to type in division here, make sure that the spelling is correct and then reference that cell Now you can get more fields back so if we also want it the department here all we have to do is the correct fixing on the cells so this database shouldn't shift when we pull this formula to the side. So I'm going to fix everything. This one should shift. It should go to department. This one, the criteria, so I'm just going to press F4 on that. Press Enter. Now I can pull the formula across. So we have this sales So here we've seen two One is, you can use it as a live filter, and two, you can LOOKUP to the left. It has no problem doing a left LOOKUP, which is problematic if Now the downside of DGET is this formula down and have it so I can't look for Kim West because when I pull this down, I have the name and the I need to have a separate that's setup like this, so as well as the criteria I'm looking for. So if you're looking for a formula that you need to pull down for divisions and departments then you need to use another formula like Index and Match, or if then you can also use VLOOKUP. And of course, in future the new XLOOKUP function. Now another advantage of DGET is that it does approximate matches so if I don't know the exact I can type this in and it still works. And if I switch this to someone else, so let's go to Daniel Garrett I get productivity and finance for Daniel. One other thing that is also look for OR criteria. This is not going to be So let's say that Kim West gets married to Stevie Bridge and she to Kim Bridge. Now you receive a dataset if, in that dataset, or if she's Kim bridge. You can apply the OR version and the OR version looks like this. You just type in the second name that could be in this dataset, so I now have Kim West and Kim Bridge. We need to update this formula and let's applied to both here. Now I have Kim West in If I happen to have Kim Bridge in there it will work as well. But here's the problem with DGET. If you have duplicate criteria, so if your list is not So lets say I had Kim West I'm just going to update this to Kim West. We get this error, and you have duplicate criteria. And it's not just for OR conditions, it's actually for single criteria as well. So if I just reverse and lets say I had Kim West just copy and paste it So for VLOOKUP or Index and Match you always get back the first match. With DGET you get this error instead. Now let's take a look at using This is a plus for the DGET function because you can lookup multiple values. This is something you can't or with Index and Match. You have to create a unique code or create very complex functions but it's really simple if So here we have division, app and profit, and we want and profit for this region and this app. So basically the combination of these two. All we have to do is type remember it includes the headers, so I'm going to highlight my range. Now since I want to I'm going to fix this reference. Next is the field, my field and then I have the criteria Now region and app the I just have to include them here. Then press F4 to fix it. Close the parentheses and for this combination. So if we scroll down, we see Robert Marquez is the sales manager. Our profit should be 1042. Let's see if we pull this And that's correct. Right, so one thing you again is that you have to make sure that the combination of region and app is unique in your dataset get the #NUM error. Now here's just to recap of the DGET function is that It can also LOOKUP text It can look for OR conditions And it acts as a live filter. The main disadvantage of the DGET function is that you can't apply so which means that you If you need to do that, you like Index or Match or VLOOKUP. Th other disadvantage of DGET is that you get the #NUM error if you have duplicates in your dataset. So you don't get the first match back like other Excel functions. So that's how Excel's DGET function works. It's easy to use but it especially when it comes to applying the formula to many cells. I hope you enjoyed this video. It was a common request on this channel. Give it a thumbs up if you liked it. And subscribe if you're new And I'm going to see (upbeat music)