Hypixel is the largest Minecraft server on the planet, with more than 32 million unique players over the last 11 years - that's more than the population of Australia. You'd think that with that much at stake, their security would be almost impenetrable, right? Well, almost... Yeah, that's nine MILLION DOLLARS worth of gold. Surprisingly, he didn't donate that much. So how did he do it? The short answer is: he logged in as an admin, without their password, and without their token. The admin in question did nothing wrong. This was no phishing attack, that would be far too simple. No, this was an attack specifically targeted and executed against the Hypixel network, meaning he could log in as any admin. To understand how he did this, we need to understand why it should've been impossible. Authentication When you log onto any Minecraft server, there has to be some way for you to prove that you're you, otherwise anyone could log on as you and take all your stuff. Luckily, Mojang thought about this, and implemented an authentication protocol. Basically, when you first load up the launcher and log in with your email and password, your email, (and password) is sent to Mojang's servers, who reply with a secret token that represents you for your current session - the session token. With Microsoft accounts, the process is a little more complicated, but still ends with the same session token being generated. This doesn't contain your email or your password, and is just a secret message that can quickly tell Mojang that it's still you, without needing you to type in your email and password every time you join a server. On the topic of joining, join us by claiming your place under 25k in our race to beat this impersonator pretending to be me. Looking at this totally real graph, you don't have long until that number gets bigger and we all know that a bigger number is less cool. Back to the hacker. "let the hacking begin" Now, Mojang may know that you're you, but how about your friend's SMP server for your latest 2-week Minecraft phase? If you simply sent over your session token for the server to check it's legit, a malicious owner could then save your token, go to any other server, say, Hypixel, and use your token to log in as you and steal all your SkyBlock coins and items. That's... not how it works. There's a form of encryption, known as "asymmetric encryption" where you have a private key, that you don't share, and a public key, that you can. If you encrypt something with the public key, it can only be decrypted with the private key, through some maths magic that I can't explain without my views falling off a cliff. It also works the other way around, where something encrypted with the private key can be decrypted with the public key, which proves that the person sending the message has the private key without revealing it to the receiver. The server creates a private and a public key, and sends its public key to the client. The client generates a random number, called the shared secret, and encrypts that with the public key so only the server can read it. It then makes a sort of password by combining the shared secret with the server's public key, and then sends a hashed version of that password directly to Mojang's servers, along with its session token from earlier. All the server has to do, is make the exact same password from the shared secret and its own public key, and ask Mojang if this player has said they've joined a server using that password. If they have, then according to Mojang this player is who they say they are, and the server lets them in! They also then use the same shared secret to encrypt all of their communication from this point on. Now, if you're the malicious actor trying to log into another server after a player logged into yours, you either need the player's session id, or for the player to tell Mojang that they are connecting to your target's server, and to have access to the shared secret. Now, the session id is kept private in the player's Minecraft client and only sent directly to Mojang's servers, both of which you have no control over. Now, if you wanted the client to tell Mojang they are connecting to your target's server, you'd need to tell them the other server's public key. The issue is, they encrypt the shared secret with that public key, so without the matching private key, you have no chance of getting the shared secret. This authentication system sounds pretty bulletproof, with the only weakness being if you have access to the client's machine to get their session token or password. So, the hacker got access to an admin's computer and stole their session token or something, right? Nope. As I said before, "without their password, and without their token". There's more to the story, but it wasn't an exploit in Mojang's authentication. As it turns out, if a nice friend launched a server, what this hacker did wouldn't work there - your friend's server is, in fact, more secured against this exploit than Hypixel was. So, now we've got a new question: What did Hypixel mess up? Let's start by listing some of the differences between your friends' server and Hypixel itself. Your friends' server is a lot more boring, makes a LOT less money, hasn't been around for 11 YEARS doesn't have four GUINNESS WORLD RECORDS, and has much, MUCH fewer players. At least, assuming your friend isn't an interdimensional lizard operating a server in a parallel universe. None of those differences really seem to explain what happened here - oh. The players. Have you ever wondered how Hypixel can handle tens of thousands of players at once and your SMP server drops you into the deepest recesses of the void the second there's more than 5 people on it? The secret isn't that Hypixel is owned by the US military and they run their Minecraft server on undisclosed advanced technology that the public will get sometime in 2194. No, it's it's that Hypixel isn't a Minecraft server. Or, rather, Hypixel isn't ONE minecraft server. It's actually a ridiculous number of smaller servers working independently, each holding only a few players at once. Whenever you switch island types on SkyBlock, join a new Bed Wars game, or even change lobbies, you're connecting to a new type of server. Except, you don't have to disconnect and reconnect to to bedwars-3.hypixel.net every time, so how are you actually connecting to these different servers? Well, if you've heard of a proxy (or a VPN), whenever you try to visit any server on the internet using a proxy, your request first passes through that proxy on the way out. However, this concept can also work in reverse, with something creatively named a "reverse proxy", where all requests trying to reach a specific server have to go through another server first, acting as the reverse proxy. One of the most well-known examples of this is Cloudflare, which provides DDoS protection by forcing attackers to go through their servers to get to yours, where they can block and reroute traffic to protect your vulnerable website. In Minecraft, the same thing exists, with one of the most popular implementations being "Bungeecord". Basically, you connect to the bungeecord instance, and it decides which Minecraft server to put you on, with the ability to switch you between them at any time. Hypixel uses bungeecord, albeit a heavily-modified version, to provide this functionality. This is the attack vector. The Security Flaw While tight security is fantastic when it comes to making sure bad actors don't cause issues, sometimes it can also come back to bite the good guys, too. Before, I mentioned that a malicious actor has no chance of using a player connecting to their server to connect to another on their behalf. The issue is, that applies to bungeecord, too. The bungeecord proxy cannot trick any of the servers under its control into thinking that the player connected to them rather than it, for the reasons described before. While, yes, technically they could just share a private key, part of the security in the system comes from the fact that each server generates a new pair of keys every time it starts up: it is never saved or reused. If Hypixel broke that system, they'd be threatening the security of their servers in a new, terrible way. Instead, with Bungeecord, you simply have to disable authentication on all of the backend servers that you're sending players to, and use the bungeecord server alone to authenticate players. Bungeecord then tells those servers that these players are legit before they connect, and the servers essentially use that Bungeecord instance as the trusted third party, rather than Mojang. All sounds good, so far. It is also highly recommended that you enable firewalls on all of your backend servers to only allow incoming connections from your proxy. A firewall, even though it sounds like a fancy hacker word that prevents all malware, simply blocks traffic through certain routes. For example, it might block all traffic on port 80 if you don't want to use it as a web server, or only allow your home IP address to access port 80, say if you're running an admin control panel on there. In this case, they could block incoming traffic on all ports, unless it's coming from the IP used as your proxy. Hypixel's firewalls were broken. According to a Hypixel representative, one of their machines suffered a hardware failure, and the machine was brought back online with a misconfigured firewall. Their provisioning tools, which automatically allocate and launch the backend servers, were not able to handle the situation they were faced with. They would later correct this issue, adding more safeguards to stop anything similar happening again. But it only takes one tiny hiccup, one oversight, to cause disaster. With properly configured firewalls, they would've been safe. Hidden In Plain Sight. Even though this firewall wasn't configured correctly, Hypixel still would have been safe, since there are 4.3 billion possible IP addresses, so finding one of their backend servers is like looking for a needle in a haystack. And still, even if someone did find the IP, you still can't connect since you wouldn't have been authenticated by their Bungeecord instance, so you wouldn't have been let in. Trying to find one server in 4 billion seems like an impossible task, but as it turns out, 4 billion isn't that many. There are thousands of servers running scanners of the whole internet, making requests to each IP and logging their responses all the time. Since there was a firewall mistake, Hypixel's servers responded with error codes and data to any request, so by filtering for keywords like Hypixel and Bungeecord on one of these databases, you can quickly narrow down that list of 4 billion IP addresses to a few that match. The hacker found an IP address for one of their backend servers. Well, actually, he found quite a few, but... The Open Ports After finding the IP address of the server, our hacker did what any good pentester would do: a port-scan. Ports are a concept you may have heard of before, but it's hard to wrap your mind around what exactly they are. You can think of an individual computer, or server, like a town, connected to the internet via a highway. A town can have businesses, like restaurants, supermarkets, or phone stores. Each of these businesses has a road leading directly to it, and in this scenario each road can have only 1 business at the end of it. A road can be gated off, or open, and may or may not have a business operating on it. These roads are ports, and the businesses are like programs listening on the computer, accepting new customers. When you do a port scan, it's like trying every single road to gather as much information as you can about it. You can either drive down the road and talk to the application, which would mark the port "open", drive down the road and find no applications listening, which marks the port "closed", or be turned away at the gate, without knowing if there was an application listening or not, which would be called "filtered". Firewalls often mark ports filtered, but in Hypixel's case, the port of the backend server's Minecraft instance was "open", and anyone could try to talk to it. The hacker saw this, and tried to join the server, but was met with an error. This error was the server realising that this player wasn't authenticated through the bungeecord proxy, and so it didn't let him in. This was the last stage of defence, and it was doing its job well. The Exploit What I never addressed earlier was how the server makes sure that the bungeecord instance authenticating the player was specifically Hypixel's instance of bungeecord. In velocity, a popular public fork of bungeecord, they use a secret that only the proxy knows to ensure it's the right one. In the original bungeecord, however? They... don't. The server has no way of knowing that the bungeecord that sent the player is Hypixel's bungeecord - at least not without the BungeeGuard plugin, or something similar that adds this security. Hypixel's servers did not do this. The hacker launched his own version of Bungeecord, set up his configuration to point at the backend server he found, and connected, and... He was in. Of course, he could only log into his own account though, since bungeecord still had to do the authentication before it told Hypixel's servers that he was who he said he was. That was unacceptable. He looked at the source code of bungeecord and built a prototype that let him connect as whoever he wanted. And then he logged in as an admin. Wanting to see what he could do with his power, he also got a friend online to play with. They were able to see performance data, including the number of players online in each world, entities, chunks, and data size. He could see the SkyBlock admin inspection menu, and also found a command that, apparently, "found him 43 friends", whatever that means. But that was child's play, simple boring information that wasn't really of any use to anyone. No, he had to start messing with their data too. He gave himself 1 billion SkyBlock coins. It turns out that there's no easy command to do this from in-game though, so he had to get creative. On your island, there's an NPC called "Jerry". He lets you view patch notes, modify your island properties, remove the hub portal, and receive deliveries, like rewards for testing on alpha. Well, it turns out that there is a command to give deliveries, and so our hacker gave himself lots and lots of coins - a billion. That might not seem like much if you play SkyBlock now, but back then it was kinda crazy to have a billion coins in your purse. He also gave his friend 10 million gold, which is a currency that you can spend on pretty much anything in the Hypixel store. 10 million would cost around ninety-one thousand dollars if you bought the most expensive package on the store over and over again. That's a lot, but he gave himself one BILLION gold, which is worth roughly 9.1 million US dollars. That might just be enough SkyBlock gems to beat swavy. Back to SkyBlock, he also figured out how to give himself a creative mind, but while still logged in as the admin. This resulted in the only admin-to-admin creative mind, but interestingly, shows as if it was a non - a player without a rank. This is actually displayed on our island, /visit TGWaffles, if you want to see it. We discovered it using iTEM, which was a database of every item in SkyBlock. Go watch the video on that if you haven't yet. After finding the item, we were extremely curious as to the story behind it, and how it ended up in the hands of a regular player. So, we got in contact with his friend, who owned the item at the time, and learnt this entire story, along with screenshots and other proof, from him. He kindly decided to donate the creative mind to us for free to display on our museum, which is where it lies today. Anyway, despite all this messing around, neither the hacker or his friend were caught. Until... He decided to give both him and his friend a ridiculous amount of network xp, which put them straight at the top of the network level leaderboards. That was noticed very quickly by another high-level player, who tagged Simon, the owner of Hypixel himself, on twitter. The Aftermath After all the attention, another admin joined a party with them and spoke to them on Discord, where they, as responsible hackers, disclosed the exploit that they used. Hypixel subsequently patched those exploits. They sadly did not get to keep their spoils, losing the millions of dollars worth of gold, network level, and most of their other winnings. They did, however, get to keep the creative mind, so there's that! The hacker screen recorded the entirety of the event as it took place, and most of the screenshots I've shown are just taken straight from that video. While I was trying to contact the hacker again to see if I could get ahold of that video, I discovered that his Discord account had been terminated. Upon further investigation, it turned out that he was behind a rampant Discord token stealer too, and had been stealing people's Discord accounts. Due to the termination, a lot of the messages I had with him were deleted, other than a group chat with my coop members and anything else I saved from our initial conversation. I was unable to get back in contact with him, and his friend turned out to not have anything we didn't already have. Be aware that attempting to do something similar to this hacker is not only against Hypixel's server policies, which could lead to a ban, but more than likely against your government's server policies, which could lead to, well... jail time, unless you're in Russia or something but then you'd probably be better off going after foreign governments, not Minecraft servers. Actually, don't do that, I live there. Instead maybe hack, uh... the subscribe button?