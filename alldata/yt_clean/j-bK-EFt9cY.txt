Welcome to Jeremy's IT Lab. This is a free, complete course for the CCNA. If you like these videos, please subscribe Also, please like and leave a comment, and of videos. Thanks for your help. In this video we will move on to another important for network engineers understand. That is STP, Spanning Tree Protocol. The CCNA Exam Topics list mentions Rapid spanning However, to understand rapid STP, I think So, first we will talk about STP, which will and then in a future video I will teach you about rapid Let's take a look at what we'll cover First, I'll talk about redundancy in networks, Then I will introduce STP, Spanning Tree Protocol. I will introduce its purpose, the problem Also, remember to watch until the end of today's I will once again feature a bonus question practice exams for the CCNA. If you're looking for a set of practice is without a doubt the best there is. I used ExSim for my CCNA and CCNP, so I feel you. If you want to grab a copy of Boson ExSim, Okay let's get started. First, just a few points about redundancy Redundancy is an essential part of network A network that is not redundant is simply Modern networks are expected to run 24 hours Even a short downtime can be disastrous for Imagine if Amazon's network went down for If one network component fails, you must ensure or no downtime. Finally, as much as possible, you must implement network. As network engineers, we are responsible for to make sure that that infrastructure is resilient First off, here is a poorly designed network. There are many points of failure here which For example if this connection is cut loses connectivity to the Internet. Or, if this connection is cut off due to a within the LAN, and out to the Internet. Okay, those are just two examples, let's This network here is a much better design. If this PC wants to reach the Internet, it However, even if this router has a hardware reach the Internet via this or another alternate Perhaps traffic to this other PC in the LAN What if this switch fails? That's not a problem, because this alternate So, I think you can see the benefit of designing However, you may be asking, what if this switch Well, if that is the case, all hosts connected Unfortunately, Most PCs only have a single only be plugged into a single switch. However, important servers typically have multiple switches for redundancy. We will cover many protocols that are used course, and spanning tree is one of them. Spanning tree is a Layer 2 protocol by the so within the LAN here, not routing out to 3. I just showed you the benefits of a redundant provides alternate paths if one connection However, without spanning tree, there is a network. So, where is the problem? Let me introduce the concept of 'broadcast I'll use a simplified network topology to PC1 is 10.0.0.1, PC2 is 10.0.0.2, and PC3 You already know what a switch does with a Let's say, for example, PC1 wants to send some traffic To do that, it needs to know PC2's MAC address. So, let's say PC1 sends an ARP request frame, MAC address of all F's as its Layer2 When SW1 receives the frame, what will it you already know what a switch does with broadcast It will flood it out of all interfaces, except So, SW2 and SW3 both receive a copy of the They then do the same thing, they flood it was received on. So, PC2 receives the ARP request and will All good? Actually no, NOT all good. Although PC2 received the ARP request and remain on the network. I've cleaned up the arrows so you can see As I just said, PC2 received the ARP request frames in the network? The switches will continue flooding them . So, SW1 just received two broadcast frames, on It will once again flood them. Let me clean that up again. SW2 and SW3 both just received broadcast frames, They will flood them. So, I think you get the point. This will continue FOREVER. Do you remember the TTL, or time to live, It is used to prevent infinite loops at Layer But the Ethernet header doesn't have a TTL These broadcast frames will loop around the If enough of these looped broadcasts accumulate for legitimate traffic to use the network. This is called a broadcast storm. Eventually your network will look like this, regular traffic can pass through your network. The red arrows represent the clock-wise loop arrows the counter-clockwise loop. However, network congestion isn't the only Each time a frame arrives on a switchport, to 'learn' the MAC address and update When the frames with the same source MAC address the switch is continuously updating the interface This is known as MAC Address Flapping. So, how can we design a network with redundant Well, Spanning Tree Protocol is one answer So let's take a look at Spanning Tree protocol is an industry standard protocol, IEEE 802.1D. This is the type of STP we will focus on in Rapid STP later. Because it is so important to prevent Layer by default. So, you won't only find STP on Cisco switches. STP prevents Layer 2 loops by placing redundant the interface. These interfaces act as backups that can enter meaning an interface that is currently forwarding, Interfaces in a forwarding state behave normally. They send and receive all normal traffic. However, Interfaces in a blocking state only or Bridge Protocol Data Units), and some other Before going more in depth , let me talk about I told you about Ethernet hubs in a previous Hubs were used before switches were invented, frames to the correct destination, they simply But actually, before switches, there was another You don't need to know about bridges for they're like a transitional stage between However, the reason I'm telling you about uses the term 'bridge'. However, when we use the term 'bridge', Bridges are not used in modern networks. So, in this lecture, and really any time I 'bridge', but really it means switch. So, if we look at this topology again, perhaps while this one interface on SW3 is in a blocking between SW2 and SW3. So effectively its like that link doesn't If PC1 sends that same ARP request broadcast loops. However, if at some point another interface The switches will automatically adjust the flooded like this, again no loops. So, that is just a basic outline of the purpose Now let's go a little deeper into how spanning tree protocol works. By selecting which ports are forwarding and path to and from each point in the network. This prevents Layer 2 loops. There is a set process that STP uses to determine should be blocking. That process is what we will cover next. STP-enabled switches send Hello BPDUs out seconds, so the switch will send a Hello BPDU If a switch receives a Hello BPDU on an interface, switch, because routers, PCs, etc. do not use STP, So, back to our topology here, these switches this . They use these BPDUs to advertise themselves switches. Now, what exactly are these BPDUs used for? First of all, switches use one field in the root bridge for the network. The switch with the lowest Bridge ID becomes I'll talk about the bridge ID in the next ALL ports on the root bridge are put in a topology must have a path to reach the root So, as I mentioned previously STP puts ports in either a blocking or forwarding state, to avoid Layer 2 loops in the network. However, as I just said, on the root bridge, all ports are a path to reach the root bridge. Traditionally, the bridge ID field of the There is a bridge priority field, which is address of the switch, which as you already The default bridge priority is 32768 on all used as the tie-breaker. As I said before, the switch with the lowest by default the switch with the lowest MAC So here's that topology once again, and I've switch. As you know MAC addresses are 12 hexadecimal I've also added port lights for the interfaces, The G0/2 interface on each switch is connected BPDUs, it knows it is safe to go into forwarding so these port lights are all green. Now, all three switches have the default priority be the root bridge we will have to compare Remember, the LOWEST bridge ID wins. Which of these MAC addresses is the lowest? Well, hexadecimal A is equal to 10, B is equal lowest MAC address. Therefore, SW1 will become the root bridge All ports on the root bridge become designated So, that is the traditional bridge ID. However, the bridge ID was actually updated In reality, the bridge priority has been updated which is 4 bits, and the 'extended system 12 bits, because as you know a VLAN number Why include a VLAN ID in the bridge priority? Well, Cisco switches use a version of STP Tree. PVST runs a separate STP 'instance' in can be forwarding or blocking. One interface could be forwarding in VLAN1, By adding the VLAN ID into the bridge priority, in each VLAN. Here's a deeper look at the bridge priority You may have wondered why 32768 is the default Well, it's because this total field is 16 bits set to 1 by default. Therefore, the default bridge priority WAS However, with the addition of the extended-system priority, that changed. So, the default VLAN ID is 1, therefore the 32769. In the default VLAN of 1, the default bridge 32768 + 1. Now, here's a question, If you want to increase VLAN numbers, what is the minimum unit of Let me explain what I mean in the next slide. The bridge priority + extended system ID is extended system ID is set and cannot be changed because it is determined by the VLAN ID. Therefore, you can only change the total bridge system ID) in units of 4096, the value of Let me demonstrate. Currently, the bridge priority here is 32769. Let's reduce it to make this switch the If I want to reduce it just a little, I can plus 4096 plus 1. I could reduce it more, of course, but the only be changed in units of 4096. So, the valid values you can configure are listed of 4096. The extended system ID will then be added So let's look at this topology again. We'll just be looking at the STP topology for each switch is 32769. But if there are multiple VLANs, say VLAN1, would be 32770 for VLAN2, and 32771 for VLAN3, etc. We could also change the bridge priority on SW1 is the root bridge in VLAN1, SW2 could be the bridge in VLAN3. I'll talk about how you can do that in the next video, So, here in VLAN1, SW1 is the root bridge. All interfaces on the root bridge are designated a forwarding state. Designated port is one of the port roles in There are a couple other port roles. I will introduce those in a minute. Okay just a few more points about the root When a switch is powered on, it assumes it It will only give up its position if it receives a BPDU from a switch with a lower bridge ID. Once the topology has converged and all switches sends BPDUs. The reason all switches send BPDUs at first bridge. Other switches in the network will forward BPDUs from the root bridge, but they will not generate their own original BPDUs. Before moving on, let's see if you understand In this network of 4 switches, which will Pause the video now to think about the answer. Okay, did you find the root bridge? The answer is SW3. Both SW1 and SW3 have the same priority, 12289, The first half, 014A 38 is the same, but the SW3's MAC address is lower. Let's do another practice question. Okay here it is. Which switch will become the root bridge in Pause the video to think about your answer. Okay, the answer is SW4. It has the lowest priority of the 4 switches, Okay, now let's move on. So far we have covered the first step of spanning-tree's Step 1: the switch with the lowest bridge All ports on the root bridge are designated It's important that this is the first step of the steps depend on knowing which switch Now let's go on to step 2. All other switches will select ONE of its So, that means there is one root port on each bridge. The interface with the lowest root cost will Root ports are also in a forwarding state. Now let's talk about what that 'root cost' Each interface has an associated spanning A regular Ethernet interface, with a speed Fastethernet, 100 megabits per second, has Gigabit ethernet has a cost of 4, and 10 gigabit Make sure you remember these path costs for Of course, there will be flashcards in the you remember. So, these are gigabit ethernet ports, The root cost is the total cost of the outgoing SW1 is the root bridge, so it has a cost of They are gigabit ethernet interfaces, but interface, just the sending, the outgoing interface. So, SW1 advertises its root cost of 0 in its SW2 will receive the BPDU and add the cost 4, when it floods those BPDUs out of its interfaces. SW3 will do the same. So, which port do you think SW2 will choose Here is its logic. It was advertised a cost of 0 on its G0/1 is 4, therefore the total root cost via G0/1 It was advertised a cost of 4 on G0/0, from However its interface also has a cost of 4, So, it will select G0/1 as the root port. SW3's logic follows the same process. It has a total cost of 4 via G0/0, and a total as its root port. In this case, the ports directly across from are already designated ports. However, keep in mind that the port connected Because the root port is the switch's path block it. Okay, so I've updated our spanning-tree First, one switch is elected as the root bridge. All ports on the root bridge are designated There is only one step in selecting the root bridge ID. Next, each remaining switch will select ONE is also in a forwarding state. Ports across from, ports connected to, the root port are always designated ports. The first criteria for root port selection However, what if a switch has multiple ports In that case, the interface connected to the selected as the root port. Let's see an example. Okay, let's practice that with a First, which switch will become the root bridge? Pause the video to think about the answer. Okay, the answer is SW2, because it has the lowest So, SW2's ports are all designated. Now, which ports will become root ports? All interfaces are gigabit ethernet, so all Remember, if there is a tie in root cost, to the neighbor with the lowest bridge ID. So, pause the video here to think about your ports, one on each switch. Okay, on SW1 and SW4, the answer is obvious, SW1's they are selected. How about SW3? Via G0/0 it has a cost of 8, 4 plus 4. Via G0/1 it has the same, a cost of 8, 4 plus So, we have to use the tiebreaker, which neighbor It's SW1, the priorities are the same, but So, G0/0 is selected as the root port, and So, this is the process so far. HOWEVER, there is ONE more tiebreaker that What if two switches have two connections neighbor bridge ID are the same? Then we get to the final tie-breaker, the neighbor switch with the lowest port ID will Okay, let me briefly explain port ID. So, here is the output of the command SHOW in a future video when we look at spanning I just want to show you this section, this on the switch. Notice the column title is Prio dot number. So, each port has a default priority of 128, 2 for G0/1, etc on this switch. So, the STP port ID equals the port priority Similar to the bridge ID, where the MAC address tie, in this case the port number is used I won't explain the port ID in more depth about it or change it, so you can just look For example, G0/0 is lower than G1/0, or G0/3 So, one more quiz to practice that. Now there are two connections between SW1 Which port will SW3 select as the root port? Pause the video to think about your answer. The answer is G0/2, because it is connected SW1. This is an important point. The NEIGHBOR switch's port ID is used to ID. That's why G0/2 was selected over G0/0, ID on SW1. So, SW1's G0/1 interface is a designated port. Okay, so this is our process so far. But, it's not complete. We still haven't blocked any ports, and 2 loops. So, let's return to our previous topology. All that's left is this connection between So far, all of our ports are in a forwarding are always in a forwarding state. So, to prevent loops do we block both of these SW2's G0/0 and SW3's G0/1? Actually no, here's an important rule to spanning tree designated port. Remember, unlike old Ethernet hubs, which each link is a separate collision domain. This collision domain between SW1 and SW2 This connection between SW1 and SW3 has one, And the connections with the PCs are all designated PCs don't participate in spanning tree. So, we need one designated port on the connection How do we determine which port will be designated, The switch with the lowest root cost will However, in this case both switches have the and 4 for SW3 via its G0/0 interface. So, for the tie-breaker we compare the bridge SW2 has the lower bridge ID, so its G0/0 interface Finally, the other switch will make its port state. So SW3's G0/1 is non-designated, it blocks So, here is the process for selecting the tree. One switch is selected as the root bridge, Then, each remaining switch selects ONE of The interface with the lowest root cost is connecting to a neighboring switch with the a tie also, the interface connected to the Then finally, each remaining collision domain port, and the other port will be non-designated. The interface on the switch with the lowest a tie the interface on the switch with the the other interface will be a non-designated There are still many important things left cover those in part 2, before moving on to spanning tree. We already did a few quiz questions throughout questions to make sure you know the whole If you get stuck, if you don't know the answer, go back to the previous try to figure out the answers yourself. I will also feature one question from Boson a little different. Because there are still some important points aren't ready to answer the spanning tree So, I will show you one question from Boson answer. Of course, if you have already studied spanning it in the comment section. Okay, let's do a couple more practice questions Here is a network topology. Identify the root bridge, and the role of so which interfaces are root ports, which ports. Pause the video to think about your answer. Okay, I hope you found the answer. So, the root bridge is SW3, because the priority These are the root ports, SW2 selected its the lower-number interface on SW1, G0/0. And these are the remaining connections. In each case the interface on SW2 is non-designated, Always remember to check that there is one collision domain. Okay, let's do one more quiz. Do the same thing, but with this network topology. Look carefully, some of these interfaces are tree cost of 19, not 4. Pause the video to think about your answer. Okay, hopefully you solved it. SW4 is the root bridge because it has the these are the root ports. SW1 uses its G0/1 interface as the root port, with a much higher spanning tree cost. Finally, the remaining designated and non-designated SW1's F1/0 and F2/0 are non-designated because is non-designated because SW4 IS the root Okay, that's all for the quiz, let's take Okay for today's Boson ExSim practice question optional feature of spanning tree which I So, I won't give the answer in this video, give you the answer in the next lecture video, Now, if you think you know the answer, if feel free to let me know your answer in the Or if you want to do some independent research tree portfast' and do some reading, and then know your answer in the comment section. So here is the question. You want to decrease the amount of time that forwarding. Portfast is not configured on any of the switchports portfast default' command from global configuration Which of the ports on Switch A will use portfast? Select the best answer. So A says 'No ports, because portfast cannot B says 'All ports', C says 'All access ports', Okay so as I said, this time we won't check Please wait for the next video to see the Of course, if you think you know the answer, If you want to get your own copy of ExSim, the real thing, please follow my link in the These are by far the best practice exams out There will be supplementary materials for There will be a review flashcard deck to use Download the deck from the link in the description. There will also be a packet tracer practice Please be sure to watch the practice lab, process of figuring out a spanning tree topology, commands which I didn't have the time to Before finishing today's video I want to Thank you to Joyce, Marek, Samil, Velvijaykum, Boson Software, the creators of ExSim, Sidi, Mike, Aleksandr, and Vance. Sorry if I pronounced your name incorrectly, One of you is displaying as Channel failed and I'll see if YouTube can fix it. This is the list of JCNP-level members at up recently and your name isn't on here next video. Thank you for watching. Please subscribe to the channel, like the with anyone else studying for the CCNA. If you want to leave a tip, check the links I'm also a Brave verified publisher and accept Brave browser. That's all for now.