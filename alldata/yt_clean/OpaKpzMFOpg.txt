This is a recurrence that generates primes. It defines a sequence where the nth term R(n) plus the greatest common divisor of You can think of it as a warped version where the nth term is the previous term One big difference though, is that, we need two initial terms to get things going, since each later term depends But for the sequence R(n), Let's start off by choosing it to be 7. This is mostly arbitrary, so we'll come back But with the initial term 7, the second The gcd is 1, so we get 8. The third term is This gcd is also 1, so we get 9. The next gcd is the gcd of 4 and 9, So at the fourth term, we also The terms so far are 7, 8, 9, and 10. So far this is a pretty boring sequence! But now something interesting happens, so here the sequence The next gcd is the gcd of 6 and 15, so the sequence jumps up again, Then we go back to stepping up And we reach the bottom of the frame, This sequence was discovered in 2003 experiments exploring the space Initially, what seemed to be is that it exhibits long stretches of boring and it's not obvious that we can But even more surprising Let's look at the gcds on their own, because they determine whether are increasing by 1 or making a jump. Collecting the gcds into their own sequence Let's gray-out the boring 1s Notice anything? Let's be really drastic and Here's even more data. Surprisingly, all these numbers are prime. Remember that they are gcds, so it's not crazy but why on earth are they necessarily prime? Pause the video if you'd like to because there are some patterns that may jump If you see something, let me know in the comments This way, we can do a little psychology experiment and see whether the same numbers For me, here's what jumps out first. 60647 is very close to 2 times 30323. In fact they're just off by 1. There are other pairs like this too. 2 * 11 + 1 is 23. And 2 * 23 + 1 is 47. Unfortunately, this pattern doesn't continue, which doesn't appear and also isn't prime. But there are several other pairs that do satisfy this doubling relation. Why does it work in certain places Also, why is there a 3 And again, why are all these numbers prime? This was the state of things in 2003; I had just graduated from college. I was eager to prove an interesting so I worked on this sequence for a bit But several years later, I had an idea to To see what's going on with this sequence, it turns out that we need some So let's put the primes back in their positions The information we shouldn't have thrown away is the index n corresponding After all, each gcd is the Now we can safely throw away the 1s again. My idea was to make a plot of this data, and only plot the index n so that's 5, 6, 11, 12, and so on. Since there are many 1s in this sequence -- the indices of gcds that To fit more data onto this plot, we need to Now the next few values of n fit. We can even include a bit more data. But by rescaling to include more data, we lost some visual information because now they're all bunched together The solution is to rescale the vertical axis but in a logarithmic way. Ordinarily, the distance between 1000 and is the same as What we'll do is rescale so that the distance between 10 and 100 This is called a logarithmic scale, so the It's called &quot;logarithmic&quot; because now it's that form a linear sequence. This is true for any choice but for example the base-10 Logarithmic scales are used in some settings For example, the Richter scale describes The possible amount of energy released by that the logarithm of the energy is a So, instead of having earthquakes with magnitude we call them magnitude 4 and magnitude 9. Getting back to our primes, this log plot reveals that the primes appear in clusters. This really surprised me. And not only that, but the spacing If we average the indices in each cluster, the vertical distances between the averages If this were an ordinary plot, then adding would give the location of the next cluster. But since this is a log plot, corresponds to multiplication by So the location of each cluster is given by some constant times the location To guess the constant, we should So let's rearrange the primes and compute the cluster averages numerically. Now divide them. The first ratio is roughly 2.09, the second is 2.04, They're not quite equal to each other, This means that the long runs of 1s roughly double in length from one to the next. In hindsight, we saw evidence of this already. If we look at the beginning of each cluster, Apparently 5 produces 11, 23 produces 47, and so on. But the doubling relations only reliably predict For example, where does 101 come from? Since the runs of 1s separating clusters we know it should be roughly twice 47, Well, this plot suggests something else. Maybe we shouldn't be using the beginning like the doubling relations suggested. Since the primes within a cluster are close to get the beginning of the next cluster? So instead of trying to get 101 from 47, Not in an obvious way, but In fact 2 * 51 - 1 is 101. Perfect! But wait; to predict the beginnings we were using the primes, so it's unfortunate that this cluster in that 101 comes from 51 and not 3. But at the beginning of each cluster, each prime gcd seems to be equal If that's true in general, then the doubling but also their indices, and maybe it's a relation For the earlier clusters, we can get 11 from 23 comes from 12. And 47 comes from 24. For the later clusters, 233 comes from 117, 941 comes from 471, This seems to be a reliable way to predict So the doubling relations involving primes It's not that the first prime in a cluster it comes from the index of the previous prime. Specifically, the first prime where n is the index of the previous prime. What about within a cluster? Let's take a look at this big cluster, At index 101, if we try the same formula, That's not promising! But let's not give up quite yet. At index 102, we get 203, Here are the rest. Since we're expecting primes, are the numbers No, 201 is not prime; it's 3 times 67. Here are the prime factorizations of the others. Now we see what appears to be going on. The prime we're looking for it's the smallest prime divisor of 2 n - 1. This even works at the beginning of the cluster, 101 is prime, so its smallest prime divisor Apparently this is how we can predict of prime jumps but every prime jump Isn't that beautiful? So here's our conjecture. If the gcd of n and R(n - 1) is not 1, that is, the next gcd that is not 1, Let's call it p. When does this next nontrivial gcd appear? In other words, if we're currently at index n, then running the recurrence will take us and we want to know the smallest value of Going from 51 to 101 is an increase of 50. 101 to 102 is an increase of 1. Then we have an increase of 3, Can we tell what i is in advance, without computing all the intermediate The hint is to look at the value of p. It looks like i is (p - 1)/2. Great! So we think we know what the next That means we have a shortcut This shortcut lets us jump directly from one Let's check that it correctly generates Suppose we're at n = 467, and pretend that we don't know what the next nontrivial gcd is According to the conjecture, we should 2 n - 1 is 933, which factors as 3 times 311. The smallest prime divisor is 3, To find out when we'll reach this 3, So we'll see the gcd 3 one step later, Checks out so far. Now let n be 468. 2 n - 1 is 935, So now i is 2, and the next nontrivial gcd during the computation of R(470). If we keep going, when n is 470, Its smallest prime divisor is 3, When n is 471, 2 n - 1 is 941. 941 is prime, so the next nontrivial gcd This is a long run of 1s, so 941 The conjecture is able to But is it true in general? To determine that, we need one final observation. We've been able to compute the sequence of gcds without actually knowing any terms But let's look at the values of R(n) If you compute them using the recurrence, By continuing to iterate the recurrence, Do you see the pattern? Here's a hint. In all cases, R(n) is exactly 3 times n. This is the last key piece of information that It turns out that, whenever that is, the value of the sequence then, when we advance the we end up in another situation where So this puts us right back in which means we can advance the recurrence and end up again in a situation where And over and over and over, returning to So if we can also establish that the first whenever we're in that nice situation, then we'll be able to conclude The details will take a little more time to but it's quite fun to see so we'll go through them in my next video. For now, suffice it to say that This theorem lets us answer several questions. First, it shows that, yes, But if you're trying to discover large primes, No, running the recurrence is actually a When the gcd is a prime p, (p - 1)/2 steps where the gcds are all 1, For example, suppose we wanted Every 10-digit prime is between 1 billion for at least 500 million steps But there's no need for that, you might say. The theorem gives us a shortcut If we just use that shortcut, and go directly to the next prime. Well yes, but to run the shortcut, we have to If 2 n - 1 turns out to be the large prime then the shortcut requires us to before we know that it's the next So the shortcut is no help here, we need an independent way to test primality before we can conclude that the recurrence The theorem also explains The reason is that when 2 n - 1 isn't prime, then its smallest prime divisor p so the run of 1s we pass through before But when 2 n - 1 happens to be prime, the number of 1s we pass through This run of 1s is much longer than its neighbors, Since we're generating primes, a natural question Does the recurrence eventually generate Well, the prime 2 is conspicuously absent. This is because 2 n - 1 is odd, Other than that, I don't know After 10,000 applications of the shortcut, the smallest prime other than 2 Granted this is not a ton of evidence, so there may be a lot more to say on the matter. In 2011, Chamizo, Raboso, and Ruiz-Cabello by proving that infinitely many The one pattern we haven't explained yet is why each pair of primes involved in a doubling If we look back at the clusters, we can see to say that in every cluster Since the theorem tells us how to go it is possible to explain this, Let's finish with some variations. Define a sequence s(n) using the same recurrence, but instead of starting what if we start with 1? The first gcd is 1, so we get 2. The second gcd is 1, so we get 3. The third gcd is 1, so we get 4. In fact every gcd is 1, So this sequence is really boring. If we change the initial term to 2 or 3 instead, When we use the initial term 4, The next gcd is 3, so s(3) = 9. But guess what. R(3) this is also 9, so from this point on the sequence is exactly the same If you look hard enough though, With the initial term 532, then a gcd of 3, then 13, 1, 5, 1, 1, and -- surprise surprise -- a non-prime! So far, this sequence hasn't ever been in the nice situation where so the theorem doesn't apply Eventually we do get there, however: From that point on, It seems likely that, if you start with then this will eventually happen. But this is still an open question. Shortly after my paper appeared, Benoit Cloitre looked at an interesting He replaced the greatest common divisor Starting with the initial term 1, The first lcm is 2. The next lcm is 3. The lcm is never 1 here, since the lcm of n and C(n - 1) Here's some more data. Obviously the lcms aren't primes, so this sequence doesn't generate But, because the lcm is divisible by the previous this means that the nth term C(n) For example, C(5) is the previous term, 18, So C(5) is divisible by 18. So it makes sense to look at the ratio This is equal to 1 plus Let's subtract 1 from this ratio, so that we're looking at the value obtained Let's compute some of these values. Astonishingly, this number is And no one has proved this There's good reason to think than proving that the sequence In 2015, Ruiz-Cabello showed that it's about primes in arithmetic progressions. I'll leave a link to the paper in the description,