Welcome to Jeremy's IT Lab. This is a free, complete course for the CCNA. If you like these videos, please subscribe Also, please like and leave a comment, and of videos. Thanks for your help. In this video we will continue our study of In part 1 we focused on the basic purpose tree topology. In this video we will look into more detail First let's see what we'll cover in this First of all we will take a look at spanning tree states and timers. You already know the blocking and forwarding states between those two, and some timers each state. I'll show you the spanning tree BPDU (bridge protocol data unit, what fields are included in it and what their purpose is. Then we'll take a look at some optional tree 'toolkit', some additional features tree, we'll cover some of them briefly. Finally, we'll cover spanning tree configurations. Spanning tree runs by default so you don't you should know how to change which switch make sure traffic follows the best path. Also, make sure to stick around to the end I will feature one practice question from of practice exams for the CCNA. Pretty much everyone who uses them agrees and are an essential part of preparing for They definitely helped me pass all of my CCNA If you want to grab a copy of ExSim, please First let's take a look at spanning You are already familiar with two, BLOCKING LISTENING and LEARNING. BLOCKING and FORWARDING are the two 'stable' Root and Designated ports remain stable in a Forwarding state, and Non-designated ports remain stable in a Blocking state. Note that they only remain stable as long If a new device is added, an interface is they may have to change states. But as I said, as long as the network is stable, in one of these states. Now, there are also two transitional states. Listening and Learning are transitional states is activated, or when a Blocking port must change in the network topology. Actually, there is one more state you might This simply refers to an interface that is We won't really talk about the disabled any role in spanning tree, the interface is Okay, let's take a look at these states, Non-designated ports are in a Blocking state. Interfaces in a Blocking state are effectively This is what makes spanning tree work, disabling Interfaces in a Blocking state do not send/receive Any regular traffic that arrives on an interface However, Interfaces in a Blocking state do They need to receive and process BPDUs to to transition toward a forwarding state if But, interfaces in a Blocking state do NOT Finally, interfaces in a Blocking state do If regular traffic arrives on the interface to the MAC address table. After the Blocking state, interfaces with state. Let me just repeat that only Designated or ports are always Blocking. That's because Listening is a transitional state, so there's no need for a Non-designated The Listening state is 15 seconds long by This is determined by a timer called the 'Forward You'll soon see that this timer isn't Anyway, remember that it is 15 seconds by An interface in the Listening state ONLY forwards/receives Spanning Tree BPDUs. It does NOT send or receive regular traffic. If a regular unicast frame is received on discarded. An interface in the Listening state also does that arrives on the interface. I said the same thing about the Blocking state, As you know well already, when a frame arrives source MAC address field to 'learn' that table with the MAC address, interface, and However, if an interface is in the spanning The traffic is simply dropped, and the MAC After the Listening state, a Designated or The Learning state is 15 seconds long by default. This is determined by the Forward delay timer, and Learning states, meaning by default it both states and enter a forwarding state. Same as in the Listening state, an interface spanning tree protocol BPDUs. Also, it does NOT send or receive regular traffic. However, here is the difference between the An interface in the Learning state learns on the interface. So, an interface in the learning state is some of its MAC address table beforehand. Finally, we have the forwarding state. Root and Designated ports are in a Forwarding A port in the Forwarding state operate as So, what does that mean? A port in the Forwarding state sends and receives It sends and receives normal traffic. Also it learns MAC addresses from the frames that table. So, it's a switchport operating as normal. For review, here's a summary of each spanning For reference, I've also added the Disabled is the spanning tree state of a shutdown, Pause the video if you want to take a look You can also review using the flashcard deck, the video description. Now let's talk about each of the timers I've already mentioned the Hello and Forward Age yet. First up let's look more in detail at the It determines how often the root bridge sends every 2 seconds. Other switches in the network do not originate they receive. However, there is one thing I didn't mention The switches will only forward BPDUs on their Let's see how that works. First off, I showed you this slide in day Assuming these switches all come online at bridge, and each will send BPDUs out of all However, once the network has converged and roles, only the root bridge sends BPDUs. Then, the other switches will forward these information like the bridge root cost, sending Then, two seconds later, the root bridge will again forward these BPDUs on their designated Note that they do not forward the BPDUs out only their designated ports. So, that's the hello timer. Next up, the forward delay timer. This is the length of the Listening and Learning when it moves to forwarding. Note that this is the length of each of the So, with the default Forward delay timer of for the switchport to move through both states Then the final timer, one I haven't told This timer indicates how long an interface ceasing to receive BPDUs. So, this will need some more explanation. Let's take a look. Remember that each collision domain has one of designated ports. So, all root ports and non-designated ports The root bridge, SW3, sends BPDUs, and then ports. To demonstrate the Max Age timer, let's It just received a BPDU, so the max age timer It counts down to 19... 18... And then the root bridge sends BPDUs, because they are forwarded by the other switches, 19...18... But what if a failure occurs on the connection The root bridge will send BPDUs, and other G0/0 interface is down so SW2 no longer receives So, the max age timer continues counting down. 17... 16... 15... and if the failure doesn't recover its G0/1 interface, SW2's max age timer What happens then? First of all, If another BPDU is received the time will reset to 20 seconds and no changes However, If another BPDU is not received, switch will reevaluate its STP choices, including non-designated ports. After these decisions, if a non-designated root port, it will transition from the blocking learning state (again for 15 seconds), and then finally So, it can take a total of 50 seconds for Why does it take so long? Well, tThese timers and transitional states created by an interface moving to forwarding I showed you in the previous lecture how dangerous That's why spanning tree protocol is very state. However, a forwarding interface can move directly about creating a loop by blocking an interface. But, as I just said, a blocking interface It must go through the listening and learning So let's move on to check out the spanning First off, in the Ethernet header section, Cisco's PVST+ uses the destination MAC address I recommend remembering this, it's a little test. For remembering little facts like these, I deck I include with this video. I mentioned PVST in the previous lecture, Well, PVST is an older version which only PVST+ is a newer version which supports dot1q. I might use the term 'PVST' sometimes, much never used anymore. By the way, since I mentioned the MAC address, PVST or PVST+, uses a destination MAC address Again, you probably should remember that fact Now let's move on to the spanning tree BPDU I don't think you need to memorize the BPDU for the CCNA, but I just want to give you an introduction to what is included The first three fields are the protocol identifier, tree. The protocol version identifier is set to a different value here when we look at rapid Finally, the BPDU type is hexadecimal 00 for There are other types of BPDUs, but we don't Next up are some flags, these are used to Again, I don't think we need to go in depth Next up is the root identifier, which gives is the VLAN ID, 10 in this case, and the bridge root bridge. I set the MAC address to all A's in this Next is the root path cost. It's 0 in this case, so you know that this You can also know this is the root bridge The information in the bridge identifier field meaning this is the root bridge. After that is the port identifier, the interface It is hexadecimal 8 0 0 2. 8 0 in hexadecimal is equivalent to 128, which port priority. 0 2 is the number of the port itself. Finally, the timers. Message age is something I haven't mentioned and is increased by 1 each time it is forwarded It is subtracted from the max age when a switch is passed through 5 switches, when it reaches its max age timer to 15, meaning each time to 15 instead of 20, even though the max age I don't think that's an important topic After that we have the three timers we talked By the way, the spanning tree timers on the for the rest of the switches in the network, Next let's talk about some optional features tree toolkit. These are features that can be enabled to protocol in some way. The first one is called portfast. It solves one problem of spanning tree. Portfast can be enabled on interfaces which interface on each of these switches. These are designated ports, in a forwarding However, when they are first turned on or the Listening and Learning states first before How long does that take? 15 seconds for Listening and 15 seconds for I want you to open up Packet Tracer and try For this experiment, make sure Show Link Lights You can enable it by clicking on options, is checked. I want you to place a switch and a PC like connect them. At first you should see that the link light This is the same if you connect a real physical be orange. Why is this? It's because the port is not Forwarding Learning states. However, 30 seconds later you should finally The port is finally forwarding. I told you why spanning tree goes through forwarding state, it's because Layer 2 loops wants to be absolutely sure no loop will be However, only interfaces connected to another There is no risk of forming a loop with an So, wouldn't it be nice if these ports connected away, without having to wait 30 seconds to Well, that's what portfast does. Portfast allows a port to move immediately and Learning. If used, it must be enabled only on ports If enabled on a port connected to another The purpose of the listening and learning them is risky when connected to another switch. We haven't looked at any other spanning operates by default even without configuration. We will look at general spanning tree configuration, Portfast is enabled at the interface level Then we get a warning about what I just told connected to an end host. There is also a message saying that, even take effect if the interface is in a non-trunking That's because trunk ports are typically You can still configure portfast on a trunk You can also enable portfast with the following portfast default. This enables portfast on all access ports, So, portfast is a great feature for getting quickly without having to wait 30 seconds. However, it can still be a risk. What if an employee plugs another switch into This employee doesn't necessarily have malicious what they are doing. Because portfast is putting these interfaces formed. Portfast can also cause loops if the network perhaps a host is moved to a different switchport Anyway, the point is that there is a risk However, there is an additional spanning tree against such loops. It's called BPDU Guard. If an interface with BPDU Guard enabled receives will be shut down to prevent a loop from forming. BPDU guard is very simple to configure. From interface configuration mode, use the That's it. Similar to portfast, there is also an option That's this command. From global config mode, use the command SPANNING-TREE This enables BPDU Guard on all portfast-enabled Notice that the commands are a little different, spanning-tree bpduguard enable, no mention However to enable it globally, you have to portfast bpduguard default. I took this screenshot in packet tracer, so than the previous one, but I connected a switch you can see what happens when a BPDU arrives The port is disabled, it is effectively shut What if you want to enable the port again? To enable a port that was disabled by BPDU the interface. You can see that the interface comes up. However, if you didn't actually solve the you can see here that the interface will immediately So, make sure you actually solve the problem In terms of spanning tree optional features, portfast. I also showed you BPDU guard because it is There are many other optional features that all of them for the CCNA, but let me just least know the name and basic purpose of, They are Root Guard and Loop Guard. If you enable root guard on an interface, bridge ID) on that interface, the switch will The interface will be disabled. This helps maintain the spanning tree topology either with bad intent, or perhaps without If you enable loop guard on an interface, it will not start forwarding. The interface will be disabled. This prevents loops that can happen if an what is called a 'unidirectional link' to forward it, or the opposite. So, those are two other optional spanning However, as I said, You probably don't have such as UplinkFast, Backbone Fast, etc) for But make sure you know Portfast and BPDU Guard. If you want to read more about the others Finally, let's look at some basic spanning You can configure the spanning mode the switch and then you can see there are three options. MST, multiple spanning tree, is not a topic PVST is the classic spanning tree but with been learning about so far. Rapid-PVST is an improved version I will tell Modern Cisco switches run rapid-PVST by default, However, if you want to try out the classic these demonstrations, you can enable it with You can also manually configure the root bridge With these MAC addresses and the default priority However, we could configure SW3 to be the We could also configure something called a next in line to become the root bridge if Let's see how to configure that. This is how to configure the root bridge, SPANNING-TREE VLAN, followed by the vlan number, Now you can see that this bridge has become the This command sets the STP priority to 24576. If another switch already has a priority lower to 4096 less than the other switch's priority. So, it makes this switch have the lowest priority, If you then check the running-config, you applied in this case is SPANNING-TREE VLAN So, this commands tells the switch to apply with the priority 24576, or 4096 less than The command to set the secondary root bridge, is basically the same. SPANNING-TREE VLAN, vlan number, ROOT SECONDARY. Now the priority has been set to 28672. So, this command sets the spanning tree priority However, like the root primary command, the priority command. So, for both of these commands, you could as you see here to configure the root bridge, way to do it without remembering the different You may remember from the last lecture, that of 4096, so the root command is easier to So, this is our topology now. The interface between SW1 and SW2 is disabled This topology is running Cisco's PVST+, VLAN1. Perhaps there is another VLAN, VLAN 2, in like for it? It will look like this, the default topology, only apply to VLAN 1. In VLAN 2, the connection between SW1 and between SW2 and SW3 will be disabled. This allows for what's called spanning tree If you have multiple VLANs in your network, a waste of interface bandwidth. That connection will be doing nothing, just it can start forwarding. However, if you configure a different root will disable different interfaces. Okay, to check if you understood that explanation, This is quiz question 7, because in day 20's 6. Two VLANs are active in this network, 10 and By default, SW3 is the root bridge for both Configure SW1 as the primary root for VLAN10 Configure SW2 as the primary root for VLAN20 Which two commands should you issue on SW1, SW2? So, use the commands I just showed you, the SW1 and SW2. You don't have access to the CLI so just two commands on each switch. Pause the video now to do so. Okay, let's check. We want to make SW1 the primary root bridge essentially it acts like a backup root bridge So, these are the commands to issue on SW1. On SW2 we want to do the opposite. It should be the root bridge for VLAN20, and so it will have the second lowest priority SW1 fails. These are the commands to issue on SW2, basically So, did you get the correct answers? If not, don't worry. Please watch the next video which will be learn in this video, you can practice with own labs in packet tracer to practice. So, with those settings, perhaps the VLAN10 topology And then perhaps the VLAN20 topology looks like this. So, different connections are used in different interfaces, this is called load balancing. Before moving on to the rest of the quiz questions show you how to configure some spanning-tree There are two main settings you can configure The cost, and the port priority, and as you on a per-VLAN basis like the bridge priority. As a review, what is cost? It's the root cost, remember the chart I FastEthernet costs 19, gigabit ethernet costs It's used primarily to determine the root selecting designated and non-designated ports. How about the priority, do you remember what Well, it is the first half of the port ID, the root port. Why would you want to change either of these Well, to change the result of the root port I won't give a detailed example here, but video, so make sure to watch that. First I configured the cost of this interface, million. Then I set the port-priority, which is configured Those are the only spanning tree interface Again, stay tuned for the lab video to try So, what did we cover? We covered the different spanning tree states We took a brief look at the structure of a the spanning-tree optional features, focusing Finally we did some basic spanning tree configurations, different root bridges in different VLANs interfaces, and then some basic spanning tree Okay, for today's quiz we'll do 3 more we learned in this video. After that, one special practice question far the best practice exams for the CCNA there If you want to get a copy of Boson ExSim, Now let's go to question 8 of the quiz. So, continuing from quiz question 7 we did You connect a PC to a switch, however for to the network. Which two options could fix this issue and Choose two. Each answer is a complete solution. A, enable portfast on the switch port you B, reduce the STP hello timer. C, reduce the STP forward delay timer. Or D, reduce the STP max age timer. Pause the video to think about your answer, The answers are A and C. A, portfast, allows spanning tree states and enter the forwarding after connecting the PC. As for C, the forward delay timer determines are. If you shorten this timer, the switch will However, it is recommended that you leave default settings were chosen for a reason. Okay let's go to question 9. A packet capture indicates that a switch port What is the STP port priority of this port? A, 80. B, 32. C, 128. Or D, 224. Pause the video to think about your answer. The answer is C, 128. The first half of the port ID, hexadecimal Hexadecimal 8 0 is equivalent to 128 in decimal, Let's go to question 10. You want to make sure that a Layer 2 loop to a switch port. Which spanning tree optional feature achieves A, portfast. B, loop guard. C, root guard. Or D, BPDU guard. Pause the video to think about your anwer. The answer is D, BPDU guard. BPDU guard will shutdown an interface if a any potential loops. It should be enabled on portfast-enabled switch Okay, that's all for the quiz, let's take CCNA. Okay, for today's Boson ExSim practice question as in Day 20's video because at the end of enough to answer the questions from Boson Well, now we can answer at least some of them. So, let's read the question one more time. You want to decrease the amount of time that forwarding. PortFast is not configured on any of the switch You issue the SPANNING-TREE PORTFAST DEFAULT Which of the ports on SwitchA will use PortFast? Select the best answer. A, no ports because PortFast cannot be enabled B, all trunk ports. C, all ports. Or D, all access ports. Okay, you should know the answer to this question. Please pause the video here to think about Okay, did you get the answer? So, you should know, we just talked about Or at least I think it is, let's check. To check your answer click down here, 'show There it is. Okay, so not only does it tell you it's correct, explanation of why it's correct. Why D is correct, and why A, B, and C are That's one of the great things about Boson Personally I think a practice exam that just you why it's correct or why it's incorrect, So let's read just at least this first part All access ports on SwitchA will use PortFast. PortFast enables faster connectivity for hosts If PortFast is not enabled, a switch port learning states before it enters the forwarding This process can take as long as 30 seconds In addition, port initialization can take Protocol is enabled. I haven't talked about this yet in the course, We'll see. PortFast transitions the port into the STP STP listening and learning states. Okay, and there's more explanation down here. Plus references, here to the official cert it. And some Cisco documentation you can read Okay, so if you want to get a copy of Boson I used them myself for my CCNA and CCNP, please There will be supplementary materials for There will be a review flashcard deck to use Download the deck from the link in the description. There will also be a packet tracer practice Please be sure to watch the practice lab and practice with the configurations you learned Before finishing today's video I want to Thank you to Vikram, Joyce, Marek, Samil, Miguel, Yousif, Kone, Boson Software, the Charlsetta, Lito, Yonatan, Mike, Aleksandr, Sorry if I pronounced your name incorrectly, One of you is still displaying as Channel me know and I'll see if YouTube can fix This is the list of JCNP-level members at 2020, so if you signed up recently and your name be in the next video. Thank you for watching. Please subscribe to the channel, like the with anyone else studying for the CCNA. If you want to leave a tip, check the links I'm also a Brave verified publisher and accept Brave browser. That's all for now.