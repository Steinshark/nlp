(suspenseful music) - It's just nice to see, and you actually doing it and showing is it real or is it just a movie scene? And it's nice to see you, - [OccupytheWeb] And today is gonna be among the most advanced, the most complex hacks and maybe also maybe the most valuable in that we're gonna be looking a mobile spy machine. (techno music) - Hey everyone, David Bombal If you haven't seen our previous videos, he's the author of this book, Fantastic book if you wanna learn Linux, but also from a hacker's perspective. And he's also the author of this book, &quot;Getting Started Becoming OccupytheWeb, welcome. - [OccupytheWeb] It's good always great to be talking to I'd love this effort of trying to explain, the &quot;Mr. Robot&quot; hacks. So let's do another one today. And today is gonna be the most complex hacks and maybe also maybe the most valuable in that we're gonna be looking a mobile spy machine. - I love that, so, I mean, you've kind of mentioned it offline, and I don't wanna jump the gun. So which episode are we talking about? - [OccupytheWeb] This is season I'm pretty sure there's episode 5. They talk about it in episode 4. They do it in episode 5. And this is, well, we know that Elliot has taken down Evil Corp. Him and F Society have And we have this kind of And we've now have lots including the Chinese are now involved, and we have the FBI's involved. FBI is actually in China. We have the female FBI DiPierro, I think is her name. Dom DiPierro is her name. Dom DiPierro is in China, the FBI are on the trail of I mean, they're kinda freaking out. They're getting paranoid. They realize that, their And so, they've gotta come up with a plan to be able to find out what the FBI know, because everybody is getting they're gonna be arrested And so, they come up with on the FBI. In the first part, we learned to Android phones. That's the first step. And that comes up in episode 4. And then in episode 5, we see Elliot begins to but he has to have a way to be And so, what he comes up a mini-cell tower that he's going to place inside of Evil Corp. And Angela, who's now she can walk in apparently that's kind of a big if, and to be able to pick up the And of course, then also So what we're talking about here is what's called a FemtoCell. This is a FemtoCell. These are a couple of FemtoCells. And these are the ones that And I have this one right here. I bought this one a few years ago. This is the new, You - Yep, yep. So what these are is that no matter where you're they sell what are These are for people who live in areas where there is not good cell service. So you put one of these in your home, you put one of these in your office. If you don't have good cell And essentially, what it does within your home or office. Now, we know, maybe not, but we do that your cell phone will connect to the closest and strongest cell signal. And so essentially, what these are, but putting one of these in you are gonna, they're gonna and kind of give you a in somebody's home. So here's the FemtoCell They got a cellphone, it's an it's kind of an old diagram. And then the FemtoCell into the internet then So it is essentially and putting it across the internet into the cellular network. So it goes through the internet - So, can I ask you, is this similar to the 'Cause that's the one the police or whatever, FBI, whatever, using these StingRay - [OccupytheWeb] Exactly, is that it's a mini-StingRay. It's a mini-StingRay. Whereas a StingRay can capture signals for a larger distance. I mean, you can put one in a neighborhood and it'll pick up all the cell and the FBI and other And it's only legal for law enforcement to actually have one. It's not legal for I will put out there we are working on building one with a software-defined radio. So that's part of our project. So we'll see that- - You better come on the show when you've got that ready. Sorry to interrupt. - [OccupytheWeb] Well, It's not something, We're building it, because But you can go ahead and to make a StingRay. Now it's illegal to have We'll, put this up on your channel and we'll put it up on - But a FemtoCell is legal. - [OccupytheWeb] A FemtoCell is legal. So that's a good thing. FemtoCell is legal. So this is being sold from the which is Verizon. They sell 'em on their website. This is coming right off their website, very similar to the one that I have. I bought mine off eBay for I think $120 a few years ago and because they bring 'em home or don't need 'em and knew they cost between $250-$300 and it's a legal device that the carriers and all the carriers sell 'em, but they're all slightly different. So what I'm showing you here today is going to apply in but specifics are gonna be very different. So every carrier has their own. Notice, you can see here I don't know if you can see So these are made by Samsung. Verizon makes the Samsung, other carriers use other And what these are is The key and this mini-cell get inside of it, because then in essence we can eavesdrop on all the traffic that goes through it. And that's essentially what So we see him, he's developing an exploit, but what he's doing is he's into the FemtoCell. So the first step to is that I have one here and to show you, the first step is you look Well, I'm gonna back up a little bit. So there's both enterprise and there's consumer level FemtoCells. So we're looking at consumer level. It's actually a little bit easier to hack the enterprise level FemtoCells. On the consumer level, that's what we're talking about here, there's a connection down below in the bottom of these things right here. And what's that look like? Can you see that? You see what kind of connection that is? - Yeah, I can see it, yep. - [OccupytheWeb] What's it look like? - I can't see clearly. Is it like RJ45 or is it like a screen? - [OccupytheWeb] No, wait I'm bringing it a little closer. - You testing me, I'm - [OccupytheWeb] Oh, you can't see it. Okay, it's an HDMI connection. - Oh, I thought it might be. Yep, let me pretend Is it HDMI? - [OccupytheWeb] Yes, But what can we do with an HDMI? I mean, this is what's really you go, what can I do with It turns out that the Samsung and Verizon have a specially made cable on one end and HDMI on the other end. - Oh wow, 'cause I mean HDMI, Why would you wanna screen - [OccupytheWeb] Exactly, exactly. But they've developed their own unique and proprietary cables to be able to get inside of these things, but it's not that hard to make your own. And so, that's what we're gonna do next, so this is basically, I'm looking at the bottom side under here on that last picture. So what we need to do is that this is actually, I bought and what we can do is by using it's called a FTDI TTL 232R, and then we can take this cable. So if you wanna buy one, they're about anywhere in that area, they're not that expensive. And so, what we can do is we can splice these HDMI cable and this cable, and this is the wiring for it. You take the HDMI bare copper there's the FTDI Black right there, and the HDMI White to the FTDI Yellow and the HDMI Orange to the FTDI Orange. - How did you work this out? Was this just like trial and error or did you find the - [OccupytheWeb] I found I'm not the first one to do this. And so, it's actually comes and was first presented I think it was 2011. And so, but the specifications, they didn't give these specifications to the cables at Black Hat. So I had to go digging for these FemtoCells to find So anyways, once you have this cable, then you can access the So the first step is we that's the first step, gotta build the cable that to the FemtoCell through that HDMI port. That's step number 1. Remember we're far from done, because when we get inside the FemtoCell, essentially we have a It's called Monta Linux, Some of you may have heard of it before. It's using a lot of IoT devices. So it's a company out of California that makes these really put in all kinds of devices. And so, that's what's But you'll find Monte Linux in all kinds of IoT devices, no matter what you, whether it be a router or a baby monitor, what have you. These all use very small Linux. And so, this is once again, I'm gonna plug Learning Linux if you wanna be a hacker. - So let's see, which But there's more. Yes, so that book we're as how to use it as an attack tool. But the truth of the matter is, is that all these IoT So you get inside one of these device and if you don't know Linux, you don't know how to get find You need to know Linux to be able to do this, - Linux is like speaking English, let's say in the U.S. or the UK. It's like a basic skill that in IT, I think. - [OccupytheWeb] I agree, I agree. It's basic skills you have to have. So once you're inside, now but it doesn't have a Bash shell, so it's not like what we're accustomed to. And so, it becomes Once again, this is a pretty complex hack, but it can be done. - It's just nice to see, because you... Sorry to interrupt again. It's just nice to see and you actually doing it and showing, is it real or is it just a movie scene? And it's nice to see you - [OccupytheWeb] It's and once again, we've always and the timeframe that he works. And this one, if they one of the team was yeah, it might be able to be done in a couple of few days that they had, but it's not easy, so once we're inside, we've got the console, we've And so, here's the two and these are the two methods to get to root. So the one I have is this one right here, which is the easier one. And Verizon now says that but it doesn't matter, because we can just go buy the old ones that have never been updated and get root access. So once we got root so we now are in, we've got inside this device. Unfortunately, even with root access, it's not really functional, we And so, if you watch you'll see that this comes up. This is, see the screen right here? This is OpenWrt, these are Linux images that So if you've got some hardware, you can go ahead and download the Linux to install and flash into the IoT device. Here's all the hardware, this has been going on for years and very few people are familiar with it. Now you can just download the software. It's open source software for any device. And this is what they do is that basically they take this FemtoCell and now they go ahead and flash it with a Linux operating system that or they've basically and made some alterations to it. The show, what happens is that Elliot actually puts some malware, he puts malware, it's kind RCE exploit into the put the shell code onto the phones. What I'm most interested is being able to eavesdrop on the traffic. So we don't need to actually have an RCE, we don't need to have any exploit at all to be able to listen in So Elliot is trying to infect the phones, but to be able to listen in, there's still a few You can see all of the data traffic. It all goes unencrypted. But the SMS traffic and the phone traffic, you have to be able to decode that traffic 'cause it's all encoded. But that's publicly available information that you can decode. It's really kind of beyond the scope of what we're doing here today. I'm just trying to give you the outlines of what can be done to be a small spy device, a mini-StingRay that gives you access to in the area. Now these StingRays are kind of low power. So the target has to be within 15 feet of the FemtoCell to be but they can then travel and they'll still be So the initial connection has So what is that, about five meters and then about 17, 16 They travel throughout you can pick up all of their traffic. So it's kind of giving you of what we have to do. But there's a lot of work involved here. Probably, the first step of course is getting that cable to the device and then and flash it, you've got root access and then you gotta flash and then once you have new Linux kernel, then you have access to all of the traffic that's going over the device. - But I mean, if you or like he did, they hid it in a store room or something, didn't they? And then, the distance is fine. - [OccupytheWeb] Yeah, In the show there's a scene where Angela puts it on the floor and connects it into the ethernet cable there. But it's still, it's It's probably, it's, well not that large, it's a size of a small purse. But it's set on the floor next it may be, people may not notice it, but it's not so small like a raspberry pie that it's basically people But one of the things is this OpenWrt project, which I don't think many and that you can go ahead for just about any IoT device. And then if you have your own firmware, of course, then you can and have it do just about And that's what Elliot does in the show is he goes and much of this is Monta Linux for various different There's some Cisco devices here- - As you said, it's quite a complex thing 'cause you'd have to connect to that cell and then flash it basically, and then somehow capture the - [OccupytheWeb] Yeah, once you've got the cable, then you gotta go and flash it, you gotta get root access, and then flash it and and figure out what the and the voice traffic across it. I'll also point out that of these FemtoCells, they actually a little bit easier, because they have a standard connection. To connect to the enterprise level it's simply a ethernet connection. - [David] That's much easier, yeah. - [OccupytheWeb] Yeah, much easier. And then the root password on it is FemtoCell and then xxx, four x's... FemtoCell capital F, the capital C, and then the last four on the device. So if those are the keys are being able to connect into the device, And the enterprise level one, it's the default password is the last four digits of the for these consumer level ones, And as I said earlier is that Verizon has said they've now the vulnerability that they've closed is that the ease of But like I said, there's always a way to get to escalate privileges. So this is basically a and it's gonna differ So, this applies to these Samsung devices that Verizon uses that I have but if you're in UK, if you're in Germany, if you're in China, they're all gonna be using they're gonna be using So, but the process is One, get yourself into the console. In our case here, we had to build a special into the console. Then once you're inside the console, then get root privileges and then three, you have to go ahead and flash it with a more And then once you have then you can go ahead and or Wireshark and watch the traffic. You can watch the data traffic from there without having to do anything further. But as far as the SMS traffic it has to be, you have to find the proper codex that that particular company is using to be able to decode the SMS It's a complex task. If you build one, you've got yourself a really cool spy tool that you can use. And like Elliot did, I mean Elliot used it both, remember he listened and he also hacked their phones with it, because he used, as their traffic is going through the FemtoCells, he's sending an exploit to their phones and taking control over their phones. But you don't have to take you can just simply listen both the data traffic, the SMS traffic, and the voice traffic. Essentially you're taking - What they showed in &quot;Mr. But like you always say, that are not realistic. - [OccupytheWeb] Yeah, this It's been done, there's a lot of research into these devices. Some of that research has been published. You can find the research and but it's time-consuming. But somebody's already done The guys who originally were iSEC partners did So this would've been available to Elliot when the show was made in 2014, 2015. So he would've had this kind of research already available to him to And it was also was in the show that shows that he is actually using, he's building a browser exploit that was well-known at that time. It came out like in 2014 that In Ruby, if you watch closely, he's building an exploit in Ruby to be able to put into the FemtoCell to then be able to place the exploit onto everybody's phone who connects to. - That's great, and I mean the is that using HackRF or some kind of software-defined radio like that? - [OccupytheWeb] Well, the is actually a StingRay, a StingRay-like device that So the HackRF is a nice piece of hardware that can do a lot of things, but it can only go, it's only half duplex. So it can't go in both directions. It also is relatively It's only uses USB 2.0, not USB 3.0. And it's relatively slow. So we're building with a It's full duplex, it go So it has a lot of the capabilities, basically enhanced capabilities The HackRF is a nice But when you start getting you gotta take a bump up to pieces of hardware, a - I like to ask the sort or the dumb questions, The FemtoCell is connecting, sorry, it's using cell phone frequencies. So the phone connects via to the FemtoCell and then Yeah, sorry. - [OccupytheWeb] Right, exactly. So here we have the cell phone, it's connecting to the FemtoCell. The FemtoCell then via ethernet is connecting to the broadband gateway, the gateway then's going to the radio network controller and the whole network Now the back haul on these some of them are private networks and some of 'em simply So it varies by carrier, but really it's not that important to us, because what we're doing is at this stage right here, but there are some people who've worked on trying to intercept this traffic in here. And of course, when we start talking about building a StingRay, essentially what we're whole tower right here with the BTS they call a Macrocell BTS, you're building a cell tower with an entire cell - My question was, between the FemtoCell and the So it's got broadband access, could you sniff the traffic - [OccupytheWeb] Well, it's all encrypted from here to here. So that's what... That's part of the is that one, this is all encrypted and so you have to intercept the traffic - Before it gets encrypted. So yeah, that's why you the Linux kernel inside that device, because as it's built, it's encrypting it as soon as it hits the kernel and you can't get it So that's why Elliot changes the kernel. That's why he uses OpenWRT before it gets encrypted. And then once he has that, - It's interesting. In the UK, I don't know if in the UK, carriers allow you So if you've got no cell phone reception, but like your home broadband is there it'll just jump onto the home broadband. So you just make calls and Is it similar in the U.S.? - [OccupytheWeb] Yeah, in the U.S. you can make calls on - So the same problem there. If it did the traffic's encrypted, that's why you can't sniff it. - [OccupytheWeb] Yeah, the So most of the carriers now, especially when you get to 4G, when you're talking about 2G and 3G, the authentication and When you get to 4G and 5G, it gets much stronger Actually, the FemtoCells are using 3G, so they're a little bit But this is for people in their area. If you are no cell in their area, if you're making phone (indistinct) wouldn't even notice the But it's only when you're sending, you're sending data traffic through that you'll notice the difference. But for regular cell calls, you won't notice the difference at all. - Yeah, I think I kind of missed it. So I think we should emphasize that if you with that FemtoCell, you can eavesdrop on SMSs typical like cellular phone calls, but also the internet traffic that would typically go across - [OccupytheWeb] Yes, so you is unencrypted at the FemtoCell. The SMS is encrypted, and the voice traffic - And this was demonstrated, like you said at Black Hat 2011, right? - [OccupytheWeb] I think, there's been a number of The folks at iSEC partners and then somebody else And then there's been who have continued this There's a fellow in he's been tearing apart around the world. And basically, he says to being hacked. And so, but the hack is depending on what FemtoCell you're using. This is, in this case, we're just talking about this one that's probably the most widely Now Verizon has about one third in the U.S. and this is the product that they're still selling who are in dead zones of And the new ones, they say So if you can't get root access, you can't obviously There's always a way, there's always a way. So they've made it harder, but And then, how you're gonna is gonna vary by the company and the carrier who's carrying it. - So we weren't able to Do you have, I know you 'cause you've always got have you got a course on this or are you covering some - [OccupytheWeb] I don't but I think I'm going to go ahead and put at least a tutorial on all the steps. - That'd be great. - [OccupytheWeb] Yeah, I have on this one. - [OccupytheWeb] So I'm that the whole StingRay it puts me in kind of This one is actually a legal It's something that I'm considering doing, putting it up on But I've got one here I bought it about three And it's relatively easy to hack. - It's brilliant. - [OccupytheWeb] Meaning, it - For you, not for us, but for you. - [OccupytheWeb] Not for 30 seconds. - By the way, but I for sharing your knowledge. And I have to say this, yeah, but for the rest of us might take a lot, lot longer than that. But thank you for sharing your knowledge, but also talking about how and why you enjoy it. For everyone who's watching, put below what you'd like us to cover. We've been reading the comments, so we've been seeing the kind of things that you've been asking for and hopefully we kind of But put your comments below, let us know what you wanna cover. OccupytheWeb as always, thanks so much. - [OccupytheWeb] Thanks David. (techno music)