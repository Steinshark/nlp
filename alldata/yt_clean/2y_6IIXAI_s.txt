7, 8, 9, 10, 18, 19, 20, 21, 22 This sequence of numbers generates If we look at how much each number for example, from 7 to 8 is an increase of 1, then another 1, 3, we always seem get a prime number or the number 1. In a previous video, we discovered and in this video we'll put everything together To recap, the sequence is Index the numbers starting from 1. determine the greatest common divisor This gcd is the next increase. To find the next number, and 33 + 3 is 36. If we call the nth number R(n), then R(n) is the previous number, R(n - 1), So here's a recurrence for R(n). As we compute more numbers, we find that the primes and there are long runs of 1s But there seems to be a shortcut and jump directly from one prime to the next. For example, this 3 is the To use the shortcut, we Then we find its smallest prime divisor. Since 101 is prime, its smallest This is the next gcd that And sure enough, when we compute more the gcds are all 1 until we see 101. We'll see that this actually works in general. then the next gcd that isn't 1 is the To take another example, if we start from 201 factors as 3 times 67, so the And indeed the next nontrivial gcd is 3. At index 102, 2 n - 1 is 203, so the next nontrivial gcd that appears is 7. This checks out too! Okay, so we know what the next nontrivial We have a conjecture for that too: This is exactly what we saw when n is 51; and the 101 appears exactly When n is 101, the 3 appears 1 step later. So why does this work? What makes it work is the final about the indices n where and that is that R(n) is exactly For example, R(105) is 315, which is 3 times 105. R(102) is 3 times 102. R(101) is 3 times 101, and, if we scoot back a bit, R(51) is 3 times 51. What we'll see is that whenever we're then (p - 1)/2 steps later where the value of the at which point we'll be able to apply this where the value of the And over and over and over. So this third part of the conjecture will which in turn will let us determine that the next nontrivial gcd is the Okay, so let's see why this conjecture is true. Let's think recursively, or If we go back to the beginning of the sequence, R(5) is 15, which is 3 times 5, so at that So now assume we're at an index n We'll go through the reasoning with two because things are slightly simpler in that For the first example, we'll use n = 51, since The goal is to understand why the next nontrivial Let's see what the next Using the recurrence, the next term This gcd is 1, so R(52) is 154. The next gcd is also 1, so R(53) is 155. As long as the gcds continue to be 1, So i - 1 steps later, Suppose that's the last gcd that is 1 before It's not clear this will actually happen; But for the moment, let's Let's rewrite 51 as n to work Here's where we use that R(n) is 3 n. Let's also call this gcd d (for divisor). The conjecture is that d is the To see why this is, we'll use the fact that a number that divides two other For example, 6 divides 54 and 36. Since we can factor out a 6 from each, Similarly, d is a common divisor so d also divides their difference. The i's cancel, and what's left is 2 n - 1. Good, this is half of what we wanted we now understand why d is a divisor of 2 n - 1. The other half will be to show that it's In this example, n is 51, so d divides 101. Since 101 is prime, d is either 1 or 101. In general, since we're assuming 2 n - 1 is prime, there is only one possibility for the divisor d. Remember that this is assuming Must there eventually be a gcd that isn't 1? this will tell us where this gcd appears, How can we determine i? the i's from the two arguments of the gcd so we might be able to cancel the n's in a similar If we first multiply n + i by 3, causes the two instances of 3 n to cancel. What's left is 2 i + 1. Can we use the fact that p The smallest possible i that might This would make i equal to (p - 1)/2, which would nicely agree with the In this example, i would be 50. Let's compute the gcd and see For i, we have the potential value (p - 1)/2. And since 2 n - 1 is p, n is (p + 1)/2. 3 n + i - 1 simplifies to 2 p. So yes, this value of i works! produces a gcd that isn't 1, and that gcd which is the first part of our conjecture. Not only that, but this gcd appears in which is the second part of our conjecture. So, for example, when n = 51, 50 steps later, we see the next What about the third part? as it is for n = 51, does this same We can do a little algebra and see that yes, we are back in a situation where the value Great! That was all assuming 2 n - 1 is prime. Why is the next nontrivial gcd going to Well, we have an example of that right here. The new n is 101. which isn't prime. It factors as Again let i be the smallest positive integer for which we see a nontrivial And again assume for the moment If we call the gcd d again, then, just as before, since d divides n + i and 3 n + i - 1, This is half of the first part of the conjecture. Why is d the smallest prime divisor of 2 n - 1? Well, d also divides 2 i + 1, We don't know what i is, but the smallest value Does that actually work? When 2 n - 1 was prime, we were able to write n in terms of p, But now we have to be a bit more clever. I claim that if we pick any divisor d of 2 n - 1 Assuming the claim is true, which value of i will Since we're looking for the If d is 1, then i is 0, which So the next smallest divisor is the one we want. This divisor must be prime, there would be another and then it wouldn't be the next smallest divisor. Okay, why is this claim true? It'll follow from another statement, every common divisor c of 2 n - 1 and 2 i + 1 and vice versa. In other words, we'll show Let's see an example to convince If n is 101 and we pick d to be 67, then i is 33. On the left, 2 n - 1 is 201, and 2 i + 1 is 67, On the right, n + i is 134, 134 factors as 2 times 67, and 335 is 5 times 67, In general, the gcd on the left is d, since So if the two gcds are equal, then the gcd on the So why are these two gcds equal? that every common divisor of n + i and 3 n + i - 1 What about the other way around? If we can write both n + i and 3 n + i - 1 this will show it. With some trial and error, you If you want to do it without trial and error you can set up a matrix equation instead. We already have 2 n - 1 and 2 i + 1 expressed If we take the coefficients and put them into a 2 by 2 matrix, The coefficient matrix is invertible, so its inverse gives the linear There's one minor issue, which is So we can't immediately conclude that is a common divisor of n + i and 3 n + i - 1. But fortunately all the denominators are 2. Both 2 n - 1 and 2 i + 1 are odd, so those So it is true that every common is a common divisor of n + i and 3 n + i - 1. We already showed the other direction, so these which means if we pick any divisor d then the gcd of n + i and 3 n + i - 1 is d. while computing R(n + i). The smallest i comes from the smallest divisor d, smallest prime divisor p of 2 n - 1, This proves the first two parts of the conjecture. So you can think about this as performing trial division on 2 n - 1. After an index n where there's a nontrivial gcd, it starts testing odd numbers, one by Every time we compute a new term of if the gcd is 1, so then it tries again with the next odd number, until it finds an odd number that divides 2 n - 1. The first such number will be the The third part of the conjecture follows from exactly the same algebra as in So this conjecture is a theorem. And the proof doesn't use anything fancy Can we use this recurrence to find new big primes? If you haven't seen my previous video about this