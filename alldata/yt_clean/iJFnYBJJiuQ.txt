Have you ever looked at the chip of a credit wait... they look quite similar? And would you like to know what makes these even in 2018? In this series I want to talk about mobile And by that I don't mean android or iOS I mean the networks. SIM Cards, Baseband and Basestations. Most of us know how the internet works. It's so easy to setup a lab and use wireshark But we basically don't really learn about You can't just wireshark the radio network. I only learned about this a few years ago security. And that was a great foundation that I will really hard to do anything practical with But then Vadim Yanitskiy, @axilirator on twitter, GSM osmocom demos and I could record it for And of course I took this opportunity and So thanks to him I finally got some real hands-on so excited to try to pass this on to you. I hope over the course of several videos you the mobile network works and you know where So I started this video showing you a credit And the reason why they look so similar, is A smart card, or chip card, is any pocket-sized Many smart cards include a pattern of metal chip. Here on wikipedia you can see some great images. The actual chip is smaller than the gold connectors, to there. And all the outer stuff is just plastic. Here you see how they are connected, crazy So when you look at your phone, and I would What would you answer. That was actually an opening question in the a great question. Maybe some people would respond with one, But maybe you knew, that the sim card is actually Your phone computer communicates with the And that computer can't do much, but it In a very simple way you can imagine this And with public-private key cryptography you And the idea is that it's super hard to Not comparable to the simple magnetic strip The private key never leaves the chip. If you want to do some crypto, your phone it to do it. In the same way a credit card reader, using Nobody can clone a sim card or credit card There are attacks on smart cards which I have other crazy hardware hacks. But generally the cost is pretty high to do But in theory if you could extract the private clone a credit card chip. So you can't clone a sim card that easily, Can you just use it? And that is why you need a pin for your credit The small computer inside the sim card refuses tell it the secret pin. That's another protection. So how does this look like in practice? Vadim showed me SIMtrace. So Osmocom SIMtrace or SIMtrace 2 is a software the SIM mobile equipment communication. As you can see here, you have this basically flexi-pcb cable and connects to this board. And this is where you put the real SIM card. So basically the phone is still using the that. But because the sim card is not inside the that communication and forward that via USB And then you can observe all the messages and see how the sim card responds. So when you turn on the phone, the phone asks Let's enter the pin and then look what happened. Here is wireshark... wireshark you ask? How what? Okay... so wireshark is a convenient tool And in this case you can see here the protocol And wireshark is listening on localhost. So the simtrace software actually records a UDP packet and send them onto localhost. That's why you can use wireshark to then And it looks like they have an ethernet layer, But that's just to transport the data. The actual interesting payload is the GSM Somebody wrote a payload decoder for wireshark So ignore all the references to IPs and MAC the SIM card and the phone. You only focus on the GSM SIM layer. Anyway. When we look at the packets that were collected the sim and phone did. The first important packet here is the VERIFY The info also says something about ISO/IEC And when you look that up, you will learn ISO 7816 is an international standard related especially smart cards. And sspecifically section 4 is about Organization, It was created in 1995 and According to its of command-response pairs", "access methods the sim card is a small computer, so the sim And also defines "access methods to the So what does VERIFY CHV mean. Let's peek into the GSM standard. Here CHV is described as "Card Holder Verification SIM for the Can you guess what that is? That's a fancy description for your pin. The user who knows the pin can verify that the simcard. And we can also check what VERIFY does. This function verifies the CHV (so the pin) the phone) by comparing it with the relevant The verification process is subject to the - CHV is not disabled; So either your pin is blocked because you Or you had disabled the pin. And further we can read. If the CHV presented is false, the number be decremented. After 3 consecutive false CHV presentations, the respective CHV shall be blocked and the the UNBLOCK CHV function has been So this is all fancy documentation language. But here is basically defined that you have And if you fail, the sim is locked, until unblock it again. Interesting, right? Anyway... after that we can see some SELECT So the phone requested the content of files One file contains the IMSI. the international identifies this sim card. Also remember that you can store some contacts W ell here you can see how the phone requested There is one other cool thing. Vadim looked at the wireshark trace and saw "Oh also very interesting thing, I will It is related to the sim card menu." And I was like, sim card menu? I have never seen a sim card menu. ohhh that's what this menu always was. It's like a thing I never used. So this is a menu running on the simcard? "Exactly. it's Probably java application.". You heard right. Usually there is JAVA running on SIM cards. Java Card refers to a software technology run securely on smart cards. It is widely used in SIM cards (used in GSM Crazy right. And when we click around on that menu, the did in the menu to the sim card, and the sim on the screen. "We can choose one. It's in german I think. " TERMINAL RESPONSE SELECT ITEM. we select an And then the sim card responds with a new FETCH. DISPLAY TEXT. "Simcard said, please display text. I'm not sure if wireshark is powerful.. OH OK. it is here.". So Vadim wasn't sure if that weird part in wireshark, but it was. Here it shows the text "MMS-InfoServices werden". So that's german, its a german sim card, "MMS infoServices can only be received with And I had pressed the back button on the phone. So the terminal response. So the response WE gave and the phone forwarded Which stands for "backward move requested Isn't that awesome. We use these mobile phones every day, but into how they work. I hope you found this interesting, thanks OSMOCOM project for creating all those tools. stay tuned for the next videos. We will soon learn what makes these phones