Hi and welcome everyone. It's Jakub Vanko for Capturing Reality. And in this video I want to talk about a very requested topic by our user community and that is merging exteriors and interiors of buildings. For this tutorial I was trying to find a relatively small building so I would be able to scan it by myself in a couple of hours and luckily I was able to find this small chapel near the place that I live. It is called the Mednyanskych chapel and it is located in the town of Bohunice in Slovakia. For the data capture I used a drone and a mirrorless camera. I flew the drone around the chapel manually, because I was trying to achieve higher detail. And there were some trees nearby the chapel and I didn't want to risk crashing the drone. So that's why I didn't use any kind of flight planning application. And for the ground photos I just put the camera on a pole. I set it to interval timer shooting and I just started to walk around the chapel and the camera was taking photos automatically. When I moved from the outside to the inside of the chapel I just put the camera down and I started to take photos manually. I took all of the photos in a way that RealityCapture was able to merge the interior and the exterior of the chapel automatically. And I want to show you what you should focus on when you are trying to achieve this. But I also simulated a second scenario. I cut out some of the photos and in that case RealityCapture didn't have enough information and it created two separate components one for the interior and one for the exterior. And in that case I had to use control points to merge them together. And I will also show you this workflow in this tutorial. In this next image you can see a cross section of the chapel. I made this cross section directly in RealityCapture using the ortho projection tool and I want to use it to highlight the areas that you should focus on during data capture. So let me just grab my pen. And you need to focus on the floor near the entrance. You need to focus on the doors on either side of the entrance, the walls and also the ceiling that is not visible in this cross section. And all you need to do is just take a lot of photos in different angles and also in different heights of these areas. You need to do this from the inside and also from the outside of the building. And if you do this Reality Capture will have enough information to merge the interior and exterior automatically. Later I will show you my camera alignment directly in Reality Capture although it was not the best one, because I was rushing. I should have take more photos, but it worked in the end luckily. You can also help the alignment by placing some markers. You can place some markers near the entrance inside of the building also on the walls. You can also place some markers outside. And in Reality Capture you can use these markers to place control points to aid the alignment. And if you have some surveying equipment like a total station. You can also measure these markers, calculate their coordinates and use them as ground control points in Reality Capture. Okay that's enough theory. Now I will jump to Reality Capture and show you my workflow. Okay so now we are in Reality Capture. I already have my finished project opened. And now I will describe to you how I got here. So the very first thing I did was to import my photos. To import photos you can use the add inputs, add folder or and what I like to do is to drag and drop my photos directly into the user interface. So here I have my folder containing my ground photos and indeed I have my JPEG's. So I would just click on the folder and drag and drop it to the user interface. And I would do the same also for the drone photos. After all of the photos were imported I grouped them. And Reality Capture will group the photos based on similar properties for example like the focal length or the lens distortion coefficients. Since I used a mirrorless camera with a prime lens and also a drone with a prime lens Reality Capture created two groups. To group the images I just clicked on images and clicked on group. If you don't want to do this every time manually you can set this behavior in the application settings. So go to the application settings and under import settings make sure that group calibration by Exif is set to yes. And after my photos were grouped I just started the alignment. To start the alignment you can just click on align images in the workflow tab or you can start the alignment also from the alignment tab and click on align images. After the alignment Reality Capture created three small components that were containing only two or four photos and it created one large component that was containing 1813 photos. If you want to see which photos were not aligned in this component make sure that the component is selected. Switch the 1Ds to 2Ds and with this window highlighted go to the scene context tab and click on show unregistered. So I already have this turned on. And now when I scroll this you can only see the unregistered photos. So I decided that I will make a second alignment, because it will optimize the first alignment and maybe Reality Capture will add a couple of these photos into the largest component. So I again went to the alignment tab and click on align images. After the second alignment Reality Capture again created three small components. And it created one large component, but this time it was containing 1818 photos. So five photos were added to the largest component. So let me switch to it. And now we are looking at the final component. To make the interior more visible let me use the Clipping Box. So with the 3D view selected I will go to the scene context tab, go to the Clipping Box and create Clipping Box from the reconstruction region. You can already see that the tie points outside of the Clipping Box disappeared. Now I will adjust the Clipping Box. Again I am going to the Clipping Box and click on edit Clipping Box. And I will adjust the top of the Clipping Box to create a cross-section of the point cloud. Okay. Now let's take a look at the cameras that were responsible for merging the interior and exterior. First I will make the camera scale a little bigger. Like this. Okay and now I will launch the inspection tool. To launch the inspection tool you can press I on the keyboard or you can go to the alignment tab and click on inspect. With my inspection target is set to camera relations. We can now view that these cameras right over here were responsible for merging the interior and exterior. As I said in the beginning of this tutorial I was rushing and I should have taken more photos of these area, but luckily it worked out in the end. So if I would go outside again I would probably take more photos from different angles and different distances from each other and also in different heights. And now with the interior and exterior merge you would just continue the usual way, so you would just go to the reconstruction tab, recreate your mesh and texture your mesh. Now let's take a look at the scenario And I will also show you how I cut these cameras out. So first I will go to the alignment tab. I will use the camera lasso tool and select these cameras right here. Now with these cameras selected I will disable the camera lasso tool by clicking on it or you can also disable the tool by using the right mouse button. And I will invert the selection by clicking invert or you can use the shortcut Ctrl plus Y. With these cameras selected I no longer need the inspect tool so I will disable it. And with these cameras selected I will export an image list. To export an image list go to export, export image list and you will get this only the selected items will be exported. Would you like to continue? In my case I will click on Yes. And then I would just specify a folder where I want to save my image list. So here is my image list that I created when I was calculating the previous project. This time I will click on cancel. And I use this image list in a new project and this time without these photos. So now I will switch to the second project. This is the project where I imported my image list. So first I will show you how to do that. To import an image list you can use the add inputs, find your image list and click on open or you can just simply drag and drop it to the user interface just like the photos. So after I imported all of the photos I again grouped them. So I clicked on images and clicked on group. After the images were grouped I aligned the project by pressing align images. After the alignment I got two separate components so one for the interior that we are looking at right now and one for the exterior. And as you can see I used three control points to align the components together. So now I will show you how I did that. I will switch back to the interior. Zoom out a little bit.. And I will delete this control point number two and I will place it again. So I will go to control points and delete this point number two. First I will create a Clipping Box and adjust it, so my focus is only on this entrance. So it would be much easier for placing the control points. So with the 3D view selected I will go to the scene context tab Clipping Box, create Clipping Box from reconstruction region and edit Clipping Box. So I will adjust the top of the Clipping Box like this and also the sides of the Clipping Box like this. Okay now I can start placing the control points, but first I will change my layout. I will switch to the OnePlus 2 layout. The top window will be a 3D view, the bottom window will be a 2D view. I will just make sure that my 2D view has a blue color cursor so I will go the image context and change it to blue. And now I will start to place my control point. To activate the control point tool you can press F3 or you can launch it from the alignment tab and click on control points. And now when I hover my mouse cursor over the point cloud in the 3D view I will get image suggestions down in the 2D view. So I will rotate my camera a little bit, find a good angle. And I will place the control point near the corner of this paper sheet. I don't have to place it very accurately, because I will adjust its position on the image suggestions. So now I will click and control point number two was created. So now I will disable the control point tool. You can disable it by clicking on control points or just using the right mouse button, like this. Okay, now I will go over the image suggestions and adjust the control point position. So first I will click and hold my left mouse button. Place my cross where I want to place the control point. And now when I press the down arrow key I will confirm the control points position and switch to the next image suggestion. So now I'm pressing the down arrow key. Okay first one, second one, three, four, five and that's enough for this tutorial. Now I'm still holding my left mouse button. If I want to just cancel this operation I will press the right mouse button like this, okay. So I placed, I marked the control point in five photos. To clear the other suggestions with the control point number two highlighted I will click on clear suggestions. Now I have to do the same thing for the exterior component, so I will switch to the exterior component. I will again adjust the Clipping Box so I will go to the scene context tab and create Clipping Box from reconstruction region and edit it. Again I will adjust the size of the Clipping Box, like this. You can see that there is not a lot of tie points on the doors so that is why Reality Capture wasn't able to merge these two components together automatically. And that's the reason why we need to use control points. Okay I will just check if the Clipping Box is in a good place so I will adjust it a little bit more. Again I will activate the control point tool by pressing F3. And now I will again hover my mouse cursor over the point cloud. Like this. And again I don't have to be that accurate I will click right now. Again Reality Capture created a couple of suggestions right here. I will disable the control point tool again by using the right mouse button. And I think that the visibility of these so I will disable the edit Clipping Box tool, like this. And now let's go over the photo suggestions. So I will select the first one zoom in, click on the control point, go to the correct location and I will going to press the down arrow key with the left mouse button still holding. First one, second one, third one, four, five and five is enough for me. So now I will click the right mouse button to cancel this operation and I placed five suggestions. For the other suggestions again I will select the point number two and clear the suggestions. And now that my control point is marked in both components I would just do the alignment again. But this time I will not use the align images, but this time I will use the merge components tool. And this tool only merges components it doesn't add new images into the components. So after I press the merge components button I got a single merge component. Let me change the layout again to OnePlus One, so we have one large 3D view. And that's it. From now on I would just continue the usual way again so I will go to the reconstruction tab, I would reconstruct the mesh, texture it and then later do my exports. Let's recap. If you are working on projects like this, where you need to scan both the interior and exterior of the buildings keep in mind that you need to take a lot of photos with very high overlap. In addition you can use markers and other surveying equipment. With disarray equipment you can measure these points and later use them in Reality Capture as ground control points. Please let us know in the comments what kind of topic should we cover next. If you liked this video, please consider subscribing to our YouTube channel. Also you can follow us on other social media like Facebook, Twitter and LinkedIn. My name is Jakub Vanko and thank you for using RealityCapture.