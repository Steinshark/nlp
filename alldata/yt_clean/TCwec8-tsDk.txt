Hello, this is Mark In this video and the next few videos, we're going to cover the But before we start, I suggest you subscribe so that you don't miss OK, if you're ready, let's get started. (upbeat music) See, the truth is, is that Excel has changed, like seriously changed. Every time we used Excel in the past, we accepted a simple operating rule. One formula, one cell. Even with advanced formulas, it was still necessary to But this has changed. Now Excel allows a single And this is possible because Microsoft has changed Excel's calculation engine to allow something called dynamic arrays. Now the term dynamic but once you understand it, you'll appreciate the Let's start with an We're going to begin by looking Here's a formula. The formula is equals, I'm gonna select cells B2 to B6, OK. It's probably not a but it's simple enough for of dynamic arrays. You see, in the old version of Excel, only one cell result could be returned. So if we provided a formula like we have here with Then some assumptions need to be made. And in this example, there are actually two possible results. So I'm gonna press enter here, and we'll see what happens. And in the old version of Excel, we would see a value of 1. And that is because the formula is in line with the source data. So we've asked for cells B2 to B6, and we've put it into cell D2. So therefore, it will return the value in cell B2 because it's in line. If we were to apply the Equals, select the cells There you see we have the value of 3. And that's again, the same principle. We've given it a range of cells, and Excel assumes that we want the cell that's from the same row. Okay, what happens if we use the formula when it's not in line with So let's move down here to cell D7, and we'll type in the same formula again. Equals, and we'll select and I'll press enter. Now this time instead, we get the hash value error. And that's because Excel gets confused. It doesn't know which cell we We have given it a range, but it doesn't know Because it's applying the principle of one formula, one cell. So the assumption that Excel makes here when we provide a range it's got a name. And that name is implicit intersection. But thankfully, you don't need But it's interesting to think that Excel could calculate from the same formula. It could calculate a 1, or a 2, or the, hash value we've seen there. Equally, it could have depending on which cell Now in the past, Excel this implicit intersection method by using Ctrl + Shift + Enter So let's have a quick look at that. Here's our formula. When I press Ctrl + Shift + Enter, as you can see it That's because Excel now understands that we don't want to use But actually, we want to use First we leave that and And then type equals and and then press Ctrl + Shift + Enter. What Excel would do is it would understand that we have an array of values. So in the first cell, we want to return the first value. In the second cell of that array, we want to return the second value. And then the third cell, the third value, etc., etc. But with all of this, we had to press Ctrl + Shift But we don't need to Because if we have a that has dynamic arrays enabled, then actually, this equals B2 to B6 only So let's try that out. Here we have another worksheet. And in cell D2, I'm gonna and press Enter. And as you can see this one formula, equals B2 to B6. Excel has taken that into the cells around it. So that one formula now fills five cells. Now, that's pretty amazing. Because the basic rule of Now the terminology to describe how this happens is known as Spilling. And the range of cells that is called the Spill Range. Now this may not seem like much, but as we go through I hope you'll soon appreciate the power that this really gives us. So you're probably asking, which versions of Excel Microsoft originally announced the change to Excel's calculation And for over a year, it was only available to test early releases And that's part of what's now called, the Microsoft 365 Beta Channel. Regular subscribers on the Microsoft 365 started to receive this And finally, in July 2020, those on this Semi-Annual Update Channel of the Microsoft 365 subscription, which is mostly business users also started to receive dynamic arrays. Microsoft have already confirmed that this new functionality in Excel 2019 or prior versions. So if you want it, now unfortunately, it's time to upgrade to a Microsoft 365 license. When Microsoft announced dynamic arrays, they also introduced six new functions, all of which make use of There's UNIQUE, SORT, SORTBY, FILTER, SEQUENCE and RANDARRAY. While we all get excited by new functions, the introduction of dynamic arrays is much bigger than just these functions. It's a fundamental shift in how Excel and Excel users think about formulas. In the remainder of this post, I want to show you the so that you can get started Okay, so let's look at some As I said a few moments ago, there are new functions that make use of this new spilling functionality. I won't go into detail because we'll have future But the critical thing to realize is that the ability to to those new functions. Many existing functions spill too. So let's have a look at an example. This is a simple scenario, in which we have data in cells B2 to C9. And the data displays a name Let's assume the goal is to calculate the total for each person. So if we don't have dynamic arrays, this is how we would tackle this problem. We could use the SUMIFS function. So I would type equals, The first argument is the sum range. So I want to sum the cells C2 to C9. Comma, the criteria range, with the cells B2 to B9. And then the criteria is where it equals the cell there Tom, E2. Now, close that bracket and press return. And it would calculate a single result. Now if I wanted to see the result for Tom, Dave, Jack and Billy, I could select that cell. I could put some dollars on those by pressing F4 just to drag that down. And as you can see, we would then get a result We've got four formulas and four cells. But wait, if we have Excel's with dynamic arrays enabled, we don't need this at all. Let's clear out those cells. This first formula. We can select E2, and Now if you remember back when we had cells B2 to B6. With dynamic arrays, what happened is it and it spilled them out Well, guess what? I'll press enter, and it's gonna do exactly the same thing. So rather than having four we can have one formula into four cells. Okay, so we've seen SUMIFS. And we've seen that SUMIFS spills if the last argument is provided So which formulas spill Well, depends on the arguments that are required for each function. So basic aggregation functions Well, they don't tend Which makes sense because and they only ever return a single value. Instead, the general that contains an argument in which a single value is expected, that function is likely to spill. Now that single value it's known as a scalar. Let's take a look at another example. Let's use VLOOKUP. Because it's probably a function that we're all familiar with. The first argument in VLOOKUP It's generally a single value. So it's a scalar. If we provide two or more the formula will spill for each of the items Okay, so let's have a go with this. I'm gonna type Dave and also Jack. And then in cell F7. And so equals VLOOKUP, open bracket. And for the lookup value, I'm going to provide not a I'm gonna provide the cells Dave and Jack, so E7 and E8. Comma, my table array. I select those cells up there, E2 to F5. Column index, we two. And I want an exact match, so zero. Close that bracket. And when I press return, as you can see, VLOOKUP for multiple cells. So one function has given us So there we have it. That's the general rule that anytime that we that that formula will spill. But that's not always true, depending on the that you're using. The thing is, we're all still getting used to this new way of thinking And I'm sure that over time, new ways of thinking about will develop. Now let's move on to think about By clicking on any formula that spills, what we'll see is that there's a blue box that highlights the area Everything within that by the top left cell of that box. Now I can select other cells So if I select the second have a look at the formula bar. When I click that, you'll see that the formula turns gray. And that's because I can't Because the formula The formula is always in the top left. But if I do select that first cell, yes, I can edit it there. The formula bar has turned black, and I can now edit that function Now you might be thinking, what happens if I already have some values in the cells that the spill Well, let's assume that we have And as you can see here, it's picked up our VLOOKUP, let's just clear that. It's got something that's in the way, and we get to see the new spill error. By clicking on the spill error, we get to see rather a dotted blue line. And that's highlighting the area that that formula would spill into. However, we've got an issue. We've got something that's in the way. And then it becomes your choice. You can either move the formula, or you can move the So let's just delete that. And as you can see, that then spills again to fill the space that Now the spill error can It can happen where the spill range is outside the available Or if the spill range has an unknown size. The spill error also occurs if you try and use a dynamic array Or if the spill range It can also happen if the spill range is so large that Excel runs out of memory. As formulas can spill we now need a new way of that spill range. Well, thankfully, Microsoft and has created a new referencing And it involves the hash depending on what country you're from, and how you might refer to it. So here in our example, the top left cell in the So we could reference that entire range by using F2 hash or F2 pound symbol. So here, I could type equals, click F2, press the hash key. There we have it. And it's now referenced all the cells that is filled by the spill And we can also use this So for example, if I wanted (keyboard typing) Average, I could type equals. (keyboard typing) AVERAGE function, I can press F2, press hash, close that. And as you can see F2 hash has already filled the When I press return, it will of all of those cells. Okay, now let's move on to Constant arrays have However, given the the use of constant arrays is likely to significantly increase. Let's turn to VLOOKUP again. So in cell G3, it felt equals VLOOKUP, open bracket. Now I select Tom. So just a single scalar. And my table array is going Now normally we would provide However, in this circumstance, we can actually provide a constant array. So we'll put a curly bracket, and then enter two comma And they we want an exact match. I now close that. And then I press Enter. And as you can see for Tom, it's returned the values of 74 and 67. And that's because this formula So let's look at this formula again. And here you can see the two and the three. That means that Excel a column index of two and And it's returning into cell G3 and H3. Using the old method, we would have required two formulas, or maybe selecting those cells and pressing Ctrl + Shift + Enter. But now, just by using a constant array, it will automatically spill those results into the other cells. You see, constant arrays aren't they just sound complicated. Now just one thing to be aware of. Columns are separated by commas, and rows are separated by semicolons. So if we wanted to spill instead of across the columns, we would use a semicolon So let's try that. Take out the comma, enter And as you can see those What happens if we want Excel the same way that it always did? So let's head back to And we know that if we it will spill those results in that range. If we want to use implicit intersection, all we have to do is use the @ symbol. So there we go equals @ B2 to B6. And we can press return, and Excel is now using So if we were to copy that down, get a three as we had before originally. And if we paste it in there, we'll also see the hash value error. Because Excel is operating the way it did before we had dynamic arrays. To ensure that formulas of Excel continue to the @ symbol will be added to a lot of formulas automatically when they've been created in and opened in a new dynamic And this means that workbooks created in old versions of Excel they should still as they always did. Now, that doesn't mean that that we'll look at in the next few videos, exist in previous versions If you try and use one of those, you'll get a hash name error. However, it does mean an existing function that works in both the traditional version of Excel and a dynamic array actually that function will I'm sure you've now got around your mind about dynamic arrays. And there's lots of new terminology and lots of new ways of working in here. And while the changes may you'll soon see this brings which makes Excel much easier to use. I hope you'll hang around when we'll start looking more And specifically, some of the new dynamic array functions that were introduced of this new methodology. Okay, that's it from me. If you like this video, don't forget to subscribe, And I'll catch you next time. (soft music)