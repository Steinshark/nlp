Welcome to Jeremy's IT Lab. This is a free, complete course for the CCNA. If you like these videos, please subscribe Also, please like and leave a comment, and of videos. Thanks for your help. In this video we will cover NTP, Network Time All computers have an internal clock, including For a variety of reasons that we will cover devices have an accurate clock that is synchronized That's the purpose of NTP. NTP is covered in exam topic 4.2, which says NTP operating in client and server mode. Over the next section of the course I will 4.0, IP Services. This video on NTP will be the first. Here's what we'll cover in this video. First I'll briefly explain why time is important Then I'll show you how to manually configure Then we'll cover the basics of NTP, Network Finally I'll show you how to configure NTP Make sure to watch until the end of the video ExSim for CCNA. ExSim practice exams simulate the style and other practice exams. I used them myself, and I highly recommend If you want to get Boson ExSim, follow the First, let me briefly introduce time on network All devices have an internal clock. That includes routers, switches, your PC, In Cisco IOS, you can view the time with the Here's some sample output. So, I used this command at 12:16 AM, 0 seconds, On Saturday, December 26th 2020. The time zone is the default of UTC. Remember that, the default time zone is UTC, If you use the SHOW CLOCK DETAIL command you In this case it is using the hardware calendar The hardware calendar is the built-in internal This is the time source by default. However, notice this asterisk here. It means that this time is not considered The device isn't confident that this time The internal hardware clock of a device will source. Now, why is it important to have an accurate From a CCNA perspective, or really the perspective reason to have accurate time on a device is Devices keep logs of various events that occur, OSPF neighbor relationships being formed or Syslog, the protocol used to keep device logs, a later video. But let's take a quick look at some device The command to view a device's logs is SHOW Let's say I'm a network admin and I got connection has been unstable. So, to investigate I log into one of the devices Here's a portion of the output from one Notice this series of messages about OSPF There are multiple messages about neighbor DOWN state. You can see the timestamps here, indicating to 1:09AM. Note that I will cover these log messages don't worry about the details for now. I just want to show why time is important. Anyway, I then checked the device's clock 27th 2020. Then I log into R2's neighbor 10.0.0.6, Here's some of the output from SHOW LOGGING. You can see those same messages about an OSPF states, and also some messages about an interface However, the timestamps show a totally different After checking the clock I realize that R3 This is going to make it much more difficult In this case, it's a fairly simple issue. We can see that an interface going down caused happened. But when you have to troubleshoot more complex of messages, it gets much more difficult and So let's see how to manually configure the You can manually configure the time on the with the CLOCK SET command. Let me walk you through it. I entered CLOCK SET and used the question Using the format of hours, minutes, seconds, The next option is either the day of the month You can enter them in either order. I entered the day first, and then the month. The next option is the year. I entered the year, 2020, and checked the CR, carriage return, basically means press There are no other options. After entering the time I checked with SHOW is displayed. The time source also has changed to 'user Notice that all of these commands are done mode. These clock configurations aren't part of are separate. Here's one more point a lot of people might Although the hardware calendar (the built-in clock and software clock are separate and So let's see how to configure the hardware You can manually configure the hardware clock So, from now on I will use the term 'clock' device, and 'calendar' to refer to the So, the command syntax is the same as CLOCK Set the time, and then either the day or the I set the day, and then the month, and the Then I set the year, and then used the command Typically you want to synchronize the clock I can't think of a good reason not to sync Use the command CLOCK UPDATE-CALENDAR to sync The calendar will update its time to match Or, use the command CLOCK READ-CALENDAR to In this case the clock will update its time Let me demonstrate. First let me demonstrate CLOCK UPDATE-CALENDAR. I viewed R2's clock, and the time was about say that's the correct time. However the calendar was about 12:00AM. So, I used the CLOCK UPDATE-CALENDAR command. And now you can see the calendar has been Next let's see the opposite situation, when time is incorrect. The clock says it's about 12AM on September The calendar has the correct time of 2:55PM So, I used the command CLOCK READ-CALENDAR. And the clock updated its time to match the Next let's see how to configure the timezone. You can configure the time zone with the CLOCK Let me walk you through it. First I used the DO SHOW CLOCK command to time zone of UTC. Notice I used DO SHOW CLOCK from global config commands. That's because the timezone is configured the running config of the device. So, here's the CLOCK TIMEZONE command. The first option is the name of the time zone. This is just a word, the device doesn't time zone. So, I configured JST for Japan Standard Time, UTC. JST is 9 hours ahead of UTC, so I entered For JST I don't have to enter the minutes TIMEZONE JST 9. Then I viewed the clock. Notice the time zone has changed from UTC 9 hours ahead. This is because the previous time configurations When changing the time zone to JST, 9 hours But currently the time actually is about 3:15 and now it displays the correct time in the The time zone is important because, as you'll adjust each device to the correct time zone. There's one more aspect of manual time configuration That is daylight saving time, also known as Not all countries do this, but in many countries then back once a year. You can configure Cisco devices to do that Now, I live in Japan at the moment and Japan use my home country of Canada as an example. In most parts of Canada we set the clocks at 2AM, and then set the clocks back one hour The command to configure this is CLOCK SUMMER-TIME, The first option is the name of the time zone. My time zone back in Canada is EST, but during so that's what I set. Then we can set a specific date to change but the more useful option is the second one, This makes summer time start and end on the After recurring, we specify which week in In Canada it starts on the second Sunday of Next is the weekday, so I entered Sunday. After that it's the Month, March for Canada. Finally the time, I entered 2AM. Okay, so that's all for the start time. Now we enter the end of daylight saving time 1 for the first week, the weekday, Sunday, 2AM again. Optionally you can specify the offset, but what most countries use by default. So, that's all for the command. Notice the dollar signs here. This command is a little long, too long for some of the output is cut off and can't So, I typed it out here. CLOCK SUMMER-TIME, the time-zone name, RECURRING, and the end of daylight saving time. Okay, that's the CLOCK SUMMER-TIME command. So, that's all for manual time configuration. Here are the time commands we just looked The CLOCK SUMMER-TIME command is a little Just remember that for the 'start' and month, and time. Okay, let's move on to the next topic. And the next topic is the main topic of this Manually configuring the time on devices is In a large network, manually configuring the PC, phone, etc, would be a huge task and a Not only that, the manually configured clocks NTP allows automatic syncing of time over The device you're using to watch this video For example, on my Windows 10 PC you can see with time.windows.com. That is an NTP server somewhere on the Internet. And actually, you can configure this. So, for example, if I wanted my PC to synchronize server, I can change it here. This point is separate from the topic, but resolved to IP addresses using the protocol DNS will be covered in a future video, it's In the CLI of my Windows PC, I used the command It contacted the DNS server I'm using, which of 8.8.8.8. Then Google's server gave me the answer. The actual IP address of the Windows NTP server I tried the same with Google's NTP server, Again, my PC asked the Google DNS server for is the answer. You can see four IPv6 addresses and four IPv4 Anyway, DNS will be covered in detail in another preview. Okay, back to NTP. So, NTP clients request the time from NTP to the time of the server. It's possible for a device to be an NTP So, it will sync its time to a server, and it. These are rough numbers, they can vary, but millisecond if the NTP server is in the same to the NTP server over a WAN or the Internet. Some NTP servers are 'better' than others. The 'distance' of an NTP server from the The farther away from the reference clock, If the stratum level of a server is high, NTP uses UDP port 123 to communicate. Remember that one, in addition to the ones Let me briefly introduce those reference clocks. A reference clock is usually a very accurate clock. Reference clocks are stratum 0 within the They are as close to the time source as possible, NTP servers directly connected to reference You'll see more about this NTP hierarchy Here's an example of a reference clock, Cisco devices aren't able to get their time like this, but they can get their time from This diagram demonstrates the NTP hierarchy. These reference clocks are stratum 0, they Navy clock we saw in the last slide. The servers directly connected to those reference Then, stratum 2 NTP servers get their time And stratum 3 servers get their time from That's how the NTP hierarchy works. However, stratum 15 is the maximum. Anything above that is considered unreliable Another aspect of NTP shown in this diagram Devices can peer with devices at the same This also acts as a backup, in case they lose This mode is called 'symmetric active' So, Cisco devices can operate in three NTP Server mode, Client mode, and symmetric active They can be in all three of those modes at And finally, an NTP client can sync to multiple For example, in this diagram this stratum stratum 1 servers. Here's some extra terminology you should NTP servers which get their time directly servers. They sync their time directly to a reference NTP servers which get their time from other They operate in server mode and client mode So, servers with stratum 2 or above are secondary Okay I think that's enough lecturing, let's more aspects of NTP as we configure it on Here's the network topology I'll be using I'm showing you an actual screenshot of The Internet cloud. Through this Internet cloud in GNS3, these the real Internet, and in this demonstration over the Internet. This is a cool part of GNS3 that isn't available Now, you might be wondering why this point-to-point using a /24 prefix length. That's just how this cloud is configured For a real point-to-point connection to an or /31. So let's configure R1 to sync to Google's Once again, here's the NSLOOKUP I did for I'll be configuring all four of these IPv4 Here's the command. NTP SERVER, followed by the server IP address. The order of these doesn't matter. R1 will ask all of them for the time and select And the one it selects to sync to might change start slowing down or it stops responding So, it's best to specify multiple NTP servers of time. Now, if you want to manually make the device can add PREFER to the end of the command. So, this would make 216.239.35.0 the preferred But for this demonstration, I didn't use we'll see which of these NTP servers was Here's a very important SHOW command for It shows all of the NTP servers we just configured. Here are the servers. Now, you don't have to understand all of out a few things. Notice the asterisk next to 216.239.35.0, This means that this is the NTP server that This plus sign next to the other servers means syncing its time to them. The tilde next to all of the servers simply in the previous slide with the NTP SERVER If you see an NTP server marked as an 'outlyer' sync to that server, for example R1 might The details of these states are beyond the Here you can see the reference clock of each All of these servers are using Google's That is a stratum 0 reference clock, so here four of these servers have a stratum level I used the SHOW NTP ASSOCIATIONS command again, as the server it wants to sync to. This will constantly change as R1 continues one is the best to sync to. Now let's look at another useful NTP SHOW That command is SHOW NTP STATUS. There's a lot of information here that you out the top line. Clock is synchronized, that's good. It means that at least one of the NTP servers sync to it. Stratum 2, this is R1's stratum. Because R1 is synchronizing its time to Google's server itself with a stratum level 1 higher So, that's why R1's stratum level is 2. Finally you can see the address of the reference This time it's not 216.239.35.0 or .4, it's Now let's check R1's clock and calendar I used DO SHOW CLOCK DETAIL. The time is correct, however the time zone NTP uses only the UTC time zone. You must configure the appropriate time zone I haven't configured R1's time zone yet, I also used the DO SHOW CALENDAR command. Notice that the time is not synced up with NTP doesn't update the calendar by default, the calendar. So, I configured my time zone of JST here Then I used the NTP UPDATE-CALENDAR command. This configures the router to update the hardware via NTP. So I checked the clock and the calendar again, You might be wondering why you would want The hardware clock tracks the date and time lost, etc. When the system is restarted, the hardware So, it's a good idea to keep the hardware essential. Now we're going to move on to R2 and configure Usually in a small network like this you'd to public NTP servers like Google's. But for the purpose of this lesson I'll But before doing that, I'll configure a Note that I've configured OSPF in this network including the route to R1's loopback interface. I also instructed R1 to use loopback0 as the loopback0 command. So, any NTP messages it sends will come from Why configure a loopback interface? Well, let's say I configured R2 to use 10.0.0.1, In normal situations it would be able to send R1. But what if the interface failed for some R2 would suddenly lose its NTP server, because on the status of R1's G0/1 interface. But what if we configure this loopback interface as its NTP server? Even if the closest path to R1, via R2's a route to 10.1.1.1 to R2 and therefore R2 NTP server, R1. I gave a similar demonstration of why loopback Basically they are useful because they provide it which isn't dependent on the status of Okay, so on R2 I configured NTP SERVER 10.1.1.1, Notice the asterisk next to 10.1.1.1, that R1's reference clock is displayed here. This is the IP address of one of Google's R1 is syncing to. And here R1's stratum level of 2 is displayed. Google's reference clock is stratum 0, Google's 2. So, what stratum is R2? I checked with DO SHOW NTP STATUS. R2's stratum is 3, because it got its time R2's reference of 10.1.1.1, R1, is displayed As a reminder, remember to use the NTP SOURCE as the source of NTP packets on R1, if you sync with R1. Finally I configured NTP on R3. Here are the configurations. By the way, I configured a loopback interface I configured both R1 and R2 as NTP servers Between R1, 10.1.1.1, and R2, 10.2.2.2, which why? Let's check. R1 is the preferred NTP server. Why is that? It's because of the stratum levels. NTP servers with lower stratum levels are source. So, they are considered more accurate. Okay, so I've shown you how to make a Cisco SERVER command. For the next few concepts I'll use a different If a device is already syncing to an NTP server, acts as an NTP server too and other devices But what if there is no NTP server to sync You probably still want the devices in the is slightly inaccurate compared to the actual So, how can you manually configure a Cisco it isn't synced to another NTP server? This is the command. NTP MASTER. As the description says it makes the device So, on R1 I used the NTP MASTER command. Notice that I can specify the stratum of R1. However I chose to just enter the command, level. What's the default? Let's check. I used SHOW NTP ASSOCIATIONS. The address of R1's NTP server is now 127.127.1.1. What kind of address is that? It's a loopback address. Remember, the entire 127.0.0.0/8 address range Loopback addresses and loopback interfaces are similar, so don't confuse the terms. Loopback interfaces are virtual interfaces to other devices using OSPF etc. Loopback addresses are a totally different to the local device and can't be reached Basically, R1 is using itself as its reference Anyway, the stratum level of this server is So, what is the actual stratum level of R1? I used SHOW NTP STATUS to check, and the answer So, remember that the default stratum of the And I configured R2 and R3 to use R1 as their We've already covered that enough so let's mode. So let's configure symmetric active mode They both have a stratum level of 9, so they They can become peers and help each other case they lose contact with R1. The command to configure symmetric active address. So, I configured R3 as R2's peer. And here is the entry for R3 in R2's NTP R3's reference clock is R1, 10.0.12.1. Its stratum level is 9, because R1's is I did the same configurations on R3, specifying Again, the reference clock is R1 and the stratum Okay the final topic for today is NTP authentication. I can't say for sure if this is on the exam some don't. But I recommend learning these few commands NTP authentication on the CCNA exam. NTP authentication can be configured, but You don't need to configure it. It allows NTP clients to ensure that they They will check that the server is using the are the same. Here's how you configure NTP authentication are configured the same. First, enable NTP authentication with the Then you create the authentication key or You can create multiple keys, but don't So, for the 'key-number' field just use is the password itself. Then you have to specify which key or keys Don't forget this step. Creating the key uses one command, NTP AUTHENTICATION-KEY, command, NTP TRUSTED-KEY. Finally you must specify which key to use This command isn't needed on the server Now let's look at these configurations on Here are the configurations. On all three routers I used NTP AUTHENTICATE, of jeremysitlab, and NTP TRUSTED-KEY 1. Then on the clients R2 and R3 only, I used So, they will use key number 1, which is jeremysitlab, I also did one extra command, NTP PEER, followed This adds authentication to the peer relationship Okay, so that's all you need to configure In addition to the manual time configuration To help you review, here are the commands If you don't remember any of these, go back Before moving on to the quiz, let's review We looked at why time is important for network The main reason from a CCNA perspective is devices. Then we looked at how to manually configure Then we looked at the basics of NTP and how We covered a lot already, but there is so However I think the information we covered the CCNA exam. Make sure to watch until the end of the quiz ExSim for CCNA, the best practice exams for Okay, let's go to quiz question 1. Which of the following commands will cause match the hardware clock? Here are the commands. Pause the video to think about your answer. The answer is C, CLOCK READ-CALENDAR. This will cause the router to adjust its software D will do the opposite, it will cause the the software clock. A and B are not valid commands. Okay, let's go to question 2. Which of the following commands can be used Here are the commands. Pause the video to think about your answer. The answer is D. From global config mode, offset. Unlike some other time commands, this command exec mode. You cannot configure the time zone with the Okay, let's go to question 3. Examine the output below. Which of the following commands was configured Here are the options. Pause the video now to think about your answer. The answer is A, NTP MASTER 9. Because the address of R1's NTP association that the NTP MASTER command was used. However, in this case the stratum must have The default stratum of the NTP MASTER command effect. In that case, however, SHOW NTP ASSOCIATIONS In this output the stratum is 8, so the command Regarding option B, the command NTP SERVER You can't manually configure a loopback it displays this way when the NTP MASTER command Okay, let's go to question 4. Which of the following commands configures Here are the options. Pause the video now to think about your answer. The answer is C, NTP SERVER 216.239.35.0. It configures R1 to become a client of the A, NTP PEER, configures symmetric active mode. B, NTP MASTER, configures server mode. And D, NTP CLIENT, is not a valid command. Okay, let's go to question 5. Which of the following commands must be configured Select all that apply. Here are the options. Before I show the answers, let me say that multiple answers, the question will always Select two, select three, etc. But for a challenge, let's try 'select Okay, pause the video to think about your The answers are C, D, F, and G. C enables D creates the authentication key. F specifies that the key is a trusted key. And G specifies the key to use with the server. Okay, that's all for the quiz. Now let's take a look at a bonus question Okay here's today's Boson ExSim practice question. Which of the following is enabled on a Cisco from global configuration mode? Select the best answer. Here are the options A, static client mode. B, symmetric active mode. C, broadcast client mode. D, server mode. And E, authentication. Okay pause the video now to select the best Okay let's check. So this is closely related to one of the quiz the correct answer. When you issue the NTP SERVER command you're sync to. So you are making the router an NTP client. So the answer is either A or C. Now in my and broadcast client. I don't think you need to know this for the So the regular kind of NTP client that you is A, static client mode. So that should be the correct answer. I'll click on show answer. And yes that is correct. So here is Boson's explanation. If you want to read about the broadcast client Okay, so you can pause the video to read that. And down here are the bottom there is a reference SERVER command. Okay so that's Boson ExSim for the CCNA. As I have said many times before, these are So if you're preparing to take the real CCNA If you want to get Boson ExSim, please follow There are supplementary materials for this There is a flashcard deck to use with the There will also be a packet tracer practice That will be in the next video. Sign up for my mailing list via the link in the flashcards and packet tracer lab files Before finishing today's video I want to To join, please click the 'Join' button Thank you Benjamin, Tshepiso, Justin, Prakaash, Nasir, Value, John, Funnydart, Velvijaykum, Mark, and Vance. Sorry if I pronounced your name incorrectly, This is the list of JCNP-level members at 29th 2020. If you signed up recently and your name isn't videos. Thank you for watching. Please subscribe to the channel, like the with anyone else studying for the CCNA. If you want to leave a tip, check the links I'm also a Brave verified publisher and accept Brave browser. That's all for now.