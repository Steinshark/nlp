you can't be real that adding three missing characters made your code run 20x faster just this feels false and unreal no in the fall of 201 every time I see this it's it's like those you know people always talk about you know you see it on Tik Tok a lot and Tik toks of course is programming for normies and it'll be like oh it'll show a guy like searching for you know hours and then they'll miss a semicolon click the semicolon and then they'll be like their program runs they're like programming am I right and it's just like man I hate that programers the programming sucks on Tik Tok and so when I see this it just this is what that's like the that's what I conjure up in my head is that thing where it's just like programming am I right anyways in the fall of 2020 users started reporting that our map charts were not uh were now slow a lot of people used our Maps so this was a problem and we wanted to fix okay K means was the culprit okay that's okay we got weighted means right to okay crazy crazy that this is the okay we're going right into the meat apparently I by the way I love this this article goes straight to the point this is beautiful to color our Maps an engineer on our team utilized a very effective technique called K means clustering but I've done this by the way ml mentioned practically which would identify optimal clusters and assign a color to each but recently our charts were using record amounts of data and K means was getting slow using Chrome Dev tools I was able to quickly determine the K means function that was causing a Slowdown okay okay we didn't write the K means function ourselves instead we used a function CK means I think I've used this one I I I'm pretty sure I've used this function is this thing like 12 years old I'm pretty sure I've seen this I'm pretty sure we've seen this thing how far can we go up maybe not oh my goodness requirejs extension a nice play with Dino uh uh uh oh oh JavaScript is so good JavaScript is so good my first naive thought was that I could just quickly write a better K means function that didn't take long to realize that it was non-trivial problem that should uh that should be Last Resort yeah K means is a semi difficult problem uh it's a it's an N cubed right is that the runtime n cubed or is it more No it's it's N squared okay I know clustering is not easy uh my next move was to look closer at the open source implementation we were using I learned the function was JavaScript Port of an algorithm introduced in a 2011 paper and the comments in the code claimed it ran an N log n time that didn't seem to match what we were seeing so I decided to write a simple Benchmark script indeed my Benchmark resulted indicated CK means was closer uh to that much slower N squared class than the claimed n login this how much do you want to bet this is like a JavaScript oopsie Daisy how much do you want to bet this is like a classic JavaScript Oopsy Daisy here JS for ML is crazy you you really you think JS for ML is crazy well let me tell you buddy one of my proudest achievements is when I was getting my masters I also wanted to learn JavaScript so I write I wrote neural Nets okay multi-layered perceptrons okay we got radial basis functions okay we got adaptive neuro inference fuzzy systems or whatever they're called okay I did that adaptive neuro fuzzy inference systems let's do that okay I did that I brought the brains to JavaScript okay I was just learning these things a long time ago 2013 you get a pass it was 2013 I didn't know what I was doing okay I was I was 26 years old um I I thought Vim was stupid okay I was still using net beans for most of my stuff all right it was a diff it was a different world okay some of you don't even know about that world okay that beans shut up okay after triple checking my logic I created an issue on the simple statistics repo with a benchmark script mere hours later I had one of the most delightful surprises in my coding career a teammate had unbeknownst to me looked into the issue and found a fix okay let's look at the fix I don't know what I'm doing but this way around it's closer to what the reference implementation does and the test still pass when you want the row or when you want to compare against columns but you compare against rows it's why you got to call it roax okay not IMAX it gets me every time R Max always use RS and C's when you're dealing with rows and columns it just makes life so much easier to not Oopsy Daisy well well yeah it looks like a typo that just survived because it was over checking rather than under before after uh he had read through the original K means C++ imp implementation and found a condition where the C++ version had a uh bracket zero but the Java scrip report did not at runtime Matrix length would generally be small whereas uh Matrix zero length would be large that if statement should have resolved uh to True most of the time but it was not in the JavaScript version since the JavaScript code was missing the bracket zero it led JavaScript version to run a loop a lot more times that were effectively noops I was amazed by how fast he W found that bug in the code he had never seen before nice nice I mean that's one beautiful part about C based languages right if you do c based languages and try to keep your implementations near each other it's like it can't be sometimes it can be really easy to spot these things um I'm not sure if he read carefully through the original paper or came up with the clever debug strategy since uh of since this port uh let's compare the original looking for typos with particular focus on Loops I mean that seems like the reasonable place right if you're running if you're going from n log n but instead you're running n squar that means you have a loop in a loop running that should not be running right it it should be that should be at least a dead dead giveaway that something is causing extra Loops uh the typo fixed uh fix made the JavaScript version run in the claimed nlog n to match the C++ version for our new maps chart with tens of thousands of values this made a big difference yeah that's a huge difference that's a huge difference damn are you balding no thank you for asking though first time chatter first time chatter making into a YouTube video I not balding I'm not balding you know I am getting older so yeah I got some thinning of hair that's natural natural to happen thank you for the question am my balding no oh you're definitely balding sneaky sneaky is definitely balding this man's projecting like he's never projected in his lifetime first message your voice is sexy and the fix too thank you asmin code yeah I'm not asmin bald okay I'm not asmin bald uh you can easily see the difference when you look at the time needed for an additional uh row as the number of row increases yeah wow beautiful absolutely beautiful very shortly after he submitted the fix the creator of simple statistics reviewed the and merged it in we pulled the latest version and our Maps were fast again as a bonus anyone who use a simple statistic K means function now gets a faster version too let's go let's go that I mean dude I don't know has anyone here translated formulas from a book okay guys I'm mding right now who here screwed up the uh that dude who here screwed that up when I was doing when I was doing ml stuff the amount of times I effed that up with neural Nets was incredible back prop back error back propagation it's it's just it's just the it's the worst thing in the universe you how many times that I screwed up back propagation with gradient descent the answer is too many to remember a number the Monte Carlo problem I screwed up gradient descent so many times who hasn't screwed up gradient descent for those that actually for those that actually programmed models and actually created uh models how many of you uh especially during these simple MLP days how many of you I love you had a learning rate that was too high and you discovered that you could not do anything like when because for us we had to do like uh the Rosen Brock function like six figure uh six uh six-dimensional Rosen Brock function dude learning rate learning rate all of us dude it was just like such a dude it's dude it was so sagge it was so sag I had to do back propop on a paper which sucked you had to do back propop well who hadn't didn't have to do the who who didn't have to do a little back propop on the paper okay you had to prove that you knew it I uh let's see I've had a learning rate that was too fast on Hardware yeah why isn't it doing anything why is it just getting one value out overtraining over fitting was like such a real deal thank you Izzy by the way I love milk skin and coffee baby who doesn't like a little milk skin in the coffee all right hey the name is back prop took about two days to get correct but learning rate took about six days and I also had to go and ask my professor why I couldn't get anything to work because I didn't understand the fact that learning rate was actually such a painful piece of crap why can't I identify handwriting why is this why do you want a nurl net per letter and then nurl net of World Net letter recognizers to get it to work and why is RBF so good if you have the same handwriting why is this happening what's wrong with my life and that's how I kind of figured out how to do uh models you know a Jan