cloud flare took down our website after trying to force us to pay $120,000 within 24 hours i'm very curious about this because this this whole force us to pay $120,000 my first thought is how did you get a bill that was $120,000 okay we've been on the cloud flare business plan $250 for years and then suddenly contact uh they suddenly contacted us and asked us to either pay them $120,000 upfront for one year of enterprise within 24 hours or they would take us down uh take down all of our domains while this escalated up our business we had three uh three sales calls with them trying to figure out what had happened and how to reach a reasonable contract in a week when we told them we were also in talks with fley they suddenly purged all of our domains causing huge downtime in our core businesses sleepless nights uh migrating away from cloud flare irreparable loss in customer trust and weeks of ongoing down down time in our internal systems dang okay there okay what but what was the i i got a what what was the i i'm assuming we're going to get the you know the motivation coming up here but i got to know why cuz was there something that i mean there has to be some piece of context that we're missing that makes it reasonable that they could say they're charging $120,000 now the whole $24,000 the thing that doesn't make any reasonable at all is that giving them 24 hours to respond or else they're taking down our domains like that sounds wild to give somebody such a small window to respond to such a huge bill you think they'd have a slightly different approach here all right i'm a ssops engineer at a fairly large online casino and this article is relevant regardless of whether you think that in general casino casinos are ethical or not okay fair you know answered my first thought okay good uh i'm just mentioning uh it for context we have around 400 million monthly active users we had been happy cloudflare customers since 2018 on the business plan which has some neat features and cost $250 a month for unlimited traffic your site is cringe pay 120k or be purged i know that's okay that's how i'm currently reading it now admittedly $250 is probably fairly low for the amount of traffic we were pushing through cloudflare we mainly use uh cloud flare for cdn caching all of our static content and dos protection for which works pretty well it's easy to use and you don't usually have to think about it much uh i have read a few articles on hacker news about how at some point cloud flare contract uh contacts you asking you aggressively to move to enterprise with custom pricing but i wasn't expecting it to go this horribly okay april 19th 2024 in april we received uh this email all right hi from cloud flare there are some serious issues with your cloudflare account settings that are potentially affecting our network please contact us to resolve the situation as a matter of urgency it is very important that we speak to resolve the situation asap okay perfect this sounds like there's some issue with our website we scheduled a call with their business development department it turns out the meeting was with their sales team what you know if i received an email like this i would assume that i have done something that has been very very bad and i would uh you know we would have to pull people out of meetings make sure people are pre-prepared have all the right people in the in the room i' probably you'd probably also escalate it up the chain and have some sort of higher level person for visibility probably in the meeting as well some sort of vp of some sort something like that right i think that would make sense that if you got this call you would want a very like official meeting to happen so that way your company is like prepared for anything does kit boga know about this should kit boga get on the business plan for a while 11:00 a.m. on mondays a dead giveaway interesting interesting interesting i never really thought about that that if this was a potentially affecting the network of cloud flare it wouldn't be for hey would monday work it would be hey can we go right now like we need to meet as soon as possible when is the next moment we can meet that's probably a good point okay okay and they didn't have a serious issue to report at all they asked us whether we would like to consider enterprise we polly declined a bit confused as to the tone of the email yeah that is a bit confusing two weeks later we received another email hey ray ray from cloudflare hello as part of our routine monitoring your account and domains were brought to our attention following intelligence of your account being involved in domain rotation activities namely activities to evade or otherwise circumvent uh blocks being placed on you by third party usage of cloudfare services for this purpose is strictly prohibited we would request you provide information as to what your account and domains are being used used for within the next 48 hours note that your account may be terminated should you fail to respond otherwise react to this notice note when we let's see when responding please uh make sure to keep this in the subject line okay now this needs a bit of context on what they're talking about we do have multiple domains that mostly act as mirrors to our main domain we have a few of these uh for or we have these for a few reasons one is that since we are casino we have different regulate regulatory requirements we need to comply with in many countries for example uh many games are only available in some countries some countries we block completely then we have a few different domains that remove certain game groups or site features for example our social feature chat user tipping interaction or our sports book another is that we use them to target different global user groups and affiliates and track conversions longterm you know i'm trying not to read this with you online gambling gross just so everybody knows just don't like that you know i i'm not a huge online gambling person like i understand if i were to do betting sports betting at least makes somewhat most sense if i were to be a betting man i'd bet with options in the stock market if i couldn't bet with options in the stock market i would then go to sports betting if i could do sports betting i just don't see how i could do anything else is options uh trading considered gambling yeah i'd consider gambling right you're betting on the future you can't know the future therefore right now there's some skill involved uh what about online casinos i generally think online casinos are groy right because like slot machines are designed to pay out at a certain percentage even if it's 99% you long-term lose 1% of your money there's like no way out of it right but anyways i digress shall we go back this also means that uh that if the country dns blocks are main domain a secondary domain may still be available this could arguably seen as violation of the cloud flare tos as they wrote above in many cases we receive about 95% of our traffic through our main domain uh that's been unchanged since our founding and we have we are and we happy to resolve this issue in whatever way including by removing any affected secondary domains from cloud flare we sent them info about our domains and tried to get more information from them about the issue and who from our team we should get involved but they refused to give us anything apart from the date for a call okay so we scheduled another call and now with their trust and safety team uhoh ain't ain't no way there's trusted say dude i don't know what it is for me but anytime there's a team that's named in some sort of positive word such as trust and safety i immediately just go orwellian in my brain i'm just like a the old trust and safety team yeah right yeah you know hey i wouldn't want uh you to unsafely fall down any stairs this week but i'm just letting you know that if you don't comply maybe some of those stairs might feel a bit slippery next week and i i'm just warning you i'm here for your trust and your safety that's why i'm warning you crew is back the crew the crew comes in okay so we scheduled another call now with their trust and safety team but it turns out uh we were actually talking to sales again oh my goodness you can't be real you can't you can't bamboo with somebody like that that do not even right what wow my opinion of cloud flare is just rapidly changing i'd love to hear the response to this they said they could offer us an amazing contract for 10k per month with all kinds of great features we tried figuring out what how exactly this was related to the tos problem and how to resolve the situation we asked them which domains were affected by the rotation concerns they didn't give us answers uh we asked which of the enterprise features we actually had to get they would not offer us anything apart from the full deal for 10k per month which would magically resolve this issue they were not interested in any other resolution they said we had 24 hours to sign their contract because they had to get back to trust and safety we asked to pay monthly they said we need to sign a yearly commitment and pay the full year upfront this felt like extortion pay us 120 grand until tomorrow or we destroy your business after this call they sent us this you know get back to trust and safety what is that even mean we had to sign their contract because they had to get back to trust and safety what does that even mean this the statement this whole thing is so confusing as discussed find below our uh summary of the solution needed for your use case as well as a preliminary prelim preliminary a quote uh cloudflare enterprise plan with a bi a bio ip you can lease ips and we will onboard and advertise them on your behalf uh helps us add/ change host names mirrors with 3 second propagation and without need okay uh enterprise plan advanced dos wff cdn dns certificates fully managed uh argo smart routing optimized content delivery and faster routes up to 70% latency improvement advanced cash control image resizing workers zero trust access raw logs uh site analytics priority support uh man if this is priority sales i can't wait for priority support this just sounds great assign account manager and solutions engineer advanced proactive notification role-based access let's go look at this and the commercial plan just starts at one low payment of $10,000 a month man with the default annual payment including enterprise plan based on 80 terabyt 60 6 billion request your domain names and host names for rotation two top level domains 15 mirror domains note the email implies a monthly payment might be possible when asked for a clarification we were told we must pay a year upfront we do not need most of these features they mentioned uh i understand asking us to do uh bio uh to remove their liability for our domains but the rest is all things we don't need or purely nice to have we managed to buy a week of time by letting it escalate to our ceo and cto and having them talk directly with cloud flare but still they didn't care about the other resolutions to the issues and refused to give us any other contract options finding numbers online is difficult but if you squint your eyes a bit compared to this post and this post i've seen cloudflare enterprise accounts for two clients the current one is paying the equivalent of uh oh jeez okay uh three three and a half cents per gigabyte the other was substantially higher although i forgotten the numbers equivalent pricing from another vendor for the same service with enterprise would support oh for 0.2 cents wow uh for an honest bandwidth offer i'd much sooner consider fly io rather than cloud flare at least fly uh their true pricing is transparent okay okay uh we were reasonably mediumsized company with a very tight it budget we were previously on a google compute platform cf sales team saw us uh saw us use their free version and we're happy to onboard us with their business plan $200 a month wow this kind of sounds familiar i'm not squinting too hard now after a year and a half roughly cf wants us to move to enterprise plan claiming we are consuming a lot more bandwidth than what is allowed for the business plan and they won't be able to provide us a good uptime percentage at this rate a lot of this stuff wasn't communicated when we signed up for the business plan wow okay okay well this i mean there's not much squinting that has to be done here uh there was no mention of limits nor any contracts nor uh fine print the business plan was pitched uh to us as if it was the only plan we'd ever need and now cloud flare wants us to pay $3 to $4,000 a month which they clearly don't have a budget for i checked their fine print it says nothing about limitations whatsoever if you go to their pricing page it doesn't even talk about this sword i'm not saying cf is bad but their sales tactics are shady and there's a lot of in uh integrations done with our back ends to migrate from gcp to cf this really has left a sour taste in my mouth the thing is is that this first one it seems like their pricing is a bit nebulous but this one it's like it sounds like the same thing you they got you on their business plan and then at some point they just extort you with a enterprise plan that's like 10 to 20x more expensive uh now i remember the viral video of the saleswoman getting fired with no reason well they did provide her a reason saying she did not meet up to the sales requirement they said you haven't made a sale in three months all that kind of stuff and you know when you say that it makes me think like okay so if they put a lot of pressure on the sales team and they really are aggressive with how they hire and fire from their sales team um maybe this is why you see such a uh intense thing here right maybe this is why you see such intensity coming from the sales team with such aggressive tactics like it is pretty gross hog slaughter scam but legal yeah it it seems the thing that seems gross to me is that let's just pretend cloud flair aside they do this and that that's pretty shitty of them what's crazier still is is these emails like hey you're affecting us sales team hey man really big things going on right here and we really need to talk to you about this it's it's pretty bad and then sales team like that that seems like just shitty right that's scummy that's like what you would expect from uh that's what you would expect to hear on a kit bogga stream right oh ma'am your websites are currently being uh experiencing high traffic we're going to need to talk to you about that this this this this is kid boga right it like the sales team are heavily incentivized with little business regulations and are uh just acting very autonomous in a very bad way yeah i mean they very well could be um okay as far as i can tell the issue with this is the op runs a casino gambling site gambling is regulatory mess i have spent two long yes it is a very it is a regulatory mess uh and so it's very hard to comply with every jurisdiction and each one needs to prove its compliance to operate in that jurisdiction gaming companies spend a lot on compliance and tracking but since the internet is the internet it's pretty hard to enforce it perfectly some countries and isps take this into their own hands due to that ips hosting gambling and gambling sites often get regul uh regionally blocked by the internet providers or otherwise flagged as hosting illegal content those regional blocks consequently affect the reputation score of the ip and if you are a traffic aggregator like cloud flare uh can cause other customers to have issues one of the most aggressive and annoying regulatory environments for gambling companies is the us so it's very possible cloud flare has some trouble due due to gambling use of their ips in the states okay cloud flair wanted them to uh use the bi uh the bio ip features uh of the enterprise plan and did not want them uh on cloud flare's ips the solution was to aggressively sell them enterprise plan and in a stunning failure of corporate communication not to tell the customer what the problem was at all the message from cloud flare should have been enterprise plan plus uh buop or ban and maybe it will work with you on price but instead it was you really uh you would really like the enterprise plan this seems land of the free baby uh let's see doesn't the op mention in this article that if that is the case then cf should have just said so yes they he does all right let's keep on going through this before we read this let's let's go back to this thing for a second because i want i want to see what the ending i want to see what the uh the the result of this is note that 80 terabytes is the number they tried to sell us i don't know if that's accurate since they removed all of our access to historical analytics that's also crazy uh during this time we also looked into alternatives and set up a test domain and call with fastly since they seem to be reasonable competition may 16th 202 for in another call trying to negotiate a re uh reasonable contract our ce told c for sales uh we were also talking with our competitor and would uh i would have thought this is obvious who wouldn't look for alternatives when getting slapped with 120,000 invoice but a few hours after the call this happened cloud flare had suddenly deleted all of our domains all of our dns records caching set uh set up rate limits whitel list gone our public website our incoming emails including support emails from our customers and our internal infrastructure our authentic if ation configuration on cloudflare access down they also sent this email hello the cloud flare account associated with this email address has been suspended for possible terms of service violation cloud flair's team uh terms of service are available here this account suspension does not impact disable remove your current services this does block the addition of new domains to your cloud flare account while this matter is under review if you have any questions if you have any questions regarding this suspension please contact cloudflare's trusted safety team which h code name sales team aka sales uh dude please contact the sales team oh my goodness casino sites should probably buy their own racks yeah they should probably buy their own racks the email says this does not impact current services so we frantically wrote them a support ticket but got no responses we called in our si sis ops team and started migrating our main site to fley we had the basic after a few hours but even then a ns dns entry change apparently takes a pretty arbitrary time to propagate everywhere yes it does it can take anywhere from like zero it can be like instantaneous to like ah that's going to be a couple days we're still recovering from the aftermath uh at that point cloud flair responded to our ticket thank you for contacting cloud flair technical support we've escalated the request onto our trust and safety team aka sales uh team for review trust and safety will reach out to you uh soon and help you address the request please note that your request with technical support has been closed as our trust and safety team will need to follow up directly if you need any further or any other technical support assistance please follow the instructions in our support portal damn uh damn uh my tips for when cloud flare reaches out to you first of all congrats your business uh must have become pretty successful how exactly cloudflare decides to ask you to switch to enterprise maybe you had 10 terabytes of traffic per month their lava lamps went into a specific astral alignment a sales rep realized they didn't hit their quarterly quota yet and we all saw we all saw girl fired from uh cloud flare right so is digital ocean the answer uh my guess is that there's other service there he's talking about fastly in this one in the end who knows cloud flair has absolutely no information on when they will force you into their custom billing but when they start urgently needing you to talk you've pro let's see you are probably not going to get out until you have a juicy custom contract with them there's a reason why they have no public information anywhere on traffic limits or enterprise pricing their sales team will use anything like having multiple domains as fuel to force your whole account to enterprise no matter if it is fixable in a simple way i i like digital ocean and lenoe yeah yeah i've used i've used a lot of lenoe i haven't used uh i haven't a dax shields cloud flare though yeah that's because cloud flare is still really good i mean that's the thing is that cloud flare is an awesome development platform my guess is that uh a flyo might be great flyo seems pretty good they claim it was april fool's day just a month late uh let's set up a new hosting solution no thank you uh the price that they give you is the is going to be purely based on what they think you might pay not on any me uh measurable metric or feature set we've tried asking how the price is going to be affected if we have less traffic but they refuse to say anything except 80 terabytes included we have a large amount of callback traffic uh that uses ip whitelist and thus don't actually need to go through cdn we just never spent time optimizing it until uh since unlimited traffic was included yeah actually that's one of the reasons why dax told me to go on cloud flare for some of the like the real time stuff because there's unlimited traffic now i'm just like huh huh maybe i shouldn't do that lunchtime hey see you jeremy um maybe i uh shouldn't uh do that anyways we tried to ask how the price is let's see hold on we've tried to let's see we've tried saying that we don't need any number of the 14 features that are included they said all those amazing features are included whether we want them or not okay that seems crazy numbers found on hacker news threads links above suggest that the prices vary by at least one order of magnitude for the same services yep we tried uh saying let's see we tried saying our different domains like internal ones don't need enterprise they said the whole account is enterprise if uh they think you are flaky maybe you have alternatives they will give you an unreasonable deadline and force you into paying the year upfront they will use any excuse for for a reason for why you suddenly need enterprise even if you're happy with the features set of business uh we are not the only ones that got their business threatened by a cloud flare's aggressive sales tactics dang just because you're paying $250 a month don't expect any kind of courtesy or non-sales uh responses to support males if you want cf to respond to you outside of sales the only way is apparently to give them negative press be ready to move away from cloud flare in 24 hours never register a domain directly on cloud flare if you do that they will block you i have no idea how you can get your domain back in a reasonable time frame luckily we only have our ns pointed to cloud cloud flare and thus we move away with 3 to 24 uh 3 to 24 hours of downtime for most users don't use any custom caching rules on cloud flare cloud flare by default ignores most all standard htp cach headers except for arbitrary set of extensions and encourages you to create custom rules on cloudflare instead set cf2 cash always this does not actually mean always i love programming programming is my favorite i just want more programming uh don't use cloud flare and respect origin headers they uh that way the rules always work for other cashing proxies nice don't use any proprietary cloud flare products like zero access or workers we heavily used zero access for authentication in internal products and now we have rebuilt all of our infrastructure from scratch with massive downtimes only use their technology where it is compatible with third party standards interesting yeah i mean if you're worried about this if you're growing i mean that could be a real problem here uh make backups of your configuration on cloudflare it's unexpectedly large pain to recreate all those configurations including various uh sending email services spf dkim uh site verification dns entries ip list rate limit rules etc dang it's crazy that they deleted their configuration i think the crazier part is just the the straightup deleting of the configuration right make sure you understand the impact of cloud flare's business model on you either you're leeching off cloud flare customers on the free business plan or cloud flare is leeching off you intransparent enterprise pricing there is no in between and at some point the time comes to switch and consider whether you need cloud flare at all cloud flare only manages for us pretty large dos attacks if you have some bit more vulnerable attack services for example an uncashed unauthenticated api request that eats up 100 ms of cpu time we can thus use uh up your cores with just 10 to 100 requests per second yep yeah so that's called a repulsive grizzly attack where you could you effectively can shut down a a server with virtually no effort uh cloud flare is not even going to detect it especially since all semi-professional dos attacks as a service groups seem to specifically uh specialized for cloud flare backend services including underattack mode workarounds ooh what's this one ooh okay this is a classic case of someone demonstrating themselves as being the victim in an effort to get others to sympathize with them all the while creating artificial ill will towards a vendor imagine the horror of a company trying to run sustainable business model uh where they return profit i read this and i see someone that's portraying their role in the situation as we've done nothing wrong and we want and they want to make us pay 120k uh to continue doing business this requires peeling back the layers of the onion to see where the fault truly lies since you're openly sharing domain emails of who you spoke with at the vendors or vendor surely you could share the domains you are using for your business if a if it's a casino it should be something we could go and look look at and become a customer of right i mean who doesn't love a little online gambling in the middle of the night right why not come clean with details of what they observed uh you doing to h level the playing field this following statement is utter bs in my opinion discredits anything you've shared when we told them we also were in talks with fast uh fastly they suddenly purged all of our domains causing huge downtime in our core business sleepless nights and migrating away from cf irreparable loss in customer trusts in weeks of ongoing downtime clearly talking to fastly has nothing to do with your domains being purged your domains were purged because you were vi uh in violation of terms of service not because you were talking to the competitor your come okay this guy's a redditor this guy holy cow this guy is a redditor let's see what the replies are like you could not make let's see you could not make you uh your being an absolute seething cloud flare employee more obvious let's go cnie you can believe what you want to believe you strike me as someone who is incapable of proper sence structure and is butt hurt that you either either you or one of your colleagues was called out on this bs you wouldn't have responded with the same level of hostility if that weren't the case dang you are a cloud flare employee don't you that's funny everyone found a cloud flare shield i'm not going to call you a shield but i am going to point out how [ __ ] how this is [ __ ] file 100% rator you know i wonder sometimes if there's people that are just like d i do like that like this like one thing you can really tell that this person got really intense is that i think they must have edited in some sort of third party because they like they put all these extra spaces and everything in here this seems like a copy and paste job they went all in on this one zoro the anti victimizer hello fellow internet users i know is this what technical writers do at work i think so they wrote an essay yeah written by chad jippy this feels like you could just you could chat jippy your way all the time here yeah literal uh divas advocate yeah but her gbd here's her name checks out this is this is actually pretty crazy now whether or not this is i mean the the hard part again is we don't know the cloud flare side of things but what we can tell is that cloud flare has been very very very aggressive with their layoffs especially when it comes to sales team so the hard part is this fits my this is the unsurprising cloud flare behavior mental model cloud flair has just been so uh so under so much pressure that it's not surprising at all that this type of behavior would exist um being able to like it's it's these emails that i think are just if if this is true again we're extending some faith to the person uh writing this this is just like the world's most shitty email and like anyone who did this should be so ashamed of the product they built right they should be ray should be fired ray should be fired effing ray uh also the pricing is opa then it is shitty yes i do agree with that as well if you can't give some like i understand there like there is a level of enterprise that is unop pricing in the sense that you know o enterprise can be something the difference between 10 million requests a day to uh billion requests a day right you have no idea what you're going to be falling into and so i understand why you can't give an enterprise business pricing like i get that but there should be some sort of like hey at our most expensive in the business or in the ent r this is what it's going to cost it's going to cost you this much most and it will go down with usage it's going to cost this much and it's going to go down with usage right you would assume some sort of at least some sort of basic constructs what do you recommend as dard i always thought cloud flare was the was was the was the way aws is pretty good at giving price on things we don't really know if the whole blog is just lying or maybe they're really just doing anti-t stuff they could be doing anti-s stuff that's true there's a bunch of you know again there's a bunch of questions but but there's also i mean i' i've heard basic rumors of this so i i didn't know if it if it's true or not or anything so this could be confirmation bias right i could be projecting onto this but you know either way it's a good the the takeaways are really good which is the more you integrate with any specific platform the more you potentially run into the situation in which if they were to do something against you you are in you're you're in a world of hurt so i don't think i think this advice is pretty good which is when you're using caching try to be try to like make caching works with anything else hey the more you put like the more you put into say cloud flare workers the more dependent you are specifically on cloud flare which makes it really hard like google you can lose email youtube and a bunch of stuff yeah uh too many eggs in one bag yeah the hard part is it's like can you avoid vendor lockin i don't think it's very easy there's always some level of vendor lock in and i'm not this person that actively fights against that but there's like easier ways to avoid getting too stuck in the weeds like using every last service and every last possible way to entrench yourself maybe not the ba the best way well yeah and let's just say they were doing some to stuff and let's just say that their behavior was not good um and that cloud flare did not want their ips associated with them let's just say all that's true absolutely i'm going to then also extend this email as being a part of it as well which then going directly to the sales team seems pretty pretty shitty right so even if they were all those bad things both those emails should not have done that the name good it's just good luck that's all there is to it good luck on that one that's wild