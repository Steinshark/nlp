all right first off i mock your mocks this is by lane if you don't know lane boot.dev great stuff learn back end development by writing real code so it's like a site to learn stuff with you know what i'm talking about this is technically a sponsored read i want to say that right now okay but i get the opportunity to say what i want about it and i get to pick the topic and this is a great topic this is perfectly what i want to talk about because i have many many strong strong feelings about mocks yeah sponsored hashtag i gotta say it up front because i want to be an honest individual okay okay several years ago i started my first job as a senior go developer a lot of scare quotes going on here you see after a modest three years in the industry my arcane ability to use go standard library string contains function managed to leave a powerful impression on the hiring team yes okay so first off he may not realize what he's saying but there is something that's really good here which is know your language you dummies you walk into an interview you could just magic them with some really simple stuff that's just available because that's what's available in your language just know the things yep as a senior developer only a few years out of college with no kids and a six-figure salary life was looking pretty easy well it wouldn't have been easy it would have been easy if the mind-numbing gelatinous corporation goo known as java it runs on billions of devices by the way it hadn't shipped away at the once great minds of my new colleagues java by the way oh no oh no corbett needs you to find the difference okay that's actually that's actually a really good meme this is a really good meme hard drugs free basic uh actually that's just straight banging heroin uh we're talking about my struggles with unit tests at this new company and mox and heroin injection um i mean dependency injection to be honest they're both just as bad for you i am on the same team in general i am a huge huge advocate for never mocking i'm on team never mock okay okay never mocker right here okay uh before we do that let me tell you a quick story to give you some context on this new job fix and go i'm not 30 minutes into my new job still homebrew installing a bunch of nonsense when a co-worker let's call him bill uh you know it's no tom i'll tell you that much there's no tom right now spins around says hey you're the new go guy right yeah uh goes the worst luckily for you i fixed goes biggest problem if someone actually says this like hey i fixed typescript's biggest problem i know immediately that whatever they fixed is probably worse than the thing itself i hate to say it but you're not making things better okay you're not you're not doing a good job bill's the genius in this story i smell a tom i smell a tom i've re-added try catch the language no more if error equals nil welcome to costco they say if your hand is bigger than your head you're likely to get cancer later in life by the way that was a joke from the 90s to get kids to put their hands on their faces and then you hit their hand and so that they hit their own face okay that's pretty much what you're doing right here this is the exact same joke except for it's in code and you don't get to hit your face once you get to do it every single time you program this is did that all the time everyone did it it was a great joke it worked every every time uh take a look at the elegance of bill's new feature funked try catch funked panic airs new i'm scared funk error error print caught wondering how bill achieved this level of syntactic sugar super easy barely an inconvenience it just bastardized the panic recover and defer keywords oh gosh the defer oh no oh no uh try catch funk funk catch funk error error this oh my goodness that's even a named i hate naked returns this is the devil by the way this is actually this is the biggest crime against humanity this is goe's worst feature naked returns are disgusting tj was right about it absolutely tj was right about it because you can't you have no clue what the f is going on negative turns are the devil our titan or not they're tight with the devil okay uh running some tests after uh after a riveting discussion with bill about the virtues of errors as values this is i mean i'm on camp airs as values any day of the week i was able to dive into my first zero ticket this is uh this is correct this is 100 correct i need to implement a new feature on an existing and back-end go service i ran a few commands to get going get clone go build go test failed database connection connection refuse awesome darn these tests failed that's odd someone must have committed some broken code wait why are my unit tests trying to connect to a database server hey bill do i need to set up a local postgre server to run the test yeah i didn't have time to write mocks for the database layer so we just use the real database i will i just want to take a really quick second to say one of the glories of sqlite is that you can point to a file even if the file doesn't exist and it can create a database right in that file and so therefore for this type of test if you truly just didn't want to mock anything you could have a file that just has the database in a specific condition and then just cp the file put it in a specific location and then run your test on it so that is one nice part but you know what if you're connecting to a database on a unit test you don't jump the shark okay i just i just want to let you know that right now your job is in a sun setting position you got to get the hell out of there uh the time has come to introduce you to my philosophy on unit test well at least in as much as unit test related to databases we are a back wait we are back-end developers 50 of the code we write takes data from http requests fiddles with it a bit and then saves it to a database the other 50 of our uh codes takes data from the database does some fiddling and sends it back to the client in the http response you know give or take a few percenties genuinely fairly well done uh here's my hot take the fiddling bit is the only part worth unit testing how many times have i said this you always have the fiddling part as its own function that takes in the thing you wish to you wish to diddle you do the diddling and you return the diddled like there's no other dude stop stop having functions that both get data and did all the data okay it's not worth it and yes i'm saying did will not fiddle because it's funnier okay uh it is shocking how often people don't do that okay it is shocking that that's not a real thing my time in seminary uh it was about diddling what i i don't even know why i read that uh here's where i really disagree with bill i actually prefer his tests that run while connected to a real database though i prefer let's see though though i'd more prefer integration tests that runs separately from the unit test at least with the real database i'm testing code that actually runs in production mocks are perhaps the worst thing uh one of the worst things to happen to back-end development it's actually just the worst thing to happen to all development not just back-end development because here's the problem it gives you all the power to do integration tests in unit tests so you end up testing just the stupidest stuff in the universe and don't say and don't forget we allow javascript to run on the server side yeah i like lane i like lane i hate mocks because they don't test code that actually runs in production which means they don't test anything give a delightfully false sense of security management loves this these are all facts these are all facts these are all facts i don't like the song that's playing it's way too intense we got we gotta change the song immediately i am not in love i am not in love right now all green no red always green all right take the following function uh db squeal user if email address equals null okay so i can already tell why you've heft up okay see this line right here this line should be in a this should this should all be in different function right there this is the only thing that should be in this function right this is it this is the only thing that should be in this function the rest by the way look it in look at this guy just raw dog and a squeal look at that can you believe there's raw dog squeal right now like i mean how would anyone ever raw dog squeal it's impossible right he needs an orm immediately all right so save user okay there's no way to test this function without a database connection available at the time of testing i can practically hear bill brew installing postgres as i type my humble argument is that the database logic this part right um should uh be tested in an integration test or gasps manually i'm fine with that however this validation logic can easily be tested in a unit you know yep this part yep absolutely me and lane are like notice we're on the same page uh we by the way lane and i had like an hour-long talk and part of our hour-long talk involved us just hating mocks just for like an excessive period of time so i'm not shocked at all that this this somehow came out as as an article it's critical to remember one of the key tenets of software engineering your code is ass it's facts and because your code is asked you shouldn't be scared to make changes sure this function will require database connection to be tested uh but what if you break it down what should we call then units yeah the classic your code is ass problem classic really ah now we have to write a neat little test test user yep awesome we've we've tested all the validation logic uh we would have tested in the original function with a mock and now we don't need to you know write a stupid mock absolutely mocks cause blocks blocks cause talks talks about mocks with devs or cox what bugs with shrugs come bugs with lugs come lugs with bugs with mighty shrugs come look here look here mr dev dear let's stop the mocks that cause the blocks here we can test and we can nest here but we don't need to mock the rest here probably chat chipity but the dr seuss is beautiful okay mocking is akin to reading dr seuss your mouth does a bunch of movements that your brain can't quite understand at all this was most excellent i love this i am on i'm full on this team by the way this is a full on team to stop mocking right better back end code separate out your logic can we all give little claps for uh for lane this was a great article uh again this was sponsored but still i actually really like the article check out boot.dev boot.dev helping your back end journey okay and lane's actually he's he's an awesome engineer i would not promote this if i thought lane was a dummy he's not a dummy he's significantly better than me at back end engineering listen to him plus notice he made the joke javascript on the back ends the joke and that's hilarious okay we could all appreciate that because the name is javascript on the back end is a joke again