nothing is worse than waking up and your coffee isn't done this happened to me last week and i realized i had to make a change now you could go out and spend 100 on a coffee machine with a clock and a timer but i already had a coffee machine and i already had an esp32 so in this video i'm gonna hack my coffee machine now putting the machine on a timer would be too easy i want this coffee machine to be controlled wirelessly using a web server that i'll write in this video from my phone i can say turn me on to turn me off the first step is to take the machine apart and figure out how do the controls work how does the machine get turned on and off this little switch is probably the culprit what i'll have to end up doing is use the esp32 to act as the switch so instead of the switch doing the work the esp32 will digitally control the machine here you can see there are three lines one for neutral and the other two are hot the switch connects the two black cables and that third line is just to ground the led so effectively we can throw out the neutral cable and not worry about it a problem is that those lines are 120 volts and my esp is 5 volts so what do we do the answer is we go on amazon and we acquire some relays relays are a device that can be used to control one voltage with another in this diagram we have two circuits one our low voltage esp32 5 volt circuit on the right our coffee machine circuit by energizing a coil in the middle using the 5 volt circuit we can actually close the loop on the relay and power the coffee machine only using a 5 volt control signal this prevents the esp32 from catching 120 volts and blowing up while keeping our coffee machine controlled these little guys only cost three bucks which is pretty cool considering how much work they do in this project on the left is my high voltage side and on the right is my low voltage side now let's hook up the coffee machine doing a little cable surgery i'm able to clip off the ends of these cables and set them up so i can hook them right into the relay like i said before that white cable that i'm not touching is the neutral cable because it only powers the led i don't actually need to do anything with it after a couple seconds of wire stripping here i'm able to fit these wires right into my relay which gives me the high voltage control that i want from the esp32 now begins the fun part writing some code if you're new to the channel or haven't seen my previous videos i've done tutorials in the past on how to set up your esp32 to connect wirelessly to your wi-fi network and also host a tcp server we're going to use that same concept in this video and use the tcp server to act as a web server that i can connect to with my phone here i'm basically writing some code that my phone can connect to the server and it opens a tcp socket and it reads in some data inside that data which will contain an http request it looks for the string turn me on or turn me off if it finds turn me on it will enable the switch to the relay and if it finds turn me off it will disable the switch to the relay ultimately controlling the copy machine acting as an http server here i make up some fake http messages that will get sent back to my phone to know that it properly received the message and also display a message saying the machine is on or off [music] once the server has found the turn me on or turn me off message in the coffee machine request we're going to just enable the gpio pin or disable the gpio pin that will enable or disable the relay by doing this the relay will close that switch using the energized coil and actually turn on the coffee machine completely remotely also for a positive user experience this is the point in the code where we'll send that message to reply to the http request so the phone gets that image and here instead of an on message or an off message with some text we actually add a remotely sourced image from wikipedia that's a giant check mark or an x mark for our first test we navigate to the esp32 and that led turns on and if we type turn me off on the web browser that led should turn off as well and there we go great success for our second test we're going to use that web server to see if we can control the relay dc plus will be our 5 volt source dc negative will be ground and that in signal will be pin 23 where the gpio happens here we prep the board to be tested and after struggling with my usb cable a few times we eventually get to the test by navigating to the website and saying turn me on we're able to actually power on the relay and you can hear that click is the sound of that coil energizing and flipping that switch on although the coffee machine at this point is unplugged great success moving on to the final test does our machine work all right hey guys that's all for now thanks for watching as usual i want to thank my patreon supporters for helping me out and making this channel a reality thank you all so much we'll see you guys in the next video i hope you learned something keep on learning take care you