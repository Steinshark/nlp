just one packet can bring down a vulnerable dns server thanks to dns sec you don't have to do more than disconnect uh an entire network a single packet can exhaust the processing capacity of vulnerable dns server effectively disabling the machine by exploding a 20 plus year-old the design flaw in dns sec specification damn just one packet can destroy the machine what, 1500 bytes what's what's the mtu all right that would be uh that would make it to take down uh a dns sec validating dns resolver that has yet to be patched up uh upsetting all the clients relying on that service and making it seem as though the website and apps were offline okay okay okay the academics who found this flaw associated with the german national research center for applied security cyber security athen classic in dars darad claimed dns server software marks brief or markers briefed about the vulnerability described as the worst attack on dns uh ever discovered reading is hard dude reading sometimes is hard identified by professor haa shomen and uh nicholas vogal of the goi university frankfurt alias heft trig of fron hofer sit and professor michael o wer at the technical university of darad and fr haer uh sit the security hole has been named the key trap designated csv 202 23 503875 out of 10 is is the severity rating is this like a logarithmic scale is this kind of like earthquakes i assume i assume it's like the ror scale like an 8.5 is just huge 7.5 is pretty freaking bad okay yeah i don't i is there like a categories is there someone that has like a nice little like graphic infographic to understand why a 7.5 out of 10 is bad cuz when i hear 7.5 out of 10 i think oh it's it's not that bad but you guys are saying 7.5 is pretty dang bad 2 in is all she needs i don't know pck the lies we tell ourselves sometimes as of december 2023 approximately 31% of web uh clients worldwide use dns sec validating dns resolvers and like other applications rely on those systems all right so so low is there mediums here high falls into this this area and so criticals n9 to 10 high as uh 7 to 8 8.9 so high so it's it's pretty dang it's pretty dang bad is the way to look at it pretty d high called it dude just so high okay uh with those dns servers taken out to buy the flaw clients relying on them would be unable to resolve domain and host names to ip addresses to use resulting in a loss of connectivity i cannot believe that is possible by a single packet i really i mean i don't it doesn't look like they're going to go into the exact details but i want to know how the researcher said lan dns packets exploited uh exploiting key trap could stall public dns validated dns services such as those provided by google and cloudflare by making them do calculations over uh that overt tax server cpu cores the disruption of dns could not only deny people's access to the content but could also interfere with other systems including spam defenses cryptography defenses uh pki and interdomain routing security rpki the researchers assert let's see explorations exploitations of this attack would have severe consequences for any application using the internet including unavailability of technologies such as web browsing email and instant messaging they claimed with key trap an attacker could completely disable a large part of the worldwide web that's that's impressive a non-public technical paper of the vulnerability provided to the register titled the key trap denial of a service algorithmic complexity attacks on dns described how an assault would be carried out it basically involves a vulnerability in dns sec validating dns resolver to look up an address that would cause the server to contact a malicious name server that sends a reply that causes the resolver to consume most or all of its own cpu resources oh oh wow okay that's a that's an interesting that's an interesting move to initiate uh the attacks our adversary causes the victim resolver to look up a record in its malicious domain the d2b published paper states the attacker's name server response to the dns queries with the malicious record set rr set according to the specific attack vector in zone configuration the attack work the paper explained because the dns spec sex spec follows postel's law the name servers should send all the available cryptog cryptographic material and the resolvers should use any of the cryptographic material they receive until the validation is successful oh does it just like keep sending cryptographic data is that what they're saying this requirement to ensure availability means dns sec validating dns resolvers can be forced to do a lot of work if presented with colliding key tags and colliding keys that must be validated so so it's just like it's like a this is like a peer this is like a what's it called a something grizzly a repulsive grizzly attack a simple a very simple request can effectively cause a complete cpu lockdown that prevents any anything else from being served yeah doses itself all it's just like those redx expansion attacks our complexity attacks are triggered by feeding the dns resolver with specifically crafted dns sec records which are constructed in a way that exploits validation vulnerabilities in cryptographic validation logic dang crypt bros just in shambles right now dude is this why is this why the b8 yop club monkeys are going down in values anyways i thought it was funny uh when the dns resolvers attempt to validate the dns sec records they receive from our d serers as they get stalled our attacks are extremely stealthy being able to stall resolvers between 170 seconds to 16 hours depending on the resolver software with a single dns response packet geez how do they do that i mean it's just such a small amount of bites right like a single packet is not a lot of data the athen bofin said bofin d uh said they worked with all relevant vendors and major public dns providers to privately disclose the vulnerability so a coordinated patch release would be possible the last pat was finished today nice we are all aware of this vulnerability and rolled out a fix to uh in coordination with the reporting researchers a google spokesperson told the register there is no evidence of exploitation and no action required by users at this time boffins yeah boffins eventually will sink i know dude this is wild that someone could discover this 20 years later too like that's the crazy part network research lab uh nlnet labs published a patch for its unbounded dns software addressing two vulnerabilities one of which is key trap the other uh the other bug fixed this one refers uh referred to as nsec3 vulnerability allows also allows denial of service through cpu exhaustion dang the key trap vulnerability works by using a combination of keys also colliding keys signatures and a number of rr sets on a malicious zone answers from that zone could be uh can force the dns sec validator down a very cpu intensive and time costly validation path power dns meanwhile has an update here to thwart key trap exploitation dang this is dude i can't believe people still find these things like imagine something this old right since uh since at least august 20 uh 2000 more than 23 years ago key trap has been present in the bind9 dns resolver like that's wild that the internet could have been destroyed for just 23 years it could have just like someone could have just destroyed it for a while it's wild that that could be that could just exist for that long and it surfaced seven years later in the unbounded dns resolver dr haa asman a professor of computer science in one of the academics behind key trap research told the register in a phone interview that the attack is simple and can be carried out by encoding it in a zone file uh it would have been resolved that long ago it would have been resolved that see that's why i uninstall bind it's why i never use bind in javascript for this exact reason the vulnerability is actually something uh that's recommended in the dns sex standard just rec let's see one packet suffices you don't have to do more than that to disconnect an entire network it's actually a feature we we made this one intentional uh prof scholman said that the patches that have been issued by various vendors break the standard the problems is attack is not easy to solve she said if we launched it against the patcher resolver or patch resolver we still get 100% cpu usage but it can still but it can still respond okay so you peg it but not for too long updated uh to add on february 16th you can now download the technical paper here oh interesting i want to look at that i want i do want i do want to look at this at some point i won't look at this on stream this is obviously entirely this is this is not stream material oh just like it just like it's just like a constant failure has to rehash things too many words dude to dude this is not a hcal stream this is not a hcal stream though this is like super interesting dang it now i got to go read this this is way too long but it seems really interesting this seems super interesting the white paper agen what a time to be alive i know all right hey the name is it's crazy that the internet hasn't died honestly it's crazy that the internet has not died and that we we just keep on going forward despite the fact like how how's this possible how's this even possible a jet