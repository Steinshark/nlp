how a refs a ref's harefs save 400 million in three years by not going to the cloud all right all right all right all right let's hear about this we just got done c and dhh go all in on not the clouds clouds for i.t infrastructure are so popular lately that moving into the cloud has become a trend infrastructure as a service iaas i'm not even sure how to say that is uh cloud provides multiple advantages flexibility low time for deployment easy scaling instant presence in many regions of the world and many others yeah these all sound like great things right this sounds great hi youtube hey can everyone say hi youtube hi youtube hi hey hey press the like button just press it now just press it just press the um anyways uh let's see cloud service providers have become knowledgeable outsources of it services providing convenient and often easy to use services except for aws's interface which was designed in the 90s by a series of back-end engineers with excellent marketing conferences certifications and cherry-picked use case scenarios it's easy for one to think that clouds are the only reasonable destination for the iit of a modern business this is true this is true this is true but the cost of these outsourced cloud benefits are sometimes high they're so high we uh we were concerned about whether our business could exist if our infrastructure was 100 in the cloud this inspired us to make an actual comparison based on facts and logic not your feelings and hear what they are uh a ref's own hardware overview okay so this is kind of exciting okay we're getting kind of excited here let's see what happens a refs has a rented co-location data center in singapore with a rather homogeneous infrastructure so we decided to consolidate all the costs spent for this data center divided them by the number of service servers and compare them to the cost of a similar installation in amazon web services cloud use this as the leading ais example okay look at those look at how pretty that looks oh it's so beautiful look at that look at that would you look at that would you look at that would you look at that it's all html can you believe this entire place just makes html it's shocking it's shocking how much html has made there all right our hardware is relatively new the co-location contract started in the middle of 2020 during the peak of covid-19 lockdowns all the installed equipment has been brought or bought since then our services servers in the data center have similar configurations the only difference is in the cpus of two generations with the same number of cores we use high core count cpus two terabyte ram and 2x 100 gigabits per server wow that's a lot that's a lot of jigawatts and even more terawatts of ram look at how many terawatts of ram that is on average our servers have about 16 x 5 terabyte drivers 16 by 15. i can't even do that kind of math i can't even do that kind of math it's too big that number probably doesn't even exist in real life uh for the monthly cost calculation we assume that all the hardware will be used for only five years okay not bad not bad okay we decided to consider anything beyond five years a freebie and based on this the monthly part of the initial equipment cost is the original price divided by this okay boom 60 months all the current costs such as rent and electricity are as of october 2022 although inflation effect affects us too trying to account for it makes these calculations much harder so we've ignored it for now okay but inflation i mean i would assume inflation affects everybody like if you're on aws your prices have they slowly risen over the last little bit i would assume they have to write rise a little bit because if electricity gets twice as expensive one has to assume that aws has to account for that somehow maybe i don't know i don't know i'm not i'm not an aws magic magician calculating their numbers well yeah i sound a little bit different today i have this plug's nose me and my wife both have had a plug nose for the last three days and we don't know why why why you know i don't know uh the co-location payments consist of two major parts rent and de facto consumed a metered electricity the electricity price has significantly increased since the beginning of 2022 but we uh calculated our monthly charges based on the latest higher electricity charges not on the average for the whole rental period okay that's good okay so i like this i like this approach you take the high point don't take the average because the average is always going to be pulled down by some previous non-inflated price which would be lower therefore we should give aws an advantage okay good also if we pay for ip transit and dark fibre between the data centers and our point of presence the following table shows our monthly spend per server server hardware takes up two-thirds of the overall monthly expenditure while the data center rent with electricity direct current uh internet i assume that's what it is isn't an ac what the hell is dc doing in there uh internet service providers isp with ip transit and dark fibre df down to fiber and internal network hardware or make up the remaining one-third okay there it is right here monthly cost fifteen hundred dollars hundred percent this is per server something like that uh aws cost infrastructure since our co-location interviews in singapore we use aws prices for their asia's pacific singapore region for comparison the cost structure for aws is different from the co-location unfortunately aws doesn't provide an ec2 instance with the number of cores we have oh this makes this makes it hard dc doesn't stand for data center it stands for diet coke everybody knows that so we have found an ec2 configuration with half the cores and one tb of ram not as much gigawatts of ram but still pretty good pretty good uh we then compare uh one of a ref server costs with the cost of two such ec2 instances hmm is that fair because usually when is it true that when you get to bigger machines you get some sort of discount as it scales upwards or does it go the other way because they're harder to get i always forget which way it goes because i just don't i mean i'm never looking at cost charts either way you know what i mean i have no idea disconnect cloud is that what dc stands for way off uh also we consider long-term ec2 usage thus we compared the lowest price of the three-year reserved ec2 instance for five years on on-premise services oh they went with the lowest price they went with the highest on theirs and lowest on ec2 apart from ec2 instances we added elastic block storage ebs it is not let's see it is not an accurate replacement for directly attached storage as we use big and fast uh drivers in the servers to make things simpler we cho we choose cheaper gp3 ebs much slower than ours though it costs consists of two-part storage size and charges for uh iops uh we keep two copies of data chunks on our servers but we only let's see but we only order usable space in ebs that takes care of the replication for us we should consider the price of the gp3 storage size equal to the size of our drivers divided by two okay that's a lot of math this is a lot of math i'm not sure if i can do this do you understand the divided by two because apparently they have two they have some sort of doubling of things and so they're just not doubling it here i'm dizzy i want to see netflix's aws bill so do i let's see we didn't add the cost of higher iops is that how you would say this you just call it iops i o ops iowops iowops uh we also discarded various limitations ebs gpt3 has for example gpt3 max throughput instance is 10 gigawatts per second and at the same time the performance of a single iacp e gen4 envoom driver is six to seven gigawatts per second okay and we have 16 of those working in parallel well that's i mean again this is math i just can't do off the top of my head 6 times 16 impossible uh so thus it's not an apples to apples comparison but this approach should significantly reduce the cost of storage in aws giving it a further advantage unlike the co-location aws charges per gigabyte downloaded not for bandwidth so we roughly estimate our average download per server is and use the figure in aws network calculation okay so so far what i'm really reading here is that they did what i think is a fairly good comparison you know what i mean it's they're really trying to give a fairly reasonable take on them both if they were to transfer transport their service and drop some of these items such as their sweet storage which is significantly faster which can have significantly more but then there's some weird ones which is how much is it downloaded versus how much is a used blah blah but it looks like this thing is literally about what 11 times more 12 times more that's a lot uh upon consolidation of the above tables we see that the imaginary aws spending is much much higher remember they also use the best ec2 cost and the worst energy cost on their behalf giving the ec2 the best advantage they also aren't considering their double storage and only doing single storage so they're doing they're doing a whole bunch of like make it work stuff a replacement ec2 instance with similar usable ssd space and aws would cost us roughly the same amount of money for all 11.3 servers in a co-located data center according to uh accordingly that means our 20 server rack will transform into just two servers do you want that or do you want that is what they're saying this or this this or this uh so let's say we run our 850 servers during an actual two and a half years of our data center usage once we compute the numbers we can see the dramatic difference 39 million 408 million likes she so to be fair i think if you had that many servers you might be able to negotiate a slightly better a slightly better rate so maybe we could multiply this by 0.85 would that be fair could we say that just just for fun even at that it's still like 9x more this is i don't know yeah that might be a little too uh might be a little too generous on my behalf what about reserved instances yeah that's still like 350 million yeah it's still just all a ton of money i don't think so okay let's just pretend we could and so even if even if you say hey you know what your calculations are so wrong that you have to multiply this in half right you've assumed too much therefore even if that were to happen it's still 5x more expensive 5x 5 1 2 3 4 5 right 5x like that's kind of crazy right so even if you're that far off it's still that much more uh we would need to pay aws a whopping 400 million uh more to keep our infrastructure running in singapore since 2020. one may think perhaps arabs can afford this it's true arrest is a profitable and sustainable company so let's take a look at our revenue and use it in our calculations let's go uh that being said we are a private company and aren't obliged to publish our financial data but one can find some information about a ref's a revenue in the straits time article on singapore's fastest growing companies in 2022 and 2023. these articles provide arrest revenue figures uh for the years 2020 and 2021. we can linearly extrapolate revenues from 20 for 2022 which is actually usually linear extrapolation is pretty like it tends to over project given enough time uh it's a rough estimate but it is enough for us to draw some conclusions all right boom boom extrapolation okay okay we're gonna make some more money yeah yeah making money making money hell yeah uh from the table we can see that a ref's total revenue for the last three years would be 257 million but we also calculated that aws cost would be 448 million for such a data center replacement thus the company revenue wouldn't even be close to covering our two and two two and a half year aws usage imagine if all of your money you ever made went to just having aws imagine imagine such things as that imagine having zero dollars what results about where would all of our profits go as per this 20-year-old report by dr l j hart smith for boeing if the prime manufacturer or system integrator cannot make his fortune by giving all his work away who does benefit who does benefit the subcontractors of course hahaha this man saw to the future the man was seen in the future this is crazy this is actually crazy uh it is good to remember that we already provided several advantages to aws by using their higher than average electricity cost for our co-located data centers calculating only storage parts of ebs and ignoring how slow the ebs storage is also this data center is not only the only cost for uh cost center for us we spend money on other data centers service services people offices marketing etc activities etc okay so that's good that is good to actually call out like there are other costs involved in whatever you do therefore a-refs would hardly survive if the cloud was our primary infrastructure destination other considerations this article doesn't take into account other aspects that would make the comparison even more complicated these include people skills financial controls cash flow capacity planning depending on the load type etc conclusion a ref has saved approximately 400 million by ensuring its infrastructure is not 100 in the in the is can i call it an is that fine in the is uh cloud during the last two and a half years this figure is growing bigger and we're currently starting another massive co-located data center with new hardware uh while a ref uses aws benefits for hosting our front end in different parts of the world the vast majority of ares infrastructure icebergs hide in the co-located with owned hardware ares wouldn't be profitable or even exist if our products were 100 in aws if we could uh if we could use a cloud-only approach our infrastructure would uh cost would be 10 plus i think 10x would be the proper term here times higher or 10 plus times higher okay there we go but because we didn't do that or because we don't do that we can spend the money we save on actual product improvements and development got him consequently having fast and better results means that our servers are much faster than what uh a cloud can provide given its limitations our reports are also generated faster and are more comprehensive as the time needed per report is shorter this is actually a really interesting point which is you know again i hate on serverless but serverless is a more expensive version of this eventually right at first it's cheaper because you just don't have a lot of customers but there does come a point where your your usage dictates what kind of servers server services you can use and eventually it does get more expensive than uh than just having your own version on aws but how much i don't know it depends on you because you got to take into account like people people managing this people are expensive so like you have to have a certain cost factor that makes sense it is easier to move off the cloud uh that to cloud yeah 13k per month uh so how many network engineers and infrastructure engineers manage those servers also your own risk yes yes exactly so that's that's what i'm saying so it depends on your size i think this is this is the point which is there is a size point in which it does matter but at 13 000 a month it doesn't matter how i like to personally think about it is whenever i think about an employee because what you really have with an employee is you have management you have taxes as an employer that you have to pay to the government that you don't even pay to the employee these include include like social security that's six percent uh there's other things you're paying there's a lot of taxes you're paying there's all you know there's there's effectively warehousing housing cubicle equipment all that crap you have to pay for plus you have to then pay the employee itself then you got health care then you got 401k match you got all these benefits everything that goes into hiring an employee in a high level network engineer platform engineer whatever you want to call it that runs this i would just assume you're spending a million dollars a year per employee right so you have to hit a certain level you know what i mean and so whatever that level is i don't know what that is but you have to do you have to plan for that you know what i mean singapore is pretty expensive country to pay for those costs too yeah yeah yeah yeah yeah retail pricing of aws is only for starting a starbucks start a startup and hobbyist enterprises get around a 50 to 70 discount yeah i would assume they're also taking like i said that's why i said cut this number cut this number in half and you still you know it still is really expensive all right hold on let's get to the right let's see all right let's see uh let's see let's see on that note i recommend cfos ceos and business owners uh interested in sustainable growth to consider and periodically re-evaluate cloud benefits versus actual cost while clothes clouds are the natural go-to choice for early stage startups staying 100 the cloud was sustained uh substantial infrastructure may sink a company as it and its infrastructure grows it's very i mean it's a these are just really cool thought experiments to go through because i think we uh so there's you know i think donald rumfeld is the one that was popularized this this saying but i think it's older than anything he's done which is there are no knowns there are known unknowns and unknown unknowns but there's actually a fourth category he doesn't mention which is there are unknown knowns why do you think something is accepted right why do you think only ever hosting on aws or some cloud provider is the only way you should ever build your company that's an unknown known you have just you have accepted that swallowed it and regurgitated it as the only possible outcome is it the only possible outcome i don't know it sounds like there's multiple companies right imagine hosting donald rumsfeld well i i'm not imagining that i'm just quoting him uh so it's kind of interesting right it's kind of interesting to think about uh that you you have these built-in ideas that you may not realize why you have a built-in idea right it's also because dhh said so well i mean he said so obviously he has the most matured opinion out of all of us uh but i'm totally on board with using aws serverless whatever the hell you want to use when you're starting up or until like until it becomes a cost factor like netflix i think part of uh i think there there's this interesting curve that probably does exist which is once you get so big and you make so much money it might make more sense to go back to the cloud whether that's true or not i don't know i actually don't know because how do you reasonably like again very complicated very very complicated i'm not sure if there's a solid answer tom doesn't have any unknown anything he's a genius that's true uh for a let's see for a more mature company migrating from the cloud to its own infrastructure is difficult is this dhh uh let's see it will also be challenging to keep the company alive during the migration but such a painful move may be what saves the company and it can avoid paying an increased cut of its revenue to the cloud services yeah big companies fang in particular vacuumed the job market for many years they have been hiring engineers to run their enormous data centers and infrastructure leaving only a few smaller companies but with the mass layoffs in big tech in the recent months this may be an opportunity to reevaluate the approach to the cloud consider a reverse migration from the cloud and hire season professionals for the data center world yeah i mean netflix in some sense does this we have our oca network right uh so our oca network delivers all the content across the world we have like we have the most effective content delivery network in the world and so we do we we deliver a 33 of the internet from it which is crazy to think about uh oca stands for open connect architecture so if you just look up open connect uh architecture uh here open connect uh open connect um netflix there we go you can learn all about open connect it's just it's super cool it does everything it has like this is an exceptionally sophisticated content delivery network exceptionally sophisticated right it's crazy what that what it does uh what about uh youtube i you i don't think youtube transfers nearly as much data as netflix i'm pretty sure netflix is the largest of all services i i if i'm not mistaken netflix transfers more data than porn which is crazy to think about because y'all are a bunch of degenerates who love porn well really you're just addicted you think you love it but you're just addicted smoking cigarettes okay calm down there's no way it is crazy it is crazy no way yes way press x for doubt uh percent of internet traffic does it have uh does it have uh let's see most popular social platforms nice nice uh netflix yeah this is a unique and unique viewing uh youtube should it should definitely win unique viewing oh man where's the thing they used to have like this really nice little pie graph that just showed what it is uh it's 15 oh wow we've fallen down in the last a little bit the real question is how is netflix uh i i hope we never do uh what about the amount of servers needed to stream your videos well that's what we have we have a whole connect we have a whole network for that yeah uh you don't watch porn for two hours at a stretch uh as you would a movie you don't watch yet you don't want eight hours of something debunked uh your v take i'm not sure what a v take is uh still i think we might still destroy it anyways how many racks i would never know the answer to that the answer is crazy it's crazy how much is actually going on uh anyways hey pretty exciting i really like that article that was awesome how much what is you know that was a that was a great great article huh everyone happy with that i'm really happy about that are you happy i'm happy are you happy i'm i'm happy uh anyways the name is considered cloud storage gen