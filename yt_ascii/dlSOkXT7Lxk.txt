hello in this video i'm going to be describing my ultimate vfx workflow the way i work has been constantly refined over the last few years in terms of efficiency and preserving detail and loads of technical stuff that goes on in the background i did quite a similar video to this a couple of years ago that's done really well and continues to get really good views so i'm going to make an updated version of that essentially i think i finally settled on something that's really really good and i've come up with it as a result of working at a vfx studio for five years doing my youtube videos which is obviously what i do on this channel and also i've started doing a lot of freelance work where i'm working for companies as a bit of a hired gun for doing like one or fear effect shots or small adverters outside of work so the three primary pieces of software that i use are davinci resolve blender and nuke those three pieces of software work together really well and you can go between them very seamlessly using this workflow i'm going to jump to my screen now and i'll show you how everything works so this is the interface in davinci resolve the first thing i do when starting a brand new project before i do any actual work with footage or anything is create the folder structure i talked about this in the previous video as well so i'm not going to go to any in depth about it but essentially the way it works is i create a folder structure using a little batch operation in windows so i'm just going to create a new project folder for this i'm going to call this workflow demo and then inside of here i'm going to copy in the batch operation that i will make available on my patreon as well as some other files from this video it's the one called all folders and then if i open this up quickly we can see what it's doing what it's doing is creating a load of folders some of them are subfolders so inside of the other ones the top four folders are just for the editing purposes so i've got one for the actual raw footage i've got one for exports from resolve there's one for the actual resolve project file and there's one for the thumbnail because most the time i'm doing this for youtube videos and then after that we have all of the folders for the actual shots so i delete the ones i don't need save it and then close the notepad and then you can double click this batch file to run it and as you can see there what it's done is it's made all of those folders automatically so once that's set up what we can do now is start to actually export the footage into this folder so i'm going to go back into resolve and i'm going to bring in a piece of footage this is a piece of footage that i shot a couple of days ago for a little test that i was doing with a photo scan it was shot on my sony a7 iii and it's currently an s-log 2. the plan with this was to do a 3d track and put a photo scan of me riding my one wheel it's me there in the actual footage and then when i leave frame we do a texas switch and the photo scan of me comes in on the one wheel and carries on which i'll show in a bit so the first thing to know about this workflow is that it's using aces if you don't know what aces is i have a video about it i will put a card to around here somewhere essentially aces is a color management system which allows you to take footage from any camera and make it look all the same there's a lot more to it than that it also has a lot more range in all of the colors and everything but it's very technical so i'm not going to go too much into that in this video all you really need to know for this bit is that we can use the asus transforms built into davinci resolve to convert this from a log color space which it currently is into a rec 709 color space which is much better for working on so first of all i'm going to bring this into the timeline down here i'm going to delete the audio and then again like i said as you can see it's very flat at the moment davinci doesn't start in aces by default so we go into the project settings and come to the color management tab what you can do up here is change color science from davinci y rgb which is the default to aces cc there's a few different versions of aces i currently use aces 1.2 davinci does actually have 1.3 but it's not currently available for blender or nuke so we're going to stick to 1.2 the other thing i change is setting the output transform to srgb the reason for this is that my monitor is an srgb monitor you can also set the input transform to be the color space of your footage i don't do that i just do it manually in the tab over here so i'm going to leave the input transform unchanged now i'm going to press save and you shouldn't see anything really changing apart from the footage will get a bit flatter now what i'm going to do is tell davinci resolve what color space this footage actually is so if i right click on this and come down to aces input transform i can come down to sony which is the brand of my camera and then sony s-log 2 which is the color profile that i shot this in and if i select this you'll see that it's completely changed the look of the footage it's now gone from log to being nice and high contrast which is much better for working on so let's pretend that these are two visual effects shots next to each other in an edit it's going to cut a bit of this off because this is an absolutely enormous clip and i'm going to cut this one down a little bit as well the next thing to do is export these clips to using blender and nuke now resolve is pretty clever in that you can set up ways to automatically export these to the folders instead of having to do them one by one so for this first one i'm going to right click on it go to clip attributes and then under the name tab i'm going to rename this to shot one and for this one i'm going to rename it shot two what a surprise you can also tell resolve to bacon the name of the track which i'm going to do in case you have multiple tracks that you want to export at the same time for now i'm going to set this to l1 which kind of stands for layer one we'll use this at the mill as the naming structure and i've kind of stolen that and do it at home as well then what you want to do is go to the deliver page and what i've done is saved a preset for this already so that i don't have to set it up every time so if i click on this vfx exr what it's doing is creating an exr sequence so i set this to a 16-bit exr and the codec to rgb half zip compression this footage was actually shot at 4k but i'm exporting it at 1080p so just so it makes it a bit easier to work on in nukem blender and then if you set this to individual clips it means that it will export every single clip that's selected in the timeline so it's going to recognize there's a cut point here and separate the two out then under the file tab most of these settings i don't change but i do make sure i turn on each clip starts at and i set it to 1001. this is quite common in visual effects instead of starting at frame one then the next thing to do up here is the tagging this is where you set it up so that resolve bakes the names of the clips into the actual render i'm going to do this from scratch so that you can see what i'm doing first of all i'm going to rename the timeline so that i can bake that into the footage as well so for example if it's vfx workflow i might just call this vfx or something like that then back to the deliver tab if you add a percent into this it will allow you to access all the tags that resolve can use so the first one i'm going to use is timeline name so that will now look at what the timeline is called which in this case is vfx then i'm going to do underscore and then i want it to use the clip name so for example this will determine if it's shot one or shot two so again percent clip name then underscore again then we can tell it to use the name of the video track so percent track name and then finally i'm just going to do underscore version one in case i'm going to do multiple versions of this then if we go to the actual save location we can go to browse i'm going to save this in shot one for now this is the first clip nuke live action and this is where the footage will live then in the path what you can do is replace this shot folder with another tag so percent and i'm going to use the clip name again so that instead of going into the shot one folder every time it looks at what the clip name is so when it starts exporting shot 2 it will know to put that into the shot 2 folder that's it for all of the settings for the export the last thing you have to do is change the output transform before we start rendering resolve doesn't have a way to differentiate between the display transform which we set to srgb and the actual output transform for rendering so you have to change it before you render which is kind of annoying so go back into the project settings under color management we're going to change the aces output transform from srgb to aces cg which is for rendering our linear exr sequence 2. and once we set it to this everything we do in blender and nuke will also be using asus cg as the linear exr color space and finally it will come back into resolve and we can tell it that it's asus cg linear exr's again and this way the colors will look exactly the same in all of the software and it will be a perfect round trip so i'm going to set this to asus cg and save those settings i forgot to mention this while recording in almost all compositing softwares it's best to work in a linear color space all the maths behind the code is intended to be used on linear sources so you'll find things like blurs defocusing light compositing etc will all behave more naturally when working in linear and you can see that it's gone very crunchy here but that's because it's not viewing it as srgb anymore in the viewport so it doesn't look correct but when we render it it will be fine now all i have to do is press add to render queue and up here it's going to show the tagging where it's going to put all the files at the moment it's going to render the whole timeline but if you only wanted to render certain shots you can use the in and out points on the timeline to set the specific range but i want to do both of these so i'm going to press render all just to demonstrate how all of that works on an actual edit this is a freelance project that i worked on recently it's not actually out yet so i'm going to blur a lot of this so that you can't see any of the actual footage but as you can see here i have 16 vfx shots for the bottom line here as you can see the video track is named offline which is essentially a very rough vfx edit that the editor usually does within the editing software usually that'll be just using like really crap masks or doing a quick key or something just to demonstrate what they want you to do then above this i have l1 and l2 the l1 layer is just all the main footage straight out of the camera these are all the main plates for the shots and then the l2 layer is for some of the shots that had multiple plates so for example some of them had background plates with some shots that needed keying or roto so these would both be exported as exr's into the footage folder and then above that the top line is the finished comps which i bring in and they're labeled a different color and this is just so i can compare them on and off very quickly to the original footage in the context of the edit that's pretty much it for the davinci resolve stuff now so we're going to jump into nuke which is the next piece of software okay once in nuke we can read in the exr files that we just exported if i go into the workflow demo we can go into shot one nuke live action and you can see we have our footage here and just to show you that it works i'm not going to use the other shot but just so you can see it's there shot 2 has also automatically gone into the shot 2 folder without me having to manually set it up and again this looks correct as you can see the color space is defaulted to compositing linear in nuke which is what we want it to be so we know that this is our linear exr setup i'm now going to jump into the new script where i've actually started using this so i can demonstrate how it works so this is the shot that i was talking about earlier this is the photo scan of me that i was doing in blender which i'll talk about in a second so essentially this is the live action footage up here then there's the shadow pass the cg version of me and then eventually it gets exported so to start from the beginning basically what i do once i bring the footage into nuke is i export a jpeg sequence that goes out to blender if there's lots of lens distortion i will undistort the footage before it gets exported i also usually add a reformat node and scale it down to 0.4 scaling it down a bit just makes it playback better in blender i'm not going to render this again because i've already done it but just imagine that i've rendered that jpeg sequence and then i also like to do most of my 3d tracking in you because i find it a bit easier so what i've done over here is just a very quick camera track of the footage as well and then i set up some very basic geo and the camera and then i used a right geo node to export this from nuke to blender so that i can bring it in and do the cg once that's done we can jump into blender for the next part of the workflow this is the blender scene it's just got some animation of the photo scan as you can see this is the 3d camera and i've got the geo and stuff up here that i exported from nuke as well to bring in the camera and the geometry from nuke all you have to do is go to file import lembic i should mention that you should have exported this as an alembic by the way so in the right geo node you set it to a dot apc file then in blender navigate to where it's saved and then you can import that file and as you can see here it's exactly the same so i'm going to delete it otherwise i'll have two of them then i selected my camera go into the camera menu and add the background image and then i've imported the jpeg sequence that i exported from nuke so i can view this in the background of the camera which is this and then at this point you just do whatever you're intending to do in the 3d software so in this case i had the cg version of me i set up the lighting and everything with an hdri and i also set up the render for a shadow pass then once the 3d scene is ready to go it's time to render it which is the next important stage of the workflow so we go into the compositor i don't use the default output in blender which is down here somewhere i do all my rendering in the compositor using file output nodes so this is what the output for this scene looks like i've got one set up for the beauty render which is the photo scan of me and then a second one for the shadow pass on its own they don't look like this by default so let me just show how it works so the first one is a render layers node you can select the render layer down here the render layers down here are just the names of the view layers that you have in the top right then you add a denoise node just plug the image into the image and then the denoising albedo and normal into here if you don't have those turned on just go into the render layers tab and turn on denoising data otherwise they disappear then after that add a file output node connect the image into here and then if you press n you can open up the menu on the aside and change the properties again we don't want to render jpegs or pngs or anything we want to carry on with our exr sequence workflow so that we keep everything consistent so change the file format to open exr multi-layer change the color depth to rgba so that we keep an alpha channel and i'm just going to render the color depth as half because there's no need to do full precision 32-bit exrs for this keep the compression on zip lossless then you can set up all the different outputs and this is for all the different channels within the exr so the default one is called rgba in nuke so i've renamed this one from image to rgba if you don't do this the default channel in nuke will just be black and you won't be able to see the render which is kind of annoying so if you're going from blender to nuke make sure you rename the first channel to rgba then what you can also do if you're getting really stuck into all the compositing is make inputs for all of the other channels as well so as you can see on this one down here i have mine set up in blender automatically so that all the other ones are always there and i can just turn them on and off or unplug them if i don't need them and if i want them all i have to do is just turn them on in the render layers tab and then i can plug them in for this i decided not to use any of them because the the photo scan didn't need much compositing but if you do need them you can just go into the properties add another input and call this glossy direct for example and then you just turn on all the glossy stuff and plug in glossy direct so anyway let's get rid of that so like i said i've got two of these so i did the first one and then i just duplicated it and set the second one to shadow then for setting up the path it's kind of similar to how it works in resolve you can automate the creation of the folders and where everything goes so you'd have to set it up manually each time as you can see this doesn't have the full file part to the hard drive this first double slash tells blender to save it in the same location that the blender file is actually saved which just means wherever you press ctrl s and saved your file originally then i've added two dots which means go back up one folder level and then go into the renders folder which looks something like this so the blender file is saved in the scenes folder which i showed earlier that's what this double slash does like i said then the two dots means it goes up one folder level so we go back up then it goes into the renders folder which already exists which is in here and then the rest of these folders don't normally exist that's just because i've rendered this already but whatever you add into this file path blender will create the folders for you automatically so i've added an extra folder here by just doing v1 then another forward slash which tells blender to create that version one folder and then after that this is the name of the actual image sequence so it's just called gif underscore beauty underscore and then down here it's the same thing except it's gif underscore shadow underscore and when you go to render animation up here and start rendering those both of these image sequences will render exrs into the given folders and name them how they've been named in the file output nodes again these are rendered as aces cg which keeps the linear exr asus cg workflow going then back in nuke you can go into the renders folder blender renders version one and as you can see we have both of the exr image sequences here i can bring them both in and i've already got them plugged into the nuke scripts but i've set up the shadow which was here and then the main beauty render which is the photo scan of me which goes in here then you can do all of your comp work so this is what the actual shot looks like like i said this is just a test for something i was doing so it's not really anything particularly exciting but it starts off with me on the one wheel and then as the camera pans like i said earlier you do the old texas switch and it's now the photo scan of me flying off into the sunset the model of the one wheel is currently just a placeholder if you're wondering why that's gray i need to actually photo scan it or model it and then eventually you come to rendering this out of nuke which is where it does the full round trip and you go back into davinci resolve like all the rendering processes in this i've set up a way of nuke that it will automatically name this so that i don't have to do it myself every time so in the right node's output in nuke i've set up an expression that tells nuke to name the image sequence that it renders out for the comp to be exactly what the nuke script is called so that's what this first lot is here and then at the end it just adds to dot exr onto the end which is the actual format of the render so that means that all i had to do whenever i'm rendering stuff in nuke is save the nuke script once so for example if i go into here then i would call it something that's in keeping with the naming conventions we've been using so far so for example vfx underscore shot one underscore comp underscore version one and then save and then as you can see the right node is updated to using that exact naming convention for the name of the image sequence that it renders then from here what i would do is render this shot out of nuke and then eventually we end up back in davinci resolve so now back in resolve once we've exported all the exrs we can set the color space back to srgb so it looks correct and then we can bring in the comp so i'm going to import that and then if i bring this down into the timeline and put it on top of the footage if i turn it on and off you can see that they're kind of the same but the colors are changing a little bit not sure how visible that'll be on youtube but if you look at the sign and the floor and the van over here they're changing a bit that's because we need to make sure that the comp is also tagged as acg when it comes in to resolve so right click aces input transform color space conversion and then asus cg here if i turn these on and off you can see they look exactly the same but obviously if i come to the point where the cg is the cg is now in there and then the final step when you're back in resolve is you can use this to do any color grading before exporting the final version so for example i can go into the color tab turn up the contrast a bit and add a bit of a vignette if i want to one thing i often have to do with skies when i'm grading stuff in resolve is key them and pull them down as you can see there's not really any range or detail in the sky here but what i can do is create a key for the sky by going into the keying tab and just selecting this and then i can drop the gain on the sky which will give me some nice detail up there i can just turn up the blur radius on this and then set up a mask soften the mask a bit as well that's a very badly done quick example but that's a good indication of the kind of stuff i end up doing in color grading and resolve and the reason we have the range to do that and it works so well is we kept the 16-bit exr workflow throughout everything we did if you tried doing this with something like a jpeg it just wouldn't have the range and you wouldn't be able to pull that kind of detail back out and then finally eventually what i end up doing is exporting to youtube so i've also got a preset for youtube 4k if i'm sending stuff back to clients for a freelance job i'll render to prores instead and return the shots to them this is still set up from the green lantern video but essentially i just render it as an h264 or h.265 i render it 4k 25 fps and i set the bitrate kind of high and then just export it it got a lot darker over the process of making this video all the lights disappeared from this side of my face from the window so there we go that was probably quite a long and technical video but hopefully there was lots of interesting stuff in there that is pretty much my complete vfx workflow for both professional and personal work thank you very much for watching if you enjoyed consider liking and subscribing and i'll see you in the next video [music] thank you