some of you will have seen shawn and me going wild around bletchley park and will deduce from that that we paid a visit to bp as they call it in the trade it's time now for me to move off from the enigma story which i've done two or three videos on already and tell a story this in many ways is even more relevant to the start of computer science than even enigma wars we've all heard of alan turing but i would suspect that fewer of you have heard about bill tut max newman tommy flowers but they're all worthy of hero status because they are all connected with a type of cipher traffic mysterious driver traffic the came to bletchley parks attention and at bletchley was always called tunney traffic they love calling mysterious traffic by the name of fish and was things like sturgeon and halibut as well as honey but this one is going to be tunney traffic tony is the original english word for what we nowadays call tuna it's as simple as that even before the war the metropolitan police and the foreign office jointly used to listen to the airwaves to see what was happening you know that shouldn't be happening within the uk shows anything mysterious now an awful lot of course what they were listening to was plain straightforward radio broadcasts or from the military point of view it will be morse code some of that morse code might well be encrypted enigma traffic but it was in morse this one was weird it wasn't in morse it sounded almost like a touch-tone telephone on steroids or something it was me all over the place and so what they did was they equipped the listening stations all over the uk because they all knew that war was almost inevitable they had a whole load of joint listening stations and these listen for enigma traffic they also listen for anything unusual they were called y stations capital y for reasons i don't understand but there again bletchley park was called station x and i don't understand that either so these y stations say look there's some weird stuff here would you like to see what it looks like they were able to make a recording of the trace of this as if it was an oscilloscope but actually on a piece of paper if you look here it's like a waveform and that is exactly what it is and they were able to record this as a black trace and when you look at his like a mixture between a sort of sine wave and a square wave but once they got the experts in looking at this you're going to remember teleprinters were very common they were used in stock exchanges that were used in telegraphy a lot of traffic went over land line that was actually teleprinter code this was broadcast because presumably the land line was too long between the far end of greece and germany let's say so it had to be broadcast and that the expert said that's broadcast teleprinter traffic matters now you know why sean and i have set the seed by doing a video already on five old paper tape codes teleprinter alphabet and even on exclusive all the rule had the police and the foreign office's anything mysterious like this gets sent to g ccs we remember from the previous videos g c and c s government code and cypher school initially based in st. james's park in london with a great majority of it moves off to bletchley park in the late thirties so blessed park was accumulating this stuff big debate is this a vernon cipher in the late 1920s an american employee of at&t had come up with the idea of doing secure and ciphered teleprinter transmissions by doing what we would now call an exclusive or between two five bit puns yeah great idea because it would disguise the character you wanted to send there's only one problem that if you want to apply that to a whole message how would you arrange to have as it was cipher key characters randomly chosen to mix in very exclusive or with your plain text that you wanted to send and to send out the result well what vernon proposed and to my amazement he patented it and he this is madness this is madness this is secure this they shouldn't be patenting this stuff it gives the game away this is' - and we're not at war yet we're not having the competition coming over this prize idea this has got commercial potential you know as well as military we're going to pay some tit so vernon patented the idea it would use to five whole tapes and what you could do is have this one which is the plain text running alongside this one which is somehow been generated and this is the key this is the thing that's going to be exclusive odd character by character with this to give a ciphertext the problem is the enormous one these things are driven by sprocket holes you start trying to run two tapes simultaneously through a piece of bespoke electronics which i invented which will do the merging but you must keep them in exact sync you do not want differential stretching between the two things worse still when your supervisor says this thing isn't going fast enough we need more speed and you speed it up you know what happens next the sprocket holds tear and then you've got slippage like you've never dreamed of in your worst nightmares so as a result of all this problem of tape synchronization it never really got to market it was quietly abandoned but the idea was good but the people of blasi parts i'd say is this a vernon cipher that we were taught about at training school before we started here at bp but maybe the germans have been smart enough to say we're not going to use a second tape because you could have it synchronized we will provide the key characters from a machine it will be like an add-on to the teletype the teleprinter you type in your plaintext character this theme will invent and it's probably going to have we'll throw two wheels every good cipher machine has wrote orioles on it would somehow generate a 5-bit international teletype letter and then it'll automatically exclusive-or it and then we'll get an output and that'll be our cipher and the good thing is that it will be a lot less problem to keep the machine in sync with what we're doing when you've only got one tape to worry about so in the end they discovered that that's exactly what was happening looked at more and more this tunney traffic how on earth are we ever ever going to get into this stuff at the start of this signal it goes up high but the rule in these intercepted messages that we'll put out on this piece of cake called the undulator is that if it's high it's a zero and if it goes low it's a 1 and the neutral point is somewhere in the middle let's just do a straightforward addition of two five bit codes to see what it would look like the letter a capital a in the international teleprinter code the bordeaux murray code is one one zero zero zero and let me remind you one of the approved signals for doing an exclusive or operation is plus in a circle i'm going to add that on v exclusive or to the letter x letter x is 1 0 1 1 1 you all know how this works now exclusive-or gives a 0 if they're the same and a 1 if they're different look that up in your table what character is that it's the letter v so there we are look the plaintext shall we say was a the ciphering character given by the randomizing device was x and this particular character is v what we're going to have to do on this shirley is to get enough evidence about that random t stream before we can start working out how the heck it works mathematicians were around and we're up on the scene arguably not as many as bletchley park really needed in the early is to say look this is an example of what we in the mathematics trade call an additive cipher ciphering system it's doing arithmetic modulo a certain number this as i've said is arithmetic modulo two is binary addition but without the carries and some wise self said do you know there are weaknesses in all additive ciphers basically at the end of the 19th century a man called kerkoff's had published a paper about cryptography in via and ative ciphers and said the problem with them all is if you accumulate enough captured ciphertext even when you don't know the key but lost different messages if they're all done with the same key you can eventually accumulate so much that very clever trick you can work out what the messages are without even knowing the key because it kind of cancels out oh that could be awful so all we've got to look out for then is are they using the same key for any of this stuff handy every single one of these transmissions before it came through on the undulator they all came with an indicator now this really puzzled them at first i copied one down from my reference books those 12 characters would be sent out and then there'd be a pause and then this stuff the undulator traffic would start however there was sufficient of this sent out to train the operators that again the game was given away the crypt analyst said i wonder if that's in in code or cipher itself and so i don't know bc could this be like enigma they sent out blocks of three letters to show the settings the initial settings could it be like that and somebody else would say yeah but there's 12 of them that doesn't make sense 10 would make sense two layers of encipherment one after the other first row of five you know five bits and then push it on again to another one but these could be settings of so four wheels just like enigma but how can we be sure that they aren't in a code of their own do they really mean what they say as part of the training scenario obvious for the poor operators trying to work this machine there was some of the transmissions that said in clear em east michael g is to gerhart alright so by the time you've got o is auto k is karl right you can see this is training / - yes it's k4 karl you see the k and you wind the cipher we're out of sugar let's get k for call and by the fact that they had elaborated in the training all of these as boys first names made the listeners sure that these were what they seemed so the answer now is very clear we have to sit and wait patiently we have to ask our y stations to rigorously send us exactly what the indicator was and if we wait long enough somebody will use the same indicator twice absolutely against standing orders but it was known from enigma this was a great temptation in the heat of battle with people shouting at you you use the same settings twice it's all right no but you'll be listening oh yes they are this did happen i guess you could say sooner rather than later i think it was august 1941 they finally got a message which you got the same indicator and they knew perfectly well that with that when a lot of hard patient work because were no computers to help you nevertheless we could probably disentangle this message now another thing these messages seem to be going between headquarters of the german high command these were not between weather stations they were not even between luftwaffe stations this was serious stuff which this was going from athens hq to berlin hq shall we say clearly this stuff and there wasn't much of it initially was going to be used by the higher-ups the german high command as we now know it really was hitler's favorite cipher machine it's great advantage unlike enigma was that it was user-friendly you know what enigmas like you need a person to punch the thing a person to read the lamps a person to send the morse code here you could connect to encrypted type teletypes back-to-back across a landline or even across the airwaves although that would be a bit dicey to do with interference but you could in principle have your operators never see the cypher text it goes in one end and ciphered across deep ciphered out it comes therefore costas is using user friendly people will send longer messages and that's music to the ears of the crypt analyst prague aid they love that by this stage the listeners had decided that we needed a new y station separately for this tourney traffic remember the traffic was called sunny the machine that was generating it was called german honey or just honey the machines that eventually they built at bletchley park once they understood how it works to do the same job of deciphering was called british honey but it was all tunney yes a so he was this tiny traffic all stacking up all waiting to be decrypted all waiting for two or more to be sent out with the same key now a bletchley technically that's called a depth getting a depth means you've got two or more character messages all with the same key absoulutely against standing orders because the german cryptographers had warned the military this one this kind of xor additive cipher is even more sensitive to depths probably even than enigma within it we only got a short message out anyway because life's too short to send much more than about 50 carats this thing in the end they got 4000 characters worth and then when they said when the chap phoned back that i said sorry didn't quite get that could you send it again my first thought was surely the sender guy would have had the cents to make a tape of it and to send it offline in the first place no we hadn t typed it in by hand without making a copy so when it was sent again you can imagine the sender muttering and cursing used abbreviations he made it shorter and as we'll see next time that made the deciphering job even easier zero zero two one and so on and the important thing about this is by doing this we're going to get a huge list of noughts all in a row and that is very easily compressed by huffman encoding most of our volunteers have been building the circuits at home on kitchen tables in garden sheds