well i thought it would be fun to talk about the problem of playing poker over the- over mail or over the phone.
you know, deck of cards, we can shuffle them. and i want to deal you five cards, i want to deal me five cards; that all works nice and fine for face to face, like we are now - how do we do this over the mail? you know if i'm going to put them in envelopes and mail them to you know, obviously i might just peek. i might just switch the hands here because you've got ace high and i've got king high and, you know, 
we'll do it this way. - (brady: you wouldn't cheat like
that, would you?) i might i might. you want to put cards in envelopes and ship them around and have a fair deal. and that's a model for what we can do over the internet. that after we see what happens with postal mail we can try to see can we do the same thing over the internet. yeah how are we gonna do this? so somehow you need to choose five cards, i need to choose five cards. your five cards have to be different than my five cards. you shouldn't know what my five cards are; i shouldn't know what your five cards are. so we're going to add at least a little bit of pseudo-cryptography here that is locks. we're gonna mail you all the cards. so i'm gonna take each card and put it in an envelope, but you're not going to be able to see them because i'm going to put a lock on each one. so that you can receive these envelopes in some random order the way the post office delivers them. and you get an envelope that looks like this, with your name on it of course. it's got a card in it, you can't see what the card is. and we'll do that 52 times. so i'll put a card - there's the five of clubs, put that in an envelope, lock it up, there we go. 
okay, locked up. i'll keep the key, and there's your second card. i've got the key to all of them so we're gonna have 52 of these. in random order, you have no idea what card is in which envelope, and they're all shuffled by this whole process of getting them to you in locked envelopes like this. and so you've got 52 envelopes, or boxes; each with one card in it; they're all shuffled you don't know the order and you're not gonna open them - you can't open them actually because you don't have the key to these locks. so the next thing we're going to do is you're going to ship them all back to me with an additional lock on each one. so you're gonna put a lock on the other corner of the envelopes here and then they'll be double locked and i'll get all the envelopes back in random order each doubly locked. so let's do that. yeah these locks are just like the original ones, except that you have the key instead of me having the key. so you've got the key now, you can unlock all these second locks, and we've got them here. these are different colors so we know these are brady locks as opposed to ron locks. you putting black on the envelopes - should be clear these are your hands not my hands doing the work here.
- (brady: these are mine, these are mine.) i like these problems, these are good. so at this stage we're at a very interesting situation. we've got all the envelopes sent to you with a lock on them, in this case the silver locks that i know how to unlock. and now you've taken 
the envelopes, shuffled them up, and put your own locks on each one - one black lock per envelope as you see here. and you have the keys for the black locks, i have the keys for the silver locks; and all of these get mailed back to me in some random order. 52 envelopes, each doubly locked, well shuffled and i can open half the 
locks, you can open half the locks. nobody can get to the cards on their own. it takes both of us to fully open one of these envelopes. so let's go to the next step. i want to give you the card that's in this envelope, without me knowing what it is. i don't know what it is now, in order for you to see it we have to take both locks off. so i can take my lock - works fine. now we have an envelope with just your lock on it, and i can mail that back to you. i don't know what the card is. you receive this in the mail and you know that's one of your cards for your hand of poker. and i'll do that five times. so i'll take my keys and i'll unlock five of these envelopes, removing my lock from five of them with the lock on and 
there we go. and now you've got all five of your cards; i have not seen these cards. whenever i have my hand on these cards they've been locked with your lock. 
- (brady: alright let me do it.) (let me see what i got. d'you wanna
be cameraman?) 
- sure - (okay, here's my first one.) 
- first one, good. don't tell me. (brady: awh yeh i don't want you to
know do i?) (but i'll show the people at home.) (alright let's see what else i've got) you've got your hand and
the next thing we've got to do is give me my hand and i've got 47 cards doubly locked. i pick five of them out of a pile; here's the first one, here's the second one. each of them has two locks on it, so i can't open them, you can't open them fully. but i'm gonna take them, those are my five that i've chosen for my hand. i'm gonna mail them back to you. so i put them in the post, stamped for speedy delivery. 
- (brady: this is the professor's) (hand but i can't see what it is cos he's) (still- it's still got his lock on it. so) (i'm allowing him to see his hand without) (me getting to see it.) (so i'll take my looks off. so here's the) (professor's hand.)
- please mail it back to me.
- (here you go.)
- so i got my hand and they're locked with locks that i can open. let's see what i got; and then we'll see who won. the last card- i've opened up all five envelopes and i got a hand- almost a flush even. but i got ace, king and you've got queen, jack. ten, nine - if you had an eight you would've had a streak. (brady: yeah, if only.) what we achieved was playing poker over the mail. we dealt the cards out in a way that you never saw what cards i had, i never saw what cards you had; until we finally opened them up but individually then we could disclose them. or maybe we'll have a round of betting first. and you can see that, yeah i've won and it was a fair game, right? even though we played it over the mail, and you'd think it might be impossible to play poker over the mail - how do you deal the cards? in fact you can deal the cards as long as you have locks that only i can open, and locks that only you can open. this is an interesting example of what we might call a cryptographic protocol. we want to do something over the internet, it's got certain properties you want to achieve; and i think a poker game is is emblematic of lots of other things you might want to have happen with bidding or other kinds of things on the internet. here we needed to have some special properties, what we call 
commutativity. the fact that you could put your lock on and then i could put my lock on and then you can take your lock off and then i can take my lock off. it's kind of unusual in mathematics where you're sort of applying one function then applying another function then undoing the first function and then undoing the second function. so these operations of locking and unlocking actually commute with each other. so, we can do the same thing with a bit of math and make playing poker over the internet feasible then. so we need some function that represents locking. so a card is no longer a physical card, it's some kind of bit string or number that represents that card. i can still write it maybe as queen of spades - there we go there's a queen spades. so that's a bit string or character string that represents that card. we want to somehow encrypt that to give us the equivalent of adding a lock to it. so we got a lock here we want- what what does it mean to put a lock on that bit string? well i'm gonna apply some function. we can imagine just taking it to
some power k. so k is a number i know so k is my key. and i'll remember that and i'll take that bit string and i'll raise it to a power, maybe modulo some prime or something. these are big numbers, these p might be 100 digits, it might- you know, like that. so and k could also be a very large number. so these are numbers you can't guess, you can't know. we can agree on p but you don't know k. that's just like an envelope with one lock on it. take the number that represents the queen of spades and raise that to the kth power and k is a big number here, so raising a number to a big power is itself an interesting operation. turns out to be something that's one of the most important operations in cryptography. and it's something you can do efficiently. so even if k is a 100 digit number or 200 digit number we can do this very quickly. taking the remainder mod p at every step, and ending up with a result which is just q to that kth power modulo p. so remainder after dividing by p. that's what- this is the computer representation of it, this is the- what
we had for the demo with an envelope. that's the first encryption. we've done that just by raising to a power and dividing the results by p, taking the remainder. so now we want to raise have the other party, encrypt it again; and that's raising to another power. so we can take q to the k and raise that to some new power j mod p. so the other party knows another secret key. so j is brady's key. so you've taken that, you've raised it to the jth power. 
- (brady: so i've taken the big confusing) (number you've sent me-?) 
- yeah, you've taken that. raised that to the jth power, divided by p, taking the remainder. and so this is the result we have. the nice thing about this is, you know, we can take the locks off in either order here. we can actually take these exponents off in either order as well after i get this result. this is equal to, by the laws of exponents; q to the j to the k mod p. fully equivalent, they're mathematically identical. k can be on the inside or could be on the outside. j times k is the same as k times j - commutativity of multiplication gives us exactly what we need here. so now we've got this. so you've
sent me back a doubly locked value. queen- queen to the k to the j. and so now i want to take the, my key, off so i can mail you back your hard. so i can just multiply by k inverse in the exponent - q to the j to the k raised to the power k inverse. so k inverse we have to compute in a way that i can explain later, but it really is just the multiplicative inverse of k when we're dealing in the exponents like this. and so k times k inverse cancels and we get this is equal to q to the j mod p, which is to say the k lock has been taken off. so how we take off the first lock and the j lock remains. the k lock has been taken off. and now you can do the same thing. to remove your lock q to the j to the j inverse. there's a value - is j inverse up in the exponent. we take the remainder mod p and that's just equal to q; because j times j inverse is 1. so mod p. so this is this and you could get your card queen of spades. so this is an example of what you might call a cryptographic protocol. so it's an example where i have some information, you have some information, we want to share information. there might be some complicated rules for how we share information, who gets to know what when. that's exactly the kind of thing we have here. that happens all the time. for example, it might be an auction. we want to bid for an oil field or something like that and cryptographic protocols do get used for these kinds of things where we're bidding, you have to commit to a value and then later you have to reveal the value. so it's very much like we saw here where we lock things and later unlock them and so on. so, so that's another example. various kinds of economic transactions happen all the time like this. i think auctions are maybe the most interesting example.
- (brady: seems like it would be) (a hard thing for the computers
to do, these) (huge calculations)
- yeah so there's a trick here, which is called repeated squaring and it's a wonderful trick. it allows raising to large powers to be done efficiently. and computers are doing this all the time, especially in cryptography. let's take an example. so suppose you want to raise q to the 11th power. so 11 is not a big number particularly, but let's take that as an example. so that's just q times q to the 5th squared, right? cos q to the 5th, squared, the 2 times 5 is 10;
times another q that gives us 11 qs so that gives us q to the 11th. what i've done here is i've taken the problem, doing two operations - one a squaring operation and a multiplication. i've reduced the problem to something of sort of half the size. so instead of having to worry about computing q to the 11th i'm now worried about computing q to the 5th. so i compute q to the fifth first, i square that, and i multiply by q and i get q to the 11th. and q to the 5th, how do we get that? well that's just q times q squared, squared. and q squared it's just q times q. so by building a chain like this, increasing by a power- factor of two every time we can build up very large numbers quickly. the number of squarings and multiplications you do is just equal to the bit length of the exponent. so if you had a hundred bit exponent you're essentially doing 100 squarings and hundred multiplications. 
[preview] ...with a proper attack; big computers - it will still take them thousands of years to factorise that number into its original prime numbers. now hidden in the details for this code...