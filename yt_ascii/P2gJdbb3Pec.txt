we're starting at 900 sites 125 million accounts one vulnerability by m br bruh ziga and loggi kk ziga is in here all right anyways tldr firebase allows for easy misconfiguration of security rules with zero warnings how many of the configurations were driven by ai can we just answer that you know what the best part is is if you misconfigure it and it's public and a lot of people have it it will get baked into the cake for like years oh beautiful this has resulted in hundreds of sites exposing a total of 125 million user records including plain text passwords what sensitive billing information what after an initial buzz of poning chatter ai has settled down wait what is poning chatter ai am i about to get ligma how i pwned half of america's fast food chains sim okay that might that might we we just might have to take a quick divergence and read that one that one sounds good does that one sounds good yes it does sound good has settled down we we set to work on scanning the entire internet for exposed pp pii that's what is that that's personal identifiable information via misconfigured firebase instances attempt one mr br wrote up a rudimentary scanner in python that would check for firebase configuration variables in websites or their loaded js bundles it worked until it didn't it turns out that python program with 500 threads will start start to chew up memory over time really first off i absolutely love this but i i love the first i love the first conclusion here turns out python well it's python no idea how that happened for for us that meant it would oom oh my goodness you got an oom you oed yourself that's so good that's so good i love it that's just my favorite i love getting oed i've oed many of things all right logy rewrote the scanner and go should have been rust un unlike the prior it didn't seem to leak memory it really doesn't matter the language then our initial estimate was that this was going to take 11 days to scan through 5 and a half million domains but it turned out to be closer to two to three weeks which made this very much a waiting game okay manual checking every domain we first went and started manually looking at each entry in the 550,000 line text file holy cow seeing if we could find anything interesting this was timec consuming and very repetitive you know in the end we went through quite a lot of it it had let's see it had 136 sites and 6.2 million records but all we knew that we needed to do something fully automated because this was taking white too long yeah mean know once you figure out the process i assume you can automate it this is very interesting okay once we had acquired a our short list of potentially affected sites we ran it through a secondary scanner that eva had made called catalyst this would take the site or js bundle we found then automatically check for read acc access to common firebase collections and any that were explicitly mentioned in javascript itself this is just so beautiful this is just so beautiful when it found read access to to a collection it would attempt to calculate the impact of the exposed data by gathering a sample of a 100 records checking the type of information contained and extrapolating that by the total size of the collection then we decided to the database let's see then we then decided the database to use to store all the results and we chose superbase which uses posts under the hood a open source firebase competitor just for irony so this is just out there so you you literally just went on the internet and just looked for read access that was exposed in j javascript you know in my head whenever i think of like someone that's doing like some form of hacking it's like this like intense there's like linux it's like it's like you know it's hacker man getting deep in there it's like some really crazy stuff they're like they're taking advantage of of memory and systems and all that this is just javascript being like yo javascript you got read access all right all right all right all right and then just a shazam you're just in what' you do i wrote something and python it leaked a bunch of memory rewrote a program and go now it doesn't leak memory waited two weeks and then it started manually checking a list and bought a b bing bada boom crushed yeah like gan stuff i think of gan often gan just like slow conning people for for years catalyst okay so we did this once we had all that completed the data was formatted and uploaded to a private database table users user stock document data invoices testing instructions employees don't know what that is history spin roulette redeem oh no all records 125 million names 84 million emails 106 million phone numbers 33 million passwords 20 million billing info bank details invoices etc 27 million there's probably a large there's probably a much larger list short list of affected sites by the way so quick question did you inform sid lms did you inform sid of lms a learning management system for students and teachers most total exposed user records 27 a million affected users name emails and phone numbers damn yes disclosure was done okay online gambling network okay that's not too surprising gambling networks are typically set up just just gorilla just gorilla domains compromised of nine sites which are all reskinned of each other shocking shocking reskinned low effort gambling sites common spins are rigged and have a zero chance of winning okay i'm going to give you a little hot take here there's sports betting right i i would put this under the category of like foolish you know i'm not really into betting in general it's it's just kind of like dumb then there's casinos they're regulated they're required for you to lose a at a certain percent so you're not going to lose more than 96% you know over some course of time or whatever it is depending on the game right each game has its specific odds you can look it up and you'll know that if you play you know if you played a thousand games you would lose that amount of percent or you'd win that much so like i think for craps you would end up winning approximately you know like by winning right craps is craps is like tetris you only lose but you would end up winning like 460 or whatever it is right you know there's like there there is you are this is a 100% guaranteed loss this is less of a guaranteed loss this one's more confusing right you know you got you know but then there's unregulated gambling and it's it's slot machines it's often in crypto and it's on some sort of shady website yo dog what are you doing with your life i mean you got some strategy you're going to lose but at a certain rate and this is just handing somebody money what are you doing with your life don't do that customer support tried to flirt with me when i attempted to report the issue your firebase allows anyone to read information i'll send you a link do you have a girlfriend i want to be our girlfriend you're very smart dang it i couldn't i actually couldn't get out some something stupid to say at this i actually couldn't even like i couldn't force myself to to act normal reading this i am actually pretty shocked that this would be the response of customer support and what i mean by pretty shocked is that normally customer support i would expect oh i don't i don't understand this this is bad i don't know what to do right like i would expect incompetence that's a that's just a whole new level i've never even seen this kind of level anyways contain the most amount of exposed bank account details logins out of all of our records 8 million also contains most pl text passwords off all affected websites 10 millions sh leave it to an unregulated gambling site to store passwords in plain text and have them readable by a javascript nice nice lead carrot uh online lead generation for cold calling top three in total amount for exposure user information sitting at 22 million affected people my chef tool luckily i have done none of these business management app and point of service application for restaurants first place for most exposed names and second place for emails nice ni the aftermath 842 emails sent over 13 days 85% emails delivered nine emails bounced 24% of site owners fixed mixed configuration 1% of site owners emailed us back 2% of site owners offered bug bounty i think sometimes i have such a positive view that i would assume that a really high percent of percentage of people be like crap we got misconfiguration let's fix that immediately right we're exposing data but man less than 1/4 less than 1/4 .01% of customer service got laid  oh no the internet's dumber than i thought the internet actually is the dumbest place in the universe fixing the issue wasn't on the sprint this is crazy to me this is just absolutely nuts this is incredible work by the way do you have any of this stuff open source do do you have any of it that that can be perus cuz it's pretty cool that you did this i'm curious how you got all these websites like what was your what was your general kind of strategy for like did you have a strategy for which ones you would look for was there a certain class how did you categorize them because this sounds like a bunch of mixed manual work versus non-mixed manual it's pretty cool it's super cool absolutely amazing n fail post fire wreck this is beautiful by the way i would just like to let everybody know this is this is like a really great great way to show expertise real talk you go and you actually figure out things and you do it the right way your goal your goal is to do stuff and then inform people and then actually try to get things fixed and then write about how you achieved this thing because this is absolutely great write up just amazing i am so pumped up about this anyways great job great job eva and everybody else you do have xy in your name eva little bit worrisome okay i don't know what version you're at okay i don't know if this is i don't know if this is a gan moment here anyways i am glad i enjoyed the rite up yeah dude it was great hey thank you mr bro i'd love a little bit more detail on some of the things cuz man i'm just curious how like what did you look for i have no idea i don't even know i've never configured i've never misconfigured firebase let alone configured firebase the name maybe i need to know a little bit more about firebase maybe i'm just being weak here