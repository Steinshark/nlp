you know i went on vacation for like one day and this is what i come back to why what' you guys do i just want a single day gone and it's just like oh by the way the an unpatchable vulnerability by the way i'm curious what these encryption keys are what what i i wonder which encryption keys we leak in you know it sounds kind of exciting i assume it's to be able to unencrypt your drive so you can just like look at everything classic back door in other words they just discovered the cia back door back door cia a newly discovered vulnerability baked into apple's m series of chips allows attackers to extract secet keys from max when they perform widely used cryptography operations academic researchers have revealed in a paper published thursday so real question back door wang mentioned this is a full back door wang when there's an unfixable problem like this how long do you wait before you like publish out a paper like what's a what's like the rule of flum like do you have to like go and talk to them is there like something you have to do this was probably found day one after release probably was found i think you have to get vendor approval okay really you have to get vendor approval why do why does apple have to say you can release that responsible disclosure yeah i mean i assume there's some sort of conference requires 90s days that's it okay apple got owned in its own hardware i know you made custom hardware get effed well let's see oh is there a little bit of a reddit one today i learned it's a side channel tack that requires some very specific set of events in a controlled environment to work over the course of minutes or hours threat average users nothing to see here high value targets if your machine is seized and it's an m1 or m2 there is a chance this could be used to extract keys and decrypt data there was one point he forgot do you guys know what that one point is average system 76 users don't even don't even what's a what's an apple m1 chip is that that company that's getting sued all the time for monopolies like what's what's an apple where's your stickers at oh i'm an adult i hate i hate to tell you this but as an adult i don't put stickers on my laptop i keep things clean and nice anyway so let's find out more about this a flaw a side channel so i don't know what a side channel is that is that like a side hustle or a side honey and in in computer security a side channel attack is any attack based on an extra information that can be gathered because of a fundamental way a computer protocol or algorithm is implemented rather than flaws in the design of the protocol or algorithm itself okay okay so a side channel attack is effectively you're able to see how the algorithm works or the protocol and you're able to abuse some something inside of it due to how it works it's not a flaw in the protocol it's a flaw in the implementation is that's what it's saying i can talk on this yeah you want to hey low level learner why don't you jump on for a quick second and tell me about this call me on discord there we go all right all right so obviously quick quick introduction about yourself what do you do why why why why are you gonna explain side channel hacking to me yeah so my name is lowle learning i'm ed hi i'm a security researcher during the day so my job is to instead of writing code like the rest of smart people on youtube that are smarter than than me i look at code i find bugs in code and then i write reports yeah that's me yep okay okay so what's a side channel attack did i did i describe this correctly you did 100% yes so so basically an easy way to think of a side channel attack is let's pretend we have a password checking algorithm and the password checking algorithm will check every character of the password and we know that if the password is correct for one character that character will take one second to process but if it takes three seconds process then it's incorrect so amount of time that it takes is not a part of the actual protocol but it's a different side channel that the algorithm reveals and then so we know like okay first character took three seconds it's wrong we brute force that until it takes one second and and like that that's an idea of as okay so it's using it's effectively using the implementation of this protocol algorithm whatever and being able to discover new information due to how it operates yeah exactly something about its operation is incorrect and so we can leak information out of it via a side channel so for for example and we're going to talk about this in this article like a big bug that happens all the time in cpus is cash side channeling right so like when yeah hit me with that what is that so a big bug back in the day was called spectre and meltdown so spectre and meltdown were bugs in what was called speculative execution so when you run code in your cpu your cpu is actually in the future it's running code to like five or six instructions ahead of where your pc is your program counter and what it's doing is it's trying to figure out like it's trying to guess which branch you're going to take and execute pre fetching on those branches and so what was happening is that you could actually leak data out of other memory based on prefetching and effectively the bug was that via that that caching side channel you could leak data out of any memory address on the cpu including like outside of your process region into the kernel of your cpu via a cach side channel right so so caching and cpus and modern cpus are a huge area of side channel vulnerabilities okay and this is because they they are speculatively loading data that you may or may not need into these what is this like these okay shut up battle okay battle net's just letting me know i may want to update something just no i don't i actually don't want to no i actually don't want to no i literally i'm i'm pressing no it's like you must game right now dude i don't want the game okay i'm not in the game zone right now that was crazy that was crazy just really tried to force it on me battl net side side channel attack okay so this is do like so just so i kind of understand this i assume this is involving like the l1 c caching type layer of the of the memories that you're filling it up with potentially things you could use and there's a way for you to feed instructions into the cpu and effectively just read from the speculative fetched area and so you could actually it basically had to do with like the timing of if you took a branch that invoked a cash miss versus a cash hit because one is slower than the other they're able to use that and again i don't know the details of it because it's literally black [ __ ] magic it was able to use the timing of a branch that invoked a cash hit or a cash miss and able to use that to leak information out of literally any memory address and it was only at like kilobits per second or bits per second but it's still bits per second right it's still yeah privileged memory that you don't have access to you only need to leak not you don't need to leak a whole bunch of information to be able to really screw yourself exactly yeah and so it could leak you know process memory from another process a privileged process whatever that was in 2016 that was a long time ago but since then that that bug that report kind of broke ground on people doing research into cash based or speculative execution based side channeling at cpus so i think this is where this article comes from which i won't sp but there you go all right hey thank you thank you he man gotcha thank you triple l hell yeah dude enjoy the article u my son actually just woke up so i'm gonna go take care of that all right byebye later bud what a nice guy giving us a little bit of information there okay okay so we we now feel more indow if you will about what to do here all right so a flaw let's see a flaw a side channel allowing end to end key extractions when apple chips run implementations of a widely used cryptog cryptographic protocols can be patched let's see can't be patched directly because it stems from the microarchitectural design of the silicon itself damn printed a side channel printed that flaw put it put put that one in paper just believed in it so hard that's crazy i wonder like how bad that really is because obviously that the the you know i i'm not a huge fan of just listening to whatever reddit says and it just says the average person doesn't matter but like high value targets if you keep high value information on there there's a chance that somebody might be a to get your encryption keys to your drive and then would be able to decrypt your drive pretty much correct it takes a lot of time i don't think time's a time's an issue at that point right yeah they have to get physical access they have to like steal your laptop so if you were a high value target with something very important on it and some guy just walked up to you punched you in the face took your laptop ran away you'd have plenty of time once you're arrested then they could theoretically be able to take that skill issue punch punch in the face and grab it's it's one of the classic security problems falor punch dang it why do you guys keep talking about falor instead it can only be migrated or mitigated by building defenses into thirdparty cryptographic software that could drastically degrade m series performance when executing cryptographic operations particularly on the earlier m1 and m2 generations the vulnerability can be exploited when the target cryptographic operation and the malicious application with normal user system privileges run on the same cpu cluster dang beware of hardware optimizations the threat resides in the chips data memory dependent prefetcher oh this is exactly what lowlevel was talking about this the speculative execution business a hardware optimization that predicts the memory addresses of data that running code is likely to access in the near future by loading the contents into the cpu cache before it's actually needed the dmp as the f let's see as the feature is abbreviated reduces latency between the memory or the main memory and the cpu a common bottleneck in modern computing dmps are relatively new phenomenon found only in m series chips intel's 13th generation ah raptor lake microarchitecture by the way that's like just the most badass name i've ever seen apple's like m series intel's like raptor lake i mean it sounds terrifying a lake of raptors raptor lake skull canyon i mean they have bad they have badass names although older forms of prefetchers have been for common for years security experts have long known that classical prefetchers open a side channel that malicious processes can probe to obtain secret key material from cryptographic operations this i i guess that makes sense right cuz if for those that don't know i know you could you could you know it's very common for people to encrypt their drive on a mac and so you have an encrypted drive and so obviously these operations have to be running pretty frequently and so my my assumption is that it's just it's just effectively probing for these type of decrypting operations to happen and once they happen they take advantage of that right so wherever they you know i don't know if they have to ret anable encrypt exactly effectively if you could just know when anable encrypt happens and you could just sit there and just do it over and over again theoretically you could you could get this that's crazy that's wild this vulnerability is the result like that is black magic level it's encrypted by default okay it's been a long time since i've touched mac okay i haven't touched a mac in in eight years i have no idea biggest problem here is cloud providers where multiple people share the same hardware and processor well this is on m1 i'm not really sure i know that there does exist apples in the cloud i now i now see what you're saying that's actually really interesting okay so if you're doing like shared so in other words you okay so these these shared these shared cloud $5 rentable computers you have this chance to be able to start scraping other people's information aws only offers m1 as a whole device not a shared device okay is that like i assume that's what you're trying don't share max and aws it's all or nothing okay so that's not even a an issue i know i knew what's it called aws has max i've just never really macked you know what i mean they evaporate m1 chips condense them tp to make a cloud okay okay kind of like kind of like a three body problem okay okay i've heard about this one apple one bad apple spoils the whole bunch exactly they need physical access okay so they need physical access so there really isn't so the clouds aren't a problem okay uh the breakthrough of the new research is that it exposes a previously overlooked behavior in tmps in apple apple silicon sometimes they confuse memory content such as key material with the pointer value that is used to load other data as a result the dmp often reads the data and attempts to treat it as an address to perform memory access this dereferencing of pointers meaning the data of the let's see the reading of the data and leaking it through the side channel is a flagrant violation of constant time paradigm you know i i will say that it sounds like a dangling point problem and it does make me feel a little bit a little bit better that even even these even these chip writers ain't getting ain't getting them pointers correct sometimes this is this it sounds like a skill issue honestly this sounds like a skill issue are we having full skill issue at the cpu level damn a team of researchers consist of wow this is an entire this is like a company it's a lot look at that this is a lot of this is a lot of universities carnegie melon georgia institute of techn ol jit one of the best 69420 on the seal issues yeah dang reminds me the meltdown issues with intel big names those are some big names thick names girthy names in an email they explain pre fetchers usually look at addresses of access data ignoring the values of access data and try to guess future addresses that might be useful the dmp is different in the sense as in addition to addresses it also uses the data values in order to make predictions ah okay so it's looking effectively at a bunch of trues and falses attempting to say okay we're going to take this branch or the next branch in particular if a data value looks like a pointer it'll be treated as an address i would really love to see the code that says looks like a pointer like i i i am genuinely curious what does looks like a pointer code i got to know i got i like i have to know it's just like what is this thing ah 64 bits of ones and zeros pointer mentioned everybody pointer mentioned it's like i i actually would have no idea how to tell if something's a pointer or not if i were to write a pointer mentioned function it would literally look like this we're going to do it in node baby because it's just right here it'd be it would look something like a function is pointer and it just be a value and i would just go return true i don't know yo you hand me 64 bits of something that's kind of a pointer wouldn't you say one could say this is a pointer npm package now if pointer equals true probably a pointer first try yeah if it does not equal zero it's probably a pointer else it's the no pointer which is a pointer it's a pointer just like dang it does it equal zero or does it not equal zero next one conan time paradigm is not validated ex exactly why does your stream have a vtuber tag are you just a bunch of pointers i am don't judge my pixels okay you can't come in here judging my pixels where in fact it's actually not the data from this address will be brought to the cache the arrival of this address into the cach is visible leaking overcash side channels oh so it's able to bamboozle the is pointer function into thinking that the data is a pointer and then thus load it into cache where it's visible then someone has to be reading this cash i you know obviously not not i mean way out of my way out of me malague here but you must be able to read the cash somehow crazy our attack exploits this fact we cannot leak encryption keys directly but we can but we can do is manipulate intermediate data inside the encryption algorithm to look like a pointer via a chosen input attack the dmp then sees the data value looks like an address and brings the data from this address into the cash which leaks the address we don't care about the data value being prefetched but the fact that the intermediate data looked like an address is visible via a cash channel is sufficient to reveal the secret key over time it makes zero sense i'm sure i'm sure this actually makes a ton of sense i think this only doesn't make sense to to to layman such as us okay i've only been programming for for like 20 years i can't understand this kind of stuff okay i'm too dumb like i get the i get the basic principle i'm sure the is pointer function is is probably a little bit more sophisticated i'm sure they have like a lot of like value and i'm sure something that looks like you know it can't have a one in the 33 spot right and by the way this would this wouldn't work for javascript so just ignore it because remember anytime you do a bti operation it it cast it to a 32-bit science number so this would just be like two but i'm sure it does some sort of checking where it's just like hey how big is this number do we have a bunch of zeros on one end that's my guess this article proves that security is security is slow and boring and it's hard but some people love it our key insight is that while the dmp only defferences pointers and attack can craft program inputs so that when those inputs mix with cryptographic secrets the resulting intermediate stage can be engineered to look like a pointer if and only if the secret satisfies an attacker chosen predicate for example imagine that a program has secret s takes x as an input and computes and then stores y equals sxor x and it's to its program memory the attacker can craft different x's to infer partial or even complete information about s ooh oh dang that's so dang clever so exor specifically exor has memory so for those that don't know about this this is this is super cool this is super cool check this out for those that don't know this is like an old graphics card trick if i go like this const a equals let's create a decimal let's create a a very special number here i'm going to go like this let a equals binary 1 00 0 1 0 0 okay and then i'm going to create b which is 00 01110 okay all right now watch this one a equal a b b equals a b a equals a b and now watch this one are you ready for this one battle net no i don't want that battle that shut up no no no what the hell is wrong with you battlenet all right anyways check this out watch this a two string and i let's see hold on h what's the way to print it out with binary i i swear two string works with a number is that right can i just provide it two look at what look at what i just printed for a what do you see about a that's unique what do you see about b that's unique yeah for a lot of people that don't know what just happened there notice the value of a is 1 0 0 1 0 0 now it's 1 1 1 0 which is b and a and now b is a so for those that don't know this called an exor swap and the reason why that happens is that exor has memory dude it's it's this is like one of my favorite one of my just like favorite little things about numbers in in in in the in the old computer science land is that okay so check this out the reason how this works is that for those that don't know how xr works here's the truth table let's say we have a b and we go 0 0 1 0 0 1 1 1 the truth table to this would be 0 1 1 0 so only when they're different is it true so that means that it has memory so when if a equals 1 and b equals 0 if i went a equal 1 x or zero that means a will remain as a one and b if i do it again now i go b equals 1 x or0 notice that b becomes one a is one b is one now if i do it one more time a which is one xor oh i'm in the way now one notice what a is what is 1 one a is now zero it flopped it's super cool xor is just absolutely fantastic xor is one of the coolest things and so there's so many cool things you can do exor that's why like one time on stream we built a linked list in c only using exor for being able to do all the linked list operations and the reason why you could do that is that a pointer is just a number right datas are just numbers so if you take a data region and exor each other what are you going to get you're going to get you're going to flop them right and so i was able to do all the operations on a linked list just using a bunch of xors that's super fun nand is better nand is even better okay very neat the attacker can craft a different a and infer partial or even complete information about us by observing whether the dmp is able to dreference y very interest the first use this observation to break the guarantees of the standard constant time swap primitive recommended for the use in cryptographic implementations we then show how to break complete cryptographic implementations designed to be secure against chosen input attacks interesting enter go fetch the attack which researchers have named go fetch uses an application that doesn't require root access only the same user privileges needed by most third-party applications installed on mac os system m series chips are divided into what is known as clusters the m1 for example is two clusters one containing four efficient efficiency cores and the other four performance cores as long as go fetch app and the targeted cryptographic app are running on the same performance cluster even when on separate cores within that cluster go fetch can mine enough secrets to leak a secret key the attack works against both classical encryption algorithms and newer generation of encryption that has been hardened to withstand anticipated attacks from quantum computers the g fetch app requires less than an hour to extract the 248 bit rsa key and a little over two hours to extract the 248 diffy helman key the attack takes 54 minutes to extract the material required to assemble a kyber 512 key and about 10 hours for the delium 2 key not counting offline time needed to process the raw data that's wild that's so cool you know like this stuff is like really really intense and really really hard to do to me this is where i think things like you know where now that you have this like you have the ability to kind of seed an ai to do it like what can the ai do with this kind of information to me that that that seems like a pretty neat i mean when i say neat i mean it seems very interesting i'm curious if it could actually do something interesting because it is well it's smarter than me right nothing i think it could do something right if you gave it all the ability to do something how cool can it do right i don't know but that's still pretty neat i like these kind of things anything that requires a bunch of very sophisticated steps to be able to produce something i'm always very curious to see what is it going to look like in 10 years as we make as we make things more ai driven are are people are are we just going to have a massive data breaches everywhere who knows what's going to happen very excited i don't know i love this stuff this stuff is so cool i'm i don't want to actually like learn about the funny part is i like it in the sense that i don't want to actually learn about it i just want to learn about it a little bit quantum computing is going to get scary well quantum computing is terrifying like if we actually have any sort of real quantum computing at like some real level not like some fake level right but like real level man that's going to be wild like when we have logical bits as opposed to physical ones that's going to get wild all right so this is pretty cool this is super cool go fetch isn't the first time researchers have identified threats lurking in apple dmps the optimization was first documented 2022 research that discovered a previously known pointer chasing dmp in both m1 and apple's a14 bionic chips for iphones the research from a different assemblage of academics gave rise to the augury augury and attack that identified and exploited a memory side channel and leaked pointers ultimately aur was unable to mix data and addresses when constantine practices were used a shortcoming that may have been given the impression the dmp didn't pose much of a threat dang super cool though super cool all right like other micro microarchitecture cpu side channels the one that makes go fetch possible can't be patched in the silicon instead responsibility for mitigating the harmful effects of the vulnerabilities falls on the people developing code for apple hardware for developers a cryptographic software running on an m1 and m2 processors this is meant this means that in addition to constant time programming they will have to employ other defenses almost all of which come with significant performance penalties dang all that speed up just to get destroyed that's gonna be sad if you guys get destroyed due to that so you're telling me go fetch can't be made possible no it's the other way around go fetch has to be defensively programmed against it it's the it's the it's the inverse is that you have to you cannot fix the silicon it's by design therefore you have to now have defensive cating in highly per performance sensitive stuff which means that you're going to just absolutely destroy just absolutely destroy like performance time right apple keynote m4 is 50% faster than m3 as long as you don't use any software it's the fastest cpu you've ever seen as long as you do nothing it will be faster than anything ever all right like other microarchitecture cpu side channels the one that makes go fetch possible can't be patched in silicon instead responsibility for a ating the harmful effect vulnerabilities falls on the people developing code i think we already talked about this for developers the cryptographic software on m1 and m2 processor this means in addition to constantine program they'll have to employ other defenses oh i already did read this one of the most effective mitigations known as the cipher text blinding is a good example blinding works by adding or removing masks to sensitive values before slash after being stored to loaded uh stored to/ loaded from memory this effectively randomizes the internal state of cryptographic algorithms preventing an attacker from controlling it and thus neutralizing go fetch attacks unfortunately the researcher said this defense is both algorithmic alor algorithmic specific and often costly potentially even doubling the computer's resources needed in some cases such as for the diffy helman key exchange dang this is super cool one one other defense to run cryptographic processes on previously mentioned efficiency cores also known as ice storm course ice storm hell yeah brother hell yeah brother man the ice storm ice storm sounds like a name from from world of warcraft these people are badass you dude gorl lord and ice storm coming right at you which doesn't have dmp one approach is to run all cryptographic code on these cores this defense too is hardly ideal not only is it possible for unannounced changes to the dmp functionality to efficiency cores running cryptographic processes here will likely increase the time required to complete operations by a non-trivial margin the researchers mentioned several ad hoc defenses but they are equally problematic the dmp on the app the m3 apple's latest chip has a special bit that developers can invoke to disable the feature the researchers don't know yet what kind of penalty will occur when performance optimizations turned off oh interesting okay so there is like some defense here then i cast an ice storm re should remember that whenever penalties result will only be felt when affected sofer is performing a specific crypto graphic operations for browsers and many other types of apps the performance cost may not even be noticeable okay long longer term we view the right situation to broaden the hardware software contract account for the dmp the researchers wrote at a minimum hardware should expose to software a way to selectively disable the dmp when running security critical applications this already has a nent industry precedent the examples intel's duit extension specifically mentioned disabling their dmp through an isa extension longer term want ideally okay i mean this makes sense right you should be able to just turn it off for very specific operations yeah you hit a you hit a performance penalty but you can't leak special keys seems pretty it seems pretty reasonable seems it seems pretty reasonable right all right hey great great article this is a great article they'll just find another side channel of course they'll find another side side channel but it's still very very interesting i storm microsoft a threat actor naming microsoft often puts a new naming text on for threat actors align with the theme of the weather we intend to bring better clarity to customers and other security researchers with new taxomony we offer more organized articulated and easy way to reference th threat actors so that organizations can better prioritize and protect themselves against and aid security researchers already confronted with an overwhelming amount of threat intelligence data north korea sleet sle the shittiest of all weathers referred to as north korea all right so which one ice so storm is a group uh groups in development all right where's ice ice isn't listed so ice isn't listed so it's it's it's something group groups in development ice storm dusty tsunami imagine getting hit with a dust tsunami like right now like that would be just so bad i don't want i don't want to get hit with a dust tsunami ice is probably nsa yeah it's probably nsa does that that mean when you have multiple countries working together you can have a blizzard sandstorm tempest this is a blizzard typhoon tempest sandstorm sleet it's slightly dusty poor vietnam how did vietnam get in there anyways this is basically spellcasting you've basically become a spellcaster all right well hey f fantastic everything every everything snow cone yeah the everything snow cone cyclone blizzard storm shark nato no the answer is no it's not it's not going on there hey thank you by the way primagen waiu appreciate that hey the name is man this stuff is interesting and probably slightly over my head secret to avoiding the m1 problem don't own apple a jen