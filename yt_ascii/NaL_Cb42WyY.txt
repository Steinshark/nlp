this is a video i've been excited to make for a while now. the story here braids together prime numbers, complex numbers,  and pi in a very pleasing trio. quite often in modern math, especially that which flirts with the riemann zeta function,  these three seemingly unrelated objects show up in unison,  and i want to give you a little peek at one instance where this happens,  one of the few that doesn't require too heavy a technical background. that's not to say this is easy, in fact this is probably one of the  most intricate videos i've ever done, but the culmination is worth it. what we'll end up with is a formula for pi, a certain alternating infinite sum. this formula is actually written on the mug i'm drinking coffee from right now as  i write this, and a fun but almost certainly apocryphal story is that the beauty of  this formula is what inspired leibniz to quit being a lawyer and instead pursue math. whenever you see pi show up in math, there's always going  to be a circle hiding somewhere, sometimes very sneakily. so the goal here is not just to discover this sum,  but to really understand the circle hiding behind it. you see, there is another way you can prove the same result that you and i are going  to spend some meaningful time building up to, but with just a few lines of calculus. and this is one of those proofs that leaves you thinking, okay, i suppose that's true,  but not really getting a sense for why, or where the hidden circle is. on the path you and i will take, though, what you'll see is that the fundamental  truth behind this sum and the circle it hides is a certain regularity in the  way that prime numbers behave when you put them inside the complex numbers. to start the story, imagine yourself with nothing more than a pencil,  some paper, and a desire to find a formula for computing pi. there are countless ways you could approach this,  but as a broad outline for the plotline, you'll start by asking how many lattice points  of the plane sit inside a big circle. that will lead to asking about how to express numbers as the sum of two squares,  which in turn will lead us to factoring integers inside the complex plane. from there we'll bring in a special function called chi,  which will give us a formula for pi that at first seems to involve a crazy  complicated pattern dependent on the distribution of primes,  but a slight shift in perspective will simplify it dramatically and expose  the ultimate gold nugget. it's a lot, but good math takes time, and we'll take it step by step. when i say lattice point, what i mean is a point ab on the plane  where a and b are both integers, a spot where the grid lines cross. if you draw a circle centered at the origin, let's say with radius 10,  how many lattice points would you guess are inside that circle? well, there's one lattice point for each unit of area,  so the answer should be approximately equal to the area of the circle,  pi r squared, which in this case is pi times 10 squared. and if it was a really big circle, like radius 1 million,  you would expect this to be a much more accurate estimate,  in the sense that the percent error between the estimate pi r squared and the  actual count of lattice points should get smaller. what we're going to try to do is find a second way to answer this same question,  how many lattice points are inside the circle,  because that can lead to another way to express the area of a circle,  and hence another way to express pi. and so you play, and you wonder, and maybe, especially if you  just watched a certain calculus video, you might try looking  through every possible ring that a lattice point could sit on. if you think about it, for each one of these lattice points ab,  its distance from the origin is the square root of a squared plus b squared. and since a and b are both integers, a squared plus b squared is also some integer,  so you only have to consider rings whose radii are the square roots of some whole number. a radius of 0 just gives you that single origin point. if you look at the radius 1, that hits 4 different lattice points. radius square root of 2, well that also hits 4 lattice points.  radius square root of 3 doesn't actually hit anything.  square root of 4 again hits 4 lattice points. a radius square root of 3 doesn't actually hit anything. square root of 4 again hits 4 lattice points. a radius square root of 5 actually hits 8 lattice points. and what we want is a systematic way to count how many lattice points are on a  given one of these rings, a given distance from the origin, and tally them all up. and if you pause and try this for a moment, what you'll find is that  the pattern seems really chaotic, just very hard to find order under here. and that's a good sign that some very interesting math is about to come into play. in fact, as you'll see, this pattern is rooted in the distribution of primes. as an example, let's look at the ring with radius square root of 25. it hits the point 5,0, since 5 squared plus 0 squared is 25. it also hits 4,3, since 4 squared plus 3 squared gives 25. and likewise it hits 3,4, and also 0,5. and what's really happening here is that you're counting how many pairs of integers,  a,b, have the property that a squared plus b squared equals 25. and looking at this circle, it looks like there's a total of 12 of them. as another example, take a look at the ring with radius square root of 11. it doesn't hit any lattice points. and that corresponds to the fact that you cannot  find two integers whose squares add up to 11. try it. now, many times in math, when you see a question that has to do with the 2d plane,  it can be surprisingly fruitful to just ask what it looks like when  you think of this plane as the set of all complex numbers. so instead of thinking of this lattice point here as the pair of integer coordinates,  3,4, instead think of it as the single complex number, 3 plus 4i. that way, another way to think about the sum of the squares of its coordinates,  3 squared plus 4 squared, is to multiply this number by 3 minus 4i. this is called its complex conjugate. it's what you get by reflecting over the real axis, replacing i with negative i. and this might seem like a strange step if you  don't have much of a history with complex numbers. but describing this distance as a product can be unexpectedly useful. it turns our question into a factoring problem,  which is ultimately why patterns among prime numbers are going to come into play. algebraically, this relation is straightforward enough to verify. you get a 3 squared, and then the 3 times minus 4i cancels out with the 4i times 3. and then you have negative 4i squared, which, because i squared is negative 1,  becomes plus 4 squared. this is also quite nice to see geometrically. and if you're a little rusty with how complex multiplication works,  i do have another video that goes more into detail about why complex multiplication looks  the way that it does. the way you might think about a case like this is that the number  3 plus 4i has a magnitude of 5 and some angle off of the horizontal. and what it means to multiply it by 3 minus 4i is to rotate by that same angle in the  opposite direction, putting it on the positive real axis,  and then to stretch out by a factor of 5, which in this case lands you on the output 25,  the square of the magnitude. the collection of all of these lattice points,  a plus bi, where a and b are integers, has a special name. they're called the gaussian integers, named after martin sheen. geometrically, you'll still be asking the same question. how many of these lattice points, gaussian integers,  are a given distance away from the origin, like square root of 25? but we'll be phrasing it in a slightly more algebraic way. how many gaussian integers have the property that  multiplying by their complex conjugate gives you 25? this might seem needlessly complex, but it's the key to understanding the seemingly  random pattern for how many lattice points are a given distance away from the origin. to see why, we first need to understand how numbers factor inside the gaussian integers. as a refresher, among ordinary integers, every number  can be factored as some unique collection of prime numbers. for example, 2250 can be factored as 2 times 3 squared times 5 cubed. and there is no other collection of prime numbers that also multiplies to make 2250. unless you let negative numbers into the picture,  in which case you could just make some of the primes in this factorization negative. so really, within the integers, factorization is not perfectly unique. it's almost unique, with the exception that you can get a different  looking product by multiplying some of the factors by negative 1. the reason i bring that up is that factoring works  very similarly inside the gaussian integers. some numbers, like 5, can be factored into smaller gaussian integers,  which in this case is 2 plus i times 2 minus i. this gaussian integer here, 2 plus i, cannot be factored into anything smaller,  so we call it a gaussian prime. again, this factorization is almost unique, but this time not only  can you multiply each one of those factors by negative 1 to get a  factorization that looks different, you can also be extra sneaky and  multiply one of these factors by i and then the other one by negative i. this will give you a different way to factor 5 into two distinct gaussian primes. but other than the things that you can get by multiplying some of these factors by  negative 1, or i, or negative i, factorization within the gaussian integers is unique. and if you can figure out how ordinary prime numbers factor inside the gaussian integers,  that'll be enough to tell us how any other natural number  factors inside these gaussian integers. and so here, we pull in a crucial and pretty surprising fact. prime numbers that are 1 above a multiple of 4, like 5, or 13, or 17,  these guys can always be factored into exactly two distinct gaussian primes. this corresponds with the fact that rings with a radius equal to the  square root of one of these prime numbers always hit some lattice points. in fact, they always hit exactly 8 lattice points, as you'll see in just a moment. on the other hand, prime numbers that are 3 above a multiple of 4, like 3,  or 7, or 11, these guys cannot be factored further inside the gaussian integers. not only are they primes in the normal numbers,  but they're also gaussian primes, unsplittable even when i is in the picture. and this corresponds with the fact that a ring whose radius is the  square root of one of those primes will never hit any lattice points. and this pattern right here is the regularity within  prime numbers that we're going to ultimately exploit. and in a later video, i might explain why on earth this is true,  why a prime number's remainder when divided by 4 has anything to do  with whether or not it factors inside the gaussian integers, or,  said differently, whether or not it can be expressed as the sum of two squares. but here, and now, we'll just have to take it as a given. the prime number 2, by the way, is a little special, because it does factor,  you can write it as 1 plus i times 1 minus i, but these two gaussian primes are a 90  degree rotation away from each other, so you can multiply one of them by i to get  the other. and that fact is going to make us want to treat the prime number 2 a little bit  differently for where all of this stuff is going,  so just keep that in the back of your mind. remember, our goal here is to count how many lattice points are a  given distance away from the origin, and doing this systematically  for all distances square root of n can lead us to a formula for pi. and counting the number of lattice points with a given magnitude,  like square root of 25, is the same as asking how many gaussian integers  have the special property that multiplying them by their complex conjugate gives you 25. so here's the recipe for finding all gaussian integers that have this property. step 1, factor 25, which inside the ordinary integers looks like 5 squared,  but since 5 factors even further, as 2 plus i times 2 minus i,  25 breaks down as these four gaussian primes. step 2, organize these into two different columns,  with conjugate pairs sitting right next to each other. and once you do that, multiply what's in each column,  and you'll come out with two different gaussian integers on the bottom. and because everything on the right is a conjugate with everything on the left,  what comes out is going to be a complex conjugate pair which multiplies to 25. picking an arbitrary standard, let's say that the  product from that left column is the output of our recipe. now notice, there are three choices for how you  can divvy up the primes that can affect this output. pictured right here, both copies of 2 plus i are in the left column,  and that gives us the product 3 plus 4i. you could also have chosen to have only one copy of 2 plus i in this left column,  in which case the product would be 5. or you could have both copies of 2 plus i in that right column,  in which case the output of our recipe would have been 3 minus 4i. and those three possible outputs are all different  lattice points on a circle with radius square root of 25. but why does this recipe not yet capture all 12 of the lattice points? remember how i mentioned that a factorization into gaussian primes can  look different if you multiply some of them by i or negative 1, negative i? in this case, you could write the factorization of 25 differently,  maybe splitting up one of those fives as negative 1 plus 2i times negative 1 minus 2i. and if you do that, running through the same recipe, it can affect the result. you'll get a different product out of that left column. but the only effect that this is going to have is to multiply that total output by i,  or negative 1, or negative i. so as a final step for our recipe, let's say that you have to make one of four choices. take that product from the left column and choose to multiply it by 1, i, negative 1,  or negative i, corresponding to rotations that are some multiple of 90 degrees. that will account for all 12 different ways of constructing  a gaussian integer whose product with its own conjugate is 25. this process is a little complicated, so i think the best way  to get a feel for it is to just try it out with more examples. let's say instead we were looking at 125, which is 5 cubed. in that case, we would have four different choices for how  to divvy up the prime conjugate pairs into these two columns. you can either have zero copies of 2 plus i in the left column,  one copy in there, two copies in there, or all three of them in that left column. those four choices multiplied by the final four choices of multiplying the product from  the left column by 1, or by i, or negative 1, or negative i,  would suggest that there are a total of 16 lattice points a distance square root of  125 away from the origin. and indeed, if you draw that circle out and count,  what you'll find is that it hits exactly 16 lattice points. but what if you introduce a factor like 3, which doesn't  break down as the product of two conjugate gaussian primes? well that really mucks up the whole system. when you're divvying up the primes between the two columns,  there's no way that you can split up this 3. no matter where you put it, it leaves the columns imbalanced. and what that means is that when you take the product of all of the  numbers in each column, you're not going to end up with a conjugate pair. so for a number like this, 3 times 5 cubed, which is 375,  there's actually no lattice point that you'll hit. no gaussian integer whose product with its own conjugate gives you 375. however, if you introduce a second factor of 3, then you have an option. you can throw one 3 in the left column, and the other 3 in the right column. since 3 is its own complex conjugate, this leaves things balanced,  in the sense that the product of the left and right columns will indeed be a complex  conjugate pair. but it doesn't add any new options. there's still going to be a total of 4 choices for how to divvy up those factors of 5,  multiplied by the final 4 choices of multiplying by 1, i, negative 1, or negative i. so just like the square root of 125 circle, this guy is  also going to end up hitting exactly 16 lattice points. let's just sum up where we are. when you're counting up how many lattice points lie on a circle  with a radius square root of n, the first step is to factor n. and for prime numbers like 5, or 13, or 17, which factor further into a  complex conjugate pair of gaussian primes, the number of choices they give  you will always be one more than the exponent that shows up with that factor. on the other hand, for prime factors like 3, or 7, or 11,  which are already gaussian primes and cannot be split,  if they show up with an even power, you have one and only one choice  with what to do with them. but if it's an odd exponent, you're screwed, and you just have zero choices. and always, no matter what, you have those final 4 choices at the end. by the way, i do think that this process right  here is the most complicated part of the video. it took me a couple times to think through that, yes,  this is a valid way to count lattice points, so don't be shy  if you want to pause and scribble things down to get a feel for it. the one last thing to mention about this recipe is how factors of 2 affect the count. if your number is even, then that factor of 2 breaks down as 1 plus i times 1 minus i. so you can divvy up that complex conjugate pair between the two columns. and at first, it might look like this doubles your options,  depending on how you choose to place those two gaussian primes between the columns. however, since multiplying one of these guys by i gives you the other one,  when you swap them between the columns, the effect that that has on the  output from the left column is to just multiply it by i, or by negative i. so that's actually redundant with the final step,  where we take the product of this left column and choose to multiply it by either 1,  i, negative 1, or negative i. what this means is that a factor of 2, or any power of 2,  doesn't actually change the count at all. it doesn't hurt, but it doesn't help. for example, a circle with radius square root of 5 hits 8 lattice points. and if you grow that radius to square root of 10, then you also hit 8 lattice points. and square root of 20 also hits 8 lattice points, as does square root of 40. factors of 2 just don't make a difference. now what's about to happen is number theory at its best. we have this complicated recipe telling us how many lattice points sit on a circle  with radius square root of n, and it depends on the prime factorization of n. to turn this into something simpler, something we can actually deal with,  we're going to exploit the regularity of primes that those which are  1 above a multiple of 4 split into distinct gaussian prime factors,  while those that are 3 above a multiple of 4 cannot be split. to do this, let's introduce a simple function,  one which i'll label with the greek letter chi. for inputs that are 1 above a multiple of 4, the output of chi is just 1. if it takes in an input 3 above a multiple of 4, then the output of chi is negative 1. and then on all even numbers, it gives 0. so if you evaluate chi on the natural numbers, it gives this very nice cyclic pattern,  1, 0, negative 1, 0, and then repeat indefinitely. and this cyclic function chi has a very special property. it's what's called a multiplicative function. if you evaluate it on two different numbers and multiply the results,  like chi of 3 times chi of 5, it's the same as if you evaluate  chi on the product of those two numbers, in this case chi of 15. likewise, chi of 5 times chi of 5 is equal to chi of 25,  and no matter what two natural numbers you put in there, this property will hold. go ahead, try it if you want. so for our central question of counting lattice points in this way that  involves factoring a number, what i'm going to do is write down the number  of choices we have but using chi in what at first seems like a much more complicated way,  but this has the benefit of treating all prime factors equally. for each prime power, like 5 cubed, what you write down is chi  of 1 plus chi of 5 plus chi of 5 squared plus chi of 5 cubed. you add up the value of chi on all the powers of this  prime up to the one that shows up inside the factorization. in this case, since 5 is 1 above a multiple of 4, all of these are just 1,  so this sum comes out to be 4, which reflects the fact that a factor of 5 cubed  gives you 4 options for how to divvy up the two gaussian prime factors between the  columns. for a factor like 3 to the 4th, what you write down looks totally similar,  chi of 1 plus chi of 3 on and on up to chi of 3 to the 4th. but in this case, since chi of 3 is negative 1,  this sum oscillates, it goes 1 minus 1 plus 1 minus 1 plus 1. and if it's an even power, like 4 in this case,  the total sum comes out to be 1, which encapsulates the fact  that there is only one choice for what to do with those unsplittable 3's. but if it's an odd power, that sum comes out to 0,  indicating that you're screwed, you can't place that unsplittable 3. when you do this for a power of 2, what it looks like is 1 plus  0 plus 0 plus 0 on and on, since chi is always 0 on even numbers. and this reflects the fact that a factor of 2 doesn't help and it doesn't hurt,  you always have just one option for what to do with it. and as always, we keep a 4 in front to indicate that final choice of multiplying by 1,  i, negative 1, or negative i. we're getting close to the culmination now. things are starting to look organized, so take a moment,  pause and ponder, make sure everything feels good up to this point. take the number 45 as an example. this guy factors as 3 squared times 5, so the expression for  the total number of lattice points is 4 times chi of 1 plus  chi of 3 plus chi of 3 squared times chi of 1 plus chi of 5. you can think about this as 4 times the one choice for what to do with the  3's times two choices for how to divvy up the gaussian prime factors of 5. it might seem like expanding out this sum is really complicated,  because it involves all possible combinations of these prime factors. and it kind of is. however, because chi is multiplicative, each one of  those combinations corresponds to a divisor of 45. in this case, we get 4 times chi of 1 plus chi of 3 plus  chi of 5 plus chi of 9 plus chi of 15 plus chi of 45. what you'll notice is that this covers every number that divides evenly into 45,  once and only once. and it works like this for any number, there's nothing special about 45. and that to me is pretty interesting, and i think wholly unexpected. this question of counting the number of lattice points a distance  square root of n away from the origin, involves adding up the  value of this relatively simple function over all the divisors of n. to bring it all together, remember why we're doing this. the total number of lattice points inside a big circle  with radius r should be about pi times r squared. but on the other hand, we can count those same lattice points by looking  through all of the numbers n between 0 and r squared,  and counting how many lattice points are a distance square root of n from the origin. let's go ahead and just ignore that origin dot with radius 0,  it doesn't really follow the pattern of the rest,  and one little dot isn't going to make a difference as we let r grow towards infinity. now from all of this gaussian integer and factoring and chi function  stuff that we've been doing, the answer for each n looks like adding  up the value of chi on every divisor of n, and then multiplying by 4. and for now let's just take that 4 and put it in the corner,  and remember to bring it back later. at first, adding up the values for each one of these rows seems super random, right? i mean, numbers with a lot of factors have a lot of divisors,  whereas prime numbers will always only have two divisors. so it initially seems like you would have to have perfect knowledge  of the distribution of primes to get anything useful out of this. but if instead you organize these into columns, the puzzle starts to fit together. how many numbers between 1 and r2 have 1 as a divisor? all of them.  so our sum should include r2 times chi of 1. how many of them have 2 as a divisor? well, all of them. so our sum should include r squared times chi of 1. how many of them have 2 as a divisor? well, about half of them. so that would account for about r squared over 2 times chi of 2. about a third of these rows have chi of 3, so we  can put in r squared divided by 3 times chi of 3. and keep in mind we're being approximate since r squared might not perfectly  divide 2 or 3, but as r grows towards infinity, this approximation will get better. and when you keep going like this, you get a pretty  organized expression for the total number of lattice points. and if you factor out that r squared and then bring back the 4 that needs  to be multiplied in, what it means is that the total number of lattice points  inside this big circle is approximately 4 times r squared times this sum. and because chi is 0 on every even number, and it oscillates between 1 and negative 1 for  odd numbers, this sum looks like 1 minus 1 third plus a fifth minus 1 seventh and so on. and this is exactly what we wanted. what we have here is an alternate expression for the total number of lattice  points inside a big circle, which we know should be around pi times r squared. and the bigger r is, the more accurate both of these estimates are,  so the percent error between the left-hand side and the right-hand side can get  arbitrarily small. so divide out by that r squared, and this gives  us an infinite sum that should converge to pi. and keep in mind, i just think this is really cool. the reason that this sum came out to be so simple,  requiring relatively low information to describe,  ultimately stems from the regular pattern and how prime numbers  factor inside the gaussian integers. if you're curious, there are two main branches of number theory,  algebraic number theory and analytic number theory. very loosely speaking, the former deals with new number systems,  things like these gaussian integers that you and i looked at, and a lot more. and the latter deals with things like the riemann zeta function,  or its cousins, called l-functions, which involve multiplicative  functions like this central character chi from our story. and the path that we just walked is a little glimpse at where those two fields intersect. and both of these are pretty heavy-duty fields  with a lot of active research and unsolved problems. so if all this feels like something that takes time to mentally digest,  like there's more patterns to be uncovered and understood, it's because it is,  and there are.