aladdin for super nintendo was one of my favorite games as a kid unfortunately i was too bad at video games to ever finish it so to avenge my childhood i hacked this game to get infinite lives so i never lose unlimited apples to throw out the bad guys skipped to the final stage to defeat jafar and finally beat the game now this channel is about programming and software security so you're probably wondering why i'm even making this video well there's actually a ton of overlap between software security and game hacking to hack games you need to do a little bit of reverse engineering to figure out how the game works it's about potential vulnerabilities and then make in-memory patches to the game to do your evil cheating this is exactly how we started and gave aladdin 99 apples when the game starts you start with 10 apples the developers at capcom probably used a variable somewhere to store the current amount of apples so in theory all we have to do is search for the number 10 in the game's memory change it to 99 and boom 99 apples but there's a problem the super nintendo has a 24-bit addressable memory space meaning that when i search for the number 10 in memory i find a lot of tense and there's no way i can go through and edit all these tens to guess which one is correct and if i edit some of them they may break the game but then i realized when i throw an apple the number of the variable decreases by one so what if i can find an address whose value is nine now but whose value used to be 10 and sure enough we find two addresses that have this property and when i change this value boom we get more apples infinite apple hack unlocked i beat level 1 with my infinite apple hack and at the end of the level the game gave me a passcode that's when i realized i totally forgot about a major part of this game games in the 90s didn't have a lot of room for space to save the game so instead they would give you a passcode at the end of a level that you could use to skip to where you left off so if we could figure out how to break the passcode screen we can teleport to the last level of the game beat jafar and my father would finally be proud of my passcode screen was pretty straightforward use the left and right buttons to move the cursor and the up and down buttons to select a character press start and if you put in the right passcode you would teleport to that level now to break this i figured there was logic in the game that checked against a list of good passwords and if your password matched a good password in that list you went to the associated level but the question was what did a password look like in the game's memory to solve this we took the infinite apple hack approach my thoughts were that with the cursor on the left side of the screen the index for the cursor variable was either 0 or 3 assuming zero indexing and then when i moved it one to the right the cursor index would become either one or two using the basic process of elimination i found the address that directly corresponded to the position of my cursor and sure enough when i changed the characters in the passcode field the variables in the other addresses adjacent to the cursor changed too the four bytes immediately after were the reverse order of the password on the screen here i learned the characters and the passcode screen had the following values aladdin was zero jasmine was one genie is two abu is three soul ten is four and is five now again do not forget why we're here we must defeat jafar so i can finally sleep at night when i beat level 1 i was given this passcode the passcode is genie abu aladdin sultan which when i put it into the game it corresponds in memory to the passcode 2304 which is my passcode in reverse in memory now if my logic before was correct there is a table of passwords in memory that has all of the correct passwords and we can use the last password in that list to teleport to the end of the game and finally defeat jafar forever now searching for the string four zero three two in memory we found something very promising a long list of values starting with our magic string the first password whose values all did not go over five by not going over five and ensure that it is most likely a list of passwords that correspond to the characters in the game and at the end of this list there it was what may just be the passcode to the final level four three one zero now based on what we found before about the characters this passcode corresponds to aladdin jasmine abu sultan now what i could do is put the characters into the passcode screen like you're supposed to but that would be boring this is a hacking video so instead i decided to inject the values into the passcode screen using the memory editor directly press enter i should get teleported to the final level hold on foreign [music] yes all right got it god it feels so [ __ ] good to win oh my god i gotta pee again i'll be right back but then i realized i hadn't even solved the hard problem yet again the whole point of this video is that i am really bad at video games i mean really bad like even just getting the footage for this video when i killed jafar i died like three times like literally i have the footage of me dying to this boss over and over and over again after wasting literally an hour trying to defeat jafar by myself i had to take a step back and look at the drawing board i was messing around with the heart's value in the game to figure out if there was a way to give myself infinite hearts and i couldn't figure out how to set the value above the 10 that you were allowed without breaking the game i also experimented with setting the value to zero to try to kill aladdin to see if that affected the logic at all you're probably thinking that setting the value to zero is going to kill me but actually something much more interesting happens instead when i set the heart value to zero the game is subtracted one when i hit an enemy and created what is known as an integer underflow because the value was zero in memory and i subtracted one from it it wrapped around all the way to the max value of a byte and gave me 255 hearts now while this did break the rendering of the game i was finally prepared to turn to jafar and beat him for the last time it's time to end this once and for all we go to the password screen let's look for our password in memory password in memory put in four three one zero boom hit the enter key final level here we come now we need to inject the infinite life hack by setting our lives equal to zero so that it wraps around and gives us infinite live to set our hearts equal to all zero the logic will flip that around so now we have zero hearts left you son of a [ __ ] it's been 30 years 30 years well 20 25 ish let's do it see we got hit but now we have 255 hearts easy easy one hit three hits oh god oh jesus hit him again four hits five hits one more it's gotta be it right oh dude how many lives do you have jesus come on let's go that's what i thought man 25 years later i finally beat your ass only had to completely hack this game to do it but you know all's well that ends well something something else fair in level war all that good [ __ ] with this out of the way and genie's freedom secured there was only one thing left to do foreign wow this is awesome thanks aladdin thanks jasmine genie is that you you guys should go watch another video where i hack a different video game [music]