well, we're looking at chocolate datasets today, so i thought i'd bring some research i'm yeah, good and definitely relevant we've been looking at techniques like data visualization to try and explore our data and start to draw some initial you know conclusions or hypotheses we're going to start to move towards kind of modeling our data and actually trying to extract proper knowledge from this data because remember just because we've got data doesn't mean we've got knowledge. now. this is going to be a kind of iterative process we're going to need to clean up our data to make it as useful as possible we need to transform it so that we can combine datasets together and statistically measure our datasets and then we're going to need to reduce it sometimes if our data set is too big and unmanageable and this combination of cleaning data and transforming data and reducing data is a kind of cycle where we're going to iterate this until our data set it's a smallest most useful form it can be so if we've got redundant variables which are basically the same as others or we've got duplicates these are all problems that we need to sort out because if we're going to be analyzing data with these kinds of issues we're just making our life slightly more difficult it's computationally inefficient and you know in the worst case we could draw the wrong conclusions you might be surprised and disappointed when you get your first data set that actually it's not quite as nice as you were hoping and it's gonna need some cleaning up. maybe there's missing values maybe there's outliers that need to be dealt with because this yeah they're warping your distributions and your and your medians and means right and perhaps you also got noise in your data set right these few things we can start to address with cleaning so cleaning data is essentially the idea of trying to correct or fill in any missing values or remove those bits completely you might be surprised but there's missing data at all i mean oh, what are we not paying attention? like we've got one job and that was to collect the data and we seem to have got missing data but actually it's quite common because i mean, for example if you're if you're trying to track patient records over time maybe we didn't show up to an appointment or maybe you in a hospital when they weren't there when they needed to have their temperature taken, right and then your trend line of your temperature over time is going to be missing some values maybe you've got data going back for hundreds of years and they didn't have certain techniques and certain measurement systems back then so they only have other kinds of data so missing data is we common rye and we're gonna have to be able to deal with it so the data set we're looking at today is a kind of ratings for chocolate bars this is why ate my chocolate or at least that's why i'm telling myself so we'll read the data in we've got ten different variables we've got about 1,700 nearly observations and let's have a quick look using the summary so we've got things like the company would produce for chocolate the name of the chocolate reviews the cocoa percentage the type of being this kind of information right and you can imagine what you might do if you were trying to produce better chocolate it's a look at a huge amount of this kind of data and work out what it is that customers like and what it is they don't like but this is going to be quite common in market research so the first thing we're going to do right we've we've received this data we know now what the columns are, but we don't really know anything else other than this so we're going to have to start looking through and seeing first of all, is there any missing data? so we're going to use the s supply function for this the s supply function will apply a function over our data set so for each column or each attribute of our data we're going to apply this and the function we're going to use we're lighting ourselves so it's going to be the sum for any time where our item is either blank or na now blank means an empty string and na means literally not applicable right, which is something that comes up in data from time to time alright, so in any case both of these are missing values and so we're going to treat them both the same so if we apply this to our chocolate data set then we're going to see that for example, there are eight missing names there are seven missing review dates and there are four missing coco percentages so for each row in our data, there are four rows where the coco percent is missing right now that's not too bad for i mean, this is as data set of nearly 1,700 items for it's not too bad that's quite quite expected you might imagine that if you're pooling this data from lots of different sources people are going to forget to add datum in or they weren't able to record data on that day there's a huge amount of reasons why you might have missing data and now it starts to become a little bit of a problem when we look at things like bean type because bean type has got 1200 missing values that's a huge proportion of a data set. and in that case we might have to do something about this so the only issue we've got is that 1200 is not relish. it's just an amount of rows it's not relative to the of a data set. so we're going to use the exact same function any empty rows but this time we're going to divide by the total number of rows so we can get a percentage for how much of a missing data we've got so we can see for example but company name has zero missing data. whereas beam type has 74 percent missing data so that's a huge problem now a kind of general rule of thumb is if you've got over half your data is missing it's going to be quite hard to estimate or guess what that data is going to be that's when you might want to start thinking about removing it. so what we want to do is we want to extract any of the names of any of our attributes that have this sort of over let's say 60% missing all right so we're going to start by calculating always percentages and saving them in a variable and then we're going to select only those percentages where the value is over point 6 right 60 percent? so we're gonna say any attribute where the attribute is over point 6 and that is just being typed at point 7 for right or 74% so we can now delete beam type ourselves so we could say something like chaco all the rows for being type is null and by setting that to nah, that's just going to delete that column we can also do it automatically so we could actually pass in those attributes that we just calculated as a parameter so that would be this line here so be something like chaco all rows that's here the names of any attributes where the percentage missing is greater than 0.6. and that's going to just delete being type right? it's not a lot we can do about being type we've only got 25% issue of a data. it's not enough to start guessing what beam types are going to be in other chocolate bars? let's have a look at now our rows of data voters for each instance they're going to have a number of attributes now there's 9 left and we want really to keep the instances that have the majority of their data, right? so we're gonna apply my so this is going to be row wise to dimension 1 so that's the rows we're gonna count any of it a blank or n/a? for each row over our data set and we're going to put this into missing so what it is going to do is return a list of values for every single row but tells you how many missing items are there in that rug so we can now look at the first few missing items, so we're going to order them right by larges first and then we're going to show just the first few and you can see but actually some of them are missing seven and six attributes. that's quite a serious situation because it was only nine lights only only got a couple of entries in their fields now let's do this again as a percentage of the number of attributes so this is exactly the same thing but this time we're dividing by the number of columns which is nine and we're going to have a look at the top of these and so you can see that we're missing 77% of some of these initial attributes that's a real problem missing is the same length as the number of rows we've got so we can actually look up any rows where there's a greater percentage of missing values and we want and just remove them from the data set so what we're going to do that is a bit like this. so there's a choco is choco, anywhere. we're missing is less than or point seven and then all the columns and what that's going to do is select only the rows we want where they've got a nice amount of data so machaca dataset is going to be a little bit smaller now, but much more useful to us we don't really want to be trying to do things like machine learning or statistics when 70% of some of the data is missing right, that isn't going to be a good idea. so it's quite easy just to delete data, right? i mean in some sense, it's just more convenient to do that in general the rule is that if you've got more than 50 or 60% missing data, it's a good idea to delete it, right? delete are the instances or the attributes depending on how much data you've got missing and where if you're missing a huge amount of data then you're not going to be able to recreate it by let's say using an average, right? we've got so little later that an average isn't going to be reliable if we have got sufficient data that we could maybe start to infer what these missing values might be we can start to try and replace them instead of deleting them so what we might do is we might for example set them all to zero maybe if an attribute is missing we can say well, okay if it's missing, we'll just not use it and we'll say it's zero now whether you do that it's going to depend on what the attribute is. something zero is not a useful property right and we'll look at that in the chocolate dataset in a moment what we might also do is we might start to add the data set mean into those attributes so maybe we don't know what the rating for this chocolate bar is but we can guess but it's going to be around the average rating for any chocolate bar again. this is going to depend on your situation, right? you're still making up datum in some sense you've got to be very careful about what you do here. so we've deleted as much of our chakra data as we feel comfortable doing now. let's see if we can fill in some of missing values with appropriate replacements. so let's have a look at our attributes alright, so we've got company name reference things like this being tab has been removed but we still got things like the bean origin and the ratings and there's a few of these missing from our data set can we estimate these rather than completely removing them from the data set? obviously the less data you use for less useful things like machine learning are going to be so let's look at an attribute and see what we can do so if we look at bar price, i bats the price of each chocolate bar we can see that there's a few missing values somewhere around 3% that's something we want to deal with but we've got enough data, you know 97% maybe we can start to guess what the prices of these chocolate bars might be now this is a good instance of a time when you wouldn't want to just populate with zeros, right? no chocolate bar is free i wish and so what we need to do is produce a reliable value to represent an unknown price rather than just setting them all to be zero so what we could do here is something like this we could set every missing bar price to be the average of all the chocolate bar prices and that way at least we're not warping our distribution up or down we're keeping it exactly the same. we're gonna say for the chocolate data set for any row where bar price is n/a and for all columns? we're going to set the bar price to be the mean of all the bar prices and we're gonna obviously remove any na s from that calculation of what it's not going to work and that's already worked. so now if we recalculate our missing values, you'll see that bar price now has zero missing values so we've fixed that problem great. so that was quite an easy one right bar pie seems to me to be quite an intuitive time when you would just calculate an average and put it in right now actually, maybe not because you know bar price might depend on where in the world we're selling it or you know, what company is producing the chocolate bar so could we do the same thing for rating if we look if we take the sum of all the na values in rating? it's eight like so there are eight chocolate bars for which there is no rating so what we can do is we could do something called a stratified replacement we could say well, let's group our chocolate bars by country or by company calculate those averages and then we can specifically fill in companies missing ratings based on what that company actually show in the market rather than just an average over everything so what we're going to do is we're going to calculate an aggregate function over of the ratings by company and we're going to calculate a median median is a little bit more robust to outliers so maybe you make up a very very expensive or very very cheap line. the median will get what middle value is, right? so this is going to be per company and we can set the columns to be a little bit more helpful using coal names and so now our per company if we look at it is each company and the median rating of chocolate bar form i think one to five your fingers data set is going so now we know that data per company we can actually fill those in now. you could automate this process. we don't have much missing data so let's just show an example of doing it by hand so this is the line of code we're going to do and i'll talk through it so we're going to say for the chocolate data set for any value where the chocolate rating is n/a for missing, right? and the company is vai kuna we want to set the rating to be equal to the vikon entry in our new per company average or median and that's going to fill in that value there so we do this for all the missing companies and what we're going to find is that we've replaced all our missing values with appropriate medians for those ratings per company. so the last thing we might find in our data is outliers so let's imagine we do a box plot of cocoa percentage, right? so i'm going to produce a box plot of a cocoa percentage now, maybe our assumption is that cocoa percentage in some way? informs what the rating is going to be because maybe a higher cocoa percentage tastes nicer. i don't really know about chocolate so if we look at this box plot what we'll see is we've got actually quite a tight distribution of cocoa percentage right between about 50% and just above 80% but you can see there are three outliers when it produces a box plot or i will show outliers is anything that is more than three standard? deviations away from the median what we do with these outliers is going to be a judgment call it's going to depend on a situation so, for example, we have an outlier here, which is above a hundred percent now that makes no sense we can't have a chocolate bar with more than a hundred percent. cocoa, right doesn't make sense so that is obviously a mistake. we would delete that item right and probably delete the whole row or we estimate that value based on a stratified average or a different average for these lower ones this is a judgment call one is just above 20 and one is up closer to 30% i don't know whether those of outliers or not, right? is it possible to make a viable chocolate bar with 20% cocoa? i mean it may be right you're going to have to know a little bit something about your the situation but your data was collected in and whether that's reasonable so you might for example, delete the bottom one as a mistake but keep the top one because that's just a low amount of cocoa. so this is what cleaning data is about we're going to have missing data we're going to have outliers we might have noise and you're going to have to look for your data and try and condense it and remove all these problems we do this so that we can more effectively transform our data later and also reduce our data if we need to and then eventually your datasets going to be really nice so that we can do things like modeling or machine learning on it my fuel economy is messaging miles per gallon, but of course, i don't pump fuel in my in gallons i pump it in liters and then but when i run anywhere so short distances i run in kilometers and i run in kilometers per hour so i'm using two different systems there