people need to learn to use standardized measures for things. so take me for example when i drive anywhere i driving miles i drive in miles per hour my fuel economy is messaging miles per gallon, but of course, i don't pump fuel in my in gallons i pump it in liters and then but when i run anywhere so short distances i run in kilometres and i run in kilometers per hour so i'm using two different systems there and any short distances. i'm measuring are going to be in meat. it's not feet, right so if i'm measuring let's say around my house for painting i'm going to measure in square meters so i know how much paint to buy but then if i'm selling a house, or i'm buying a house i'm going to be looking at the size of the house in square feet again. what who knows why british people? if i'm baking anything, it's going to be weight in grams or kilograms going into the recipe but if i'm weighing myself is going to be in stones and pounds but of course a ton would for me would be a metric tonne not an imperial time and as i said, i measure fuel in litres and most of my liquids are measured in liters except for coarse for beer and milk which are in pints? so this is the kind of problem you're going to be dealing with when you're looking at data. you're trying to transform your data into a usable form maybe the data is coming from different sources none of it goes together. you need standardized units standardized scales so we can go on and analyze it let's think back we what we're doing is we're trying to prepare our data into a densest most clean format so that we can apply modeling or machine learning or some kind of statistical test to work out what's going on and draw knowledge from our data. so this is going to be an iterative process we're going to be cleaning the data we're going to transform the data and then we're going to reduce for data and transforming data is what we're going to do today so let's imagine that you've cleaned your data. so we've got rid of as many missing variables as possible hopefully all of them with deleted instances and attributes that just we're not going to work out for us now what we're going to try and do is we're going to try and transform our data so that everything's on the same scale everything makes sense together and if we're bringing datasets from different places we need to also make sure what the units are the same and everything makes sense there's no point in trying to use machine learning or sum or clustering or any other mechanism to draw knowledge from our data if our data is is all wrong so today we're going to be looking at census data now census data is kind of a classic example of a kind of data you might look at in data analysis. it's got lots of different kinds of attributes things that are going to need cleaning up and transforming so we're back in our we're going to read the census data using census is read csv so we've downloaded some census data that represents samples from the us population to begin with we're going to read that in and you can see that we've got 32,000 observations and 15 attributes or variables so what are the first timers so let's have a quick look at just a little bit of it and we can see the kind of thing. we're looking at so we're going to say head of census and that's just going to produce the first few rows so we can kind of see the kind of data so you can see we've got age we've got what working classification that person has their educational level a numerical representation about whether they're married or not this kind of thing so there's a lot of different kinds of data here some of its going to be nominal so for example, this working-class state government private employee. that's a nominal value we might have ordinal values or ratio values or interval values all right we're gonna have to delve in a little bit closer to find out what these are now what we do to transform this data into a usable format for clustering or machine learning it's going to depend on exactly what these types of these columns are and what we want to do with them so let's look at it just a couple of the attributes and see what we can do with them, right? we're going to use a process called codification the idea is that may be things like random forests or multi-layer perceptrons, you know neural networks aren't going to be very amenable to putting in text-based inputs and what we want to do is try and replace these attributes with a numerical score all right so let's look at just for example of a working class and also for example the educational level so education now work class is the kind of class of worker that we're looking at here so for example a state worker or in private sector or someone that worked in a school or something like this now this is a nominal value. that means there's no order to this data at all we can't say but someone in state is higher or lower than someone in private and we can't also say but let's say state is two times more or less than some other one. that makes no sense at all so what we can't we can replace this with numbers? so let's say we could replace private with zero and state with one and you know self-employed with two and so on right and that week that's perfectly reasonable thing to do, but it's still nominal data so what we can't do is then calculate a mean and say are the mean is halfway between private and public that doesn't make any sense just because something has been replaced by a numerical score doesn't mean that it actually represents something that we can quantify in that way right? it's still nominal data okay, so i bet the best advice i can give is feel free to codify your data into easy-to-read numbers but just bear in mind that you can calculate the mode just like you know the most common but you can't calculate the median and you can't calculate the mean another example would be something like the educational level now fear letting me this is ordinal data so we could save it someone with a an undergraduate degree it's maybe slightly higher in terms of their the amount of time. they spent in education, but someone with a high school diploma but we don't know exactly what the distance is and what's the distance between let's say a high school when a degree and then a phd? and so on an md and things like this we can represent these using numbers and probably in order right so we could say that zero is no education and one is sort of the end of primary school and two is the end of high school and so on and so forth but again, it's difficult to calculate distances between these things we don't know what high school is two times more than primary school and half of a degree or something like that that doesn't really make sense so again, you might be able to calculate a median on this or a mode, but you can't calculate an average you can't say the average level of ocation. it's halfway between high school and undergraduate that doesn't make any sense either so for any kind of attribute that is nominal or possibly ordinal and it's sort of represented using text we can codify this so but it's more amenable to things like decision trees depending on the library you're using right? but you just have to be careful all machine learning algorithms will take any number you give them and you just have to be careful that this makes sense to do so what you would do is you would go through your data and you'd begin to systematically replace appropriate attributes with numerical versions of themselves remembering all the time, but they don't necessarily represent true numbers, you know in a ratio or interval format so for any text-based value, we're going to start with places and possibly with numerical scores. what about the numerical values? well, they might be okay, but the issue is going to be one of scale you might find for example in this census data that one of the dimensions or one of the attributes is much much larger than another one. so for example, this data set has hours per week which is obviously going to be somewhere between naught and maybe 60 or 70 hours for someone that's got you know a very strong work ethic and salary right or salary or income or any other measure of you know? monetary gain now obviously hours per week is going to be in the tens and salary could be into the tens of thousands. maybe even the hundreds of thousands those scales are not even close to being the same. that means if you're doing clustering or machine learning on this kind of data you're going to be finding the salary is kind of overbearing everything, right? so it's going to be very easy for your clustering to find differences in salary and it's harder for it to spot differences in hours because they're so small in comparison right. so we need to start to bring everything onto the same scale the more attributes you have which is another way of saying the more dimensions you have to your data then the further everything is going to be spread around if we can scale all of these values to between sort of let's say around 0 & 1 then everything gets more tightly sort of controlled in the middle and so it gets much easier to do clustering or machine learning or any kind of analysis we want so let's look back at our data and see what we can do to try and scale some of this into the right range so we're going to look back at the head of our data again so our numerical values are things like the capital gain the capital loss which i guess zuma bleah how much money they've made in the loss that year probably for normal license on some scale and then things like the hours per week that they work and their salary which at this case is rate of an or less than 50,000. so let's have a quick look at the kind of range of values we're looking at here so we can see if scalings even necessary maybe we got lucky and the person did it before they sent us the data so we're going to apply a function across all the columns and we're going to calculate the range of the data so this is going to be apply on a census data division, too so that's all of our columns and we're going to use the range function for this and this is going to tell us okay so for example the age ranges from 17 to 90 the educational level from 1 to 16 it gives you the range for things like nominal values as well, but they don't really make any sense i mean working class ranges from question mark to without pay, you know is meaningless and then so for example capital gain ranges from zero to nearly one hundred thousand and capital loss from zero to four thousand and finally the hours per week main gist from 1 to 99 so you can see that the capital gain is many orders of magnitude larger in scale than the hours per week we're going to need to try and scale this data. well begin by doing to make our lives a little bit easier it's just focus on the numerical attributes, right so we'd have to worry about the nominal values, which we've not codified yet we're going to select all the columns from the data where they are numeric. so that's this line here a star then down here so we're going to s apply that applies over each of the fields is it numeric and that's going to give us a logical list that says true or false depending on whether those columns are numeric what we're doing here is selecting from this list any bit of true and then finding their name so what are the names of a columns for the numeric? so let's have a look at just a range of these attributes to make a life a little bit easier so i'm gonna run this line and so this is a simplified version of what i was just showing you can see that capital gain is massive compared to the hours per week for example let's have a look at the standard deviation the call that the standard deviation is the average distance from the mean so it kinda gives us an idea of the spread of some data like is it very tight and everyone owns roughly the same or is it very spread out and it's huge deviations and the answer is there's pretty huge deviations. so the age has a standard deviation of 13 so it obviously that means that most people are going to be kind of in the middle and on average they're going to be 13 years younger or older, but you can see that things like capital gain have a 7,000 standard deviation, which is a huge amount to give you some idea what we're aiming for it's very common to standardize this kind of data. so but the standard deviation is 1 right so 7,000 much too big let's plot an example but gives you some idea of what the kind of problem is when we have these massive ranges, so i'm going to plot here a graph of age vs. capital games, right? we know age goes between about one and a hundred and capital gain is much much larger so if i run this basically the figure makes no sense at all because the capital gain ranges from zero to one hundred thousand and as a few people earning right at the top scale, everything is sort of squished down the bottom. we can't see anything that's going on. there's no way of telling whether the capital gain of an individual is related to their age i mean it probably is like because a retired people people who are very young. perhaps her and slightly less we can't really see that here because it's just too compressed, right? we need to start trying to bring these things together so that we can perform better analysis what we're going to do is create a new data frame with just the numerical attribute so we want to focus on just to make our life a little bit easier and then we're going to write a normalized function to move all our data to between 0 and 1 and we will do this per attribute so for example if you've got some data which goes between a minimum and a maximum and we want to scale this data to between 0 and 1 all we need to do is first of all take away the minimum and that's going to move everything to be from 0 to max minus min and then we're going to divide by this distance here so this is max minus min. and if we divide by this everything is going to go from 0 to 1 so that's exactly what we're doing in this function here we've got a function x and it subtracts the minimum of x and then divides by the difference between the maximum and the minimum all right. so this is very standard. so i'm going to run this. i'll let you write functions like this and then use them in applications over data, so we're going to calculate a normalized census data set which is we're going to apply over dimension to this normalized function we just wrote and then now if we look at the range will see that our range is now between 0 and 1 for all of our data, which is exactly what we want the normalization is a perfectly good way of handling your data if everything is between 0 and 1 we have fewer problems with the scale of things being way off now some statistical techniques like pca that we're going to talk video they require standardized data that's data, but it's centered around zero it has a mean of zero and a standard deviation of one now. we can standardize data pretty easily in the same way actually, we don't need to write our own function for this the scale function in our performs this force so we're going to take the census data over numerical attributes and we're going to call the scale function and that's going to take all of the attributes and center them around their mean so that means the mean will become close to zero and it's going to divide them all by the standard deviation so their standard deviation becomes one so if we run that and then we have a look at the mean of this data so for example here, we calculate the mean you can see that i mean these values are very very close to one that's 10 to the minus 17 or something like that very very small and if we look at the standard deviation similarly, they're all going to be 1. all right, so this is now standardized data this is a very good thing to do if you want to use your data in some kind of machine learning algorithm or some kind of clustering let's imagine now that we want to join some data sets together so we standardize data everything's between 0 and 1 or it's centered around 0 with a standard deviation of 1 we've codified some attributes what happens if we get other data from other sources, you can imagine that census data from the us might be a bit useful but maybe we want census data from spain or from the uk or from another country can we join organs together to get a bigger more useful data set? now the thing to think about when you're doing this is just to make sure that everything makes sense right are the scales the same are they all normalized or none of them normalized? because otherwise, what you're going to be doing is you're going to be adding, you know pay between naught and a hundred thousand to somewhere between no and one nothing makes any sense anymore you're gonna wreck your data. so let's have a look at this on the census data set we have some spanish census data in a very similar format to our census data from the united states let's have a quick look so i'm going to read the csv file of spain data let's remind ourselves of the columns that we had in our census data from the united states. these are the numerical columns so we have age education number capital gain capital loss this kind of thing let's look at the spanish data set to see if we can just join the two together so i'm gonna run head spain that's going to give us the first few rows and you can see that there's some of the stuff in there is as it was before so things like what their level of education is whether they work in the private sector or the public sector why we're going to need to remove these things to create just a numerical attributes and the other problem is if you look carefully you'll see that the capital gain in the spanish dataset is in euros not in dollars now, that's a huge problem they don't they're not nationally different obviously they're on the same order of magnitude but we don't want to be jamming capital gain in euros next to dollars because those two scales are not the same, right? so what we need to do first is scale this data using some kind of exchange rate so here what we're going to do is we're going to create a new column in spain so given a spain data frame we're going to say the spain capital gain is equal to the euro capital gain times by 1.1 3, which is the exchange rate. we're going to use now it's quite important in this kind of situation. not just to look up the exchange rate online you've got to consider but this might have been collected a while ago what was the exchange rate when this data was collected why these are things you're going to have to think about? so let's run that line and let's do the same thing for the capital loss now we're going to keep just for numerical attributes of our census data and of the spanish data and we're also going to add another column. that is what country they come from otherwise we're not going to know so we're going to use the columbine function to combine the census data as numerical attributes and the native country which in this case will be the united states we're going to do the exact same thing for the spain data, which will be basically exactly the same except obviously we're also going to have spain as the native country and then we're going to use the roe bind feature to just join those two tables together now that will only work if those two datasets have the exact same attributes new sense is not found what did i do wrong? so i had a typo? so let's join these two together using our bind there we go. and so our united dataset now has the combined observations for the united states and spain now what you wouldn't want to do is just join them together and just leave it at that why you want to perhaps have a little look at some plots to make sure that the distributions of the data. you've just joined together make sense. for example right. thus the united states data has a nice broad distribution of different ages we want to make sure that the spanish data has that same distribution otherwise, you're kind of going to secure your data set so for example let's have a look at roughly whether the levels of capital gain are approximately the same for both the united states and the spanish data set so i'm gonna use ggplot for this we're gonna plot a bar chart where we've color-coded united states and spain and you can see that broadly speaking there's a lot in the kind of around zero or less than 50k and then there's a few a little bit above all right, so that looks broadly speaking the same distribution. i'm fairly happy with that this is gonna be a judgement call when you get your own data so i'll clear the screen and then let's have a look at the next plot so the next plot is going to be capital loss versus the native country. let's make sure those distributions are the same so it's posting there and broadly speaking again yes the majority are down the bottom and then there's a few united states ones and a couple of spanish ones up at the top as well again, it's not a disaster. that's probably ok. finally, let's have a look at ages by native country so if we plot this we can see two very very similar distributions you can see that it's essentially a bell curve. maybe slightly skewed towards older participants for the united states and very very similar for spain. this is okay. if we hypothesized that capital gain capital loss and salary was something to do with your age then it would make sense to have two data sets that you're joining together have very similar distributions in this regard so let's look at one more data set from denmark. all right, so it's the same thing same format we're gonna read the csv and we're going to have a look at just the top few rows to make sure it's in the same format, so that's using a head function and you can see actually we've already removed the nominal and other text attributes from here and we've just got the numerical ones and actually also capital gain and capital loss are already in dollars in this data set so we don't have to perform a conversion so we can use our bind to put these two things together and now we just need to check the distributions are the same so again we're going to put the age against the native country and see if these towards the same distributions and you actually you can see this isn't looking too good the united states and the spanish dataset have very similar distributions the participants or the people who have been polled from denmark are much much older on average, right? this could have an effect on things like capital gain, so i wouldn't necessarily feel comfortable just joining this data set in without you thinking about it a little bit more closely alright, so whenever you're joining data set like this taking data from different sources think carefully to make sure that it's fair and what you're doing is a reasonable concatenation of datasets and actually these are the features that power spotify recommender system and numerous others. so we've got things like acoustic nurse how acoustic does it sound from from a zero to a one we've got instrumental nurse? i'm not convinced as a word speech enos the hat hat to what extent is it speech or not speech and then things like ten