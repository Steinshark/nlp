dieselgate but for trains some heavyweight hardware hacking look at that that's like electronics i mean look at that look look at look at the tools you got here i think that's a leatherman right here i think we got a leatherman oscilloscope i mean this is intense okay someone's doing some real hacking here this is an english translation by the way so we may you know it may not be my reading okay this may not actually be my reading's fault this time a train manufactured by a polish company suddenly broke down during maintenance the experts were helpless the train was fine it just wouldn't run was the train fine isn't that like definitionally not being fine isn't that the literally what it means to not be fine is to not run for a trade anyways in a desperate last grasp the dragon sector team was called in to help and its members were wonders found wonders the train engineers had never dreamed of okay okay this is great in this story we'll take you on an unusual ual journey a journey full of unexpected discoveries and events is this what is this the hobbit a journey under pressure of time and money as well as unusual technologies a journey in which the trains plays the most important role although unfortunately it doesn't move sick burn even though it should fasten your train belts or at least sit comfortably because the there are some sharp turns ahead okay okay i like i like this very this is like a good soft intro i'm feeling ready winning the tender losing the service i like a good oldfashioned tender winning the story probably begins a little earlier but we will enter the scene in spring 2022 when the maintainer for the first 11 impulse 45 we trains made by polish company newag operated by the lower san ssian railways ends the maintenance is carried out by an independent trained maintenance company called sarus poou st so now i can't dude i can't you know i can't pronounce polish things like they know specifically they they knew it specifically and they put it in here hereafter referring to as sps sps won the tender to carry out the manatory maintenance of the trains after a dist let's see after a distance of 1 million kilometers the train manufacturers new egg also competed in the tender to carry out the maintenance but the manufacturer's bid was was about 750k usd higher than the tender and the tender was eventually won by sps okay which offered to carry out the maintenance of 11 trains for around one or 5.5 million usd wow that's ballsy that's crazy to try to say you're going to like it's crazy to say you're going to do maintenance on a train and then pre- say how much money you're going to do it for that just seems wild like you don't even know what you're getting yourself into i don't know that sounds it sounds it already i already like american mind can't even comprehend this already okay welcome to government contracts can't even understand this i don't understand where the shotgun or the eagle goes in this situation very confused right now welcome to trains in europe maintenance uh let's see maintenance of a train is a complicated affair i would assume so it has to be taken apart the parts sent to various manufacturers checked in sent back the train put back together again and tested the sps carries out the maintenance procedures according to the relevant maintenance manual some 20,000 pages provided by the manufacturer but the train does not start after being put together you know one time i took apart a pocket knife it was extremely difficult to put back together it was extremely difficult they rtfm 20,000 pages and nothing still worked okay i haven't written 20,000 pages of of programming documentation in my life lifetime the computer says everything is fine the train is ready to run but it does not run the inventors the inverters are not supplying voltage to the motors and no one has any idea why this is happening maintenance technician search check verify consult the manuals and they find no answers by the way i like the writing of this one it feels like it feels like like an old timey mystery novel you about to be taken on an adventure like what's called not a mystery novel it feels like the twilight zone this is the train zone you better sit down and buckle in this is very fantastic everything about this is super good all right the mysterious breakdowns the lower is it salan salan railway has 11 impulses and according to the schedule another one is about to be sent for maintenance while the first instead of returning to work is still sitting in the workshop the second train is undergoing identical maintenance with identical results before the m uhoh uhoh are we are we about to get some sabotage is that what's happening here is this sabotage is that what's happening before the maintenance it was let's see before the maintenance it was operating after the maintenance it was no longer it no longer wants to run it's just a funny way to describe a train it's just a funny it's just a funny way to it's just funny to way to say train the train just doesn't want to run anymore the work on getting the first train up and running like the train itself has not progressed 1 [music] mm while the manufacturer what's a millimeter is that like an inch while the manufacturer refuses to help two immobile trains are already sitting in the workshop the third misses its inspection due to battery failure so a fourth train from the future is sent to the maintenance instead okay one train three hackers i don't know the maintenance company wants to take advantage of the presence to tow one of those that won't run when the fourth running train is connected to one of the stationary ones the running also comes to a standstill oo that is naughty the reason for this has not yet been established okay figured because i don't know why so therefore yet it has not been established in addition at another workshop in polish town lots of consonant followed by essen another impulse breaks down in very similar circumstances it does not start up after services okay okay poland top hackers at a certain point the problem becomes serious enough to notice to be noticed by the media the six longest trains of the lower ssian railway out of service and mean that tim tables have to be reduced replacement trains have to be sent to the tracks and passengers travel in overcrowded shortened or shorter train sets new eg explains new eg sounds like new eg explains that the trains were blocked by a safety system but in the two the 20,000 pages of instructions it is in vain to even or to find even a mention of it i like this i like where this is going this is very very excited a day of train downtime in the workshop costs over a th000 usd and contractual penalties and there are several trained stuck so the tension level in the sps is rising since neither the mechanics nor the electri electricians have a solution someone set types polish hackers into google and comes across an article about dragon sector groups success successes in the ctf arena at the top results list sps makes a contact sps makes contacts with dragon sector what a great name i feel like if i were to have a hacker group i'd want like a badass name you know what i mean dragon sector what a great name what a great name whose representatives at first can't believe the proposal they hear train hacking well why not the party sign a contract dragon sector members michael mel redford kowal sick and s s q3k bazinsky known for hacking toshiba laptops take on the projects and kuba pans claus dude what what is wrong with the e there's an extra thing hanging off the e i don't know how to say these words step nwi who has experience in the industry automation joins in the team sets off briskly to work with kuba o i like a good kuba film taking a trip to to the workshop on site they get a train that doesn't move two spare computers and a computer manufacturers sdk files they start the work by tapping into the can bus but it's different to read the traffic without do or it's difficult to read the traffic without documentation of protocols that would be incredibly difficult just like just seeing ones and zeros go by and be like write that down write that write that one down we got to figure out this header first they take a long time trying to dump the embedded the embedded software from an onboard computer they have no documentation of the computer and the sdk only allows uploading new software and with no option to dump existing software as they experiment with the older version of the software they found uploading it to the first spare computer causes it to stop responding they are left with only one working spare computer eventually they find debugging interface and download the devic's memory bite by bite okay this is this sounds like actual hackers these these people like they literally live in someone's basement this is this is exciting the computer is based on the tricore architecture classic tricore architecture that we're all deeply familiar with like many similar solutions in the automotive industry unfortunately there is a lack of good dissemblers so the researchers this sounds like a emac definition just a lack of a good text editor so the researchers are improving gidra a bit and they can finally look into the code admittedly strings are missing but the work is slowly moving forward a month and a half goes by when sps passes on the bad news gidra sounds evil it does it does sound evil it sounds like something that we should all be afraid of i don't want my my info downloaded by gidra all right the lower sou sil silan railway unable to wait for its trains decides to cooperate with newegg on the repair of broken train sets and their maintenance including trains which according to the original tender were yet to be sent for maintenances maintenance at sps the rupture of the contract with sps is expected to take place in a week's time as it as is well known nothing affects the intensity of work as much as very close deadlines by which the results has to be shown so the researchers set to work with redoubled energy in the course of their work so far they have downloaded the memory contents of a number of computers both trains are working and let's see both trains that are working and those that should only be working right comparing these images is an ordeal and let's see as almost every train has a different set of functions and different version of the [laughter] software dude sucks to suck man this is just awful but slowly they start they are starting to get a feel for something oh what do you feeling tell me about it o girl what you got what you got they identify values in the computer's memory that are are set in one train and zeroed out in another dang they can run tests at their desk the computer even when taken out of the train lets it run for a while before realizing it's missing the rest of the train to show whether it's ready to run the inverters interesting ooh ooh there is less than a day until the deadline for completion when they find the configuration for flags of flags that gives the train a chance to run unfortunately during the experiments the last the last working onboard computer burns out yes it burns a capacitor burns a r let a rather random occurrence after another brainstorm and many attempts to put two damaged computers into one they managed to repair the burnt one at 2 a.m. the night before doomsday the researchers configure a computer to start the train one of the researchers boards the train of a different operator to arrive with the presumably working computer at the workshop just before the representatives of the lower s sisan railway who have announced a visit at 9:30 a.m. unfortunately the this is this feels so mystery novel sounding i know cursed deadline unfortunately the train let's see unfortunately the train on which the researcher travels to the maintenance company is late you know what as someone who is trying to fix all these broken trains taking a train sounds crazy i'm just saying like if your whole months of time have been spent researching and trying to figure out what the hell is wrong and then you take a train like it it only would have been like the cherry would have been the train in which he takes also breaks down just so so beautiful eventually in the morning the researcher with the computer arrives at the site connects to connects the pray it works computer to the broken down train but the train does not start another brainstorm identifies one flag that was forgotten and at 8:42 the train manages to start the lower silan railway de delegation seeing at 9:30 a.m. that the train has a chance of getting back to life after all does not break the contracts with sps caan celian celian i'm not sure how to say it i hope they i hope they were paid handsomely all right so why the trains broke down all right so this is the part that we're excited about okay wait your name is destroyer we are like 15 minutes in this article and this is how you want to enter it this is this is how you this is how you want to this is like your names sake debut this is where this is how we're doing it the name's destroyer what are we reading why did why did the train break down tell me you tell me right now tell me about the pre the story up to it anyways figuring out how to get the train to run wasn't even half the battle you still had to figure out why it broke down and th this is where the thrill ride begins what what what okay months of analysis and reverse engineering uncovered some extremely interesting conditions written into the software code of various trains supplied by newe after hundreds of hours spent on code dumped from dozens of train train sets it it was possible to identify some very interesting mechanism causing the sudden train sickness nothing nothing like a good translation article that throws in something like sickness nothing nothing like a good sickness right there the nu the numerical values 53.1 3845 and 17.99 one1 found in the computer code seemed familiar at first glance it soon became apparent that these were gps coordinates pointing to the vicinity of another one of these words that no one can pronounce railway station specifically the pisa the pie of railway station another polish train producer and maintenance center site located next to it soon the coordinates of another maintenance center that could carry out train repairs and maintenance in poland were also found below we show the pseudo code of the algorithm the names of the variables or functions have been are given by researchers for clarity we do not know the original names okay okay check if it's greater than this latitude and this latitude is less than this other location and this long okay so if it's between one of these seven different points right okay so there's seven points this lock function test oh interesting there's this one extra one right here look at that one it has a little lock function test if it contains if it has a one at the beginning the coordinate pairs define the workshop areas a condition that has been written in the computer code to disable the ability to run a train if it spends at least 10 days in one of these workshops one of the workshops belongs to new egg itself but a different logical condition was defined for its coordinates presumably for testing okay so if i'm just if i'm just getting what they're saying correctly if any train is within the vicinity of a repair station for too long it just locks up it literally vendor locks in it okay okay that kind of sounds like someone's doing something nefarious here other surprises were soon discovered amongst them was the blocking of a train when one of its components is replaced verified by its serial number an option to undo the lockout was also discovered this did not require setting a flag at computer memory level just the right sequence of button clicks in the cab and on the onboard computer screen i just would like to imagine there's like toggle switches and stuff and it's just like a series of really weird things happen when the news of successful launch of the impulse hit the media the trains received a software update that removed this fix option on another train the code was found instructing it to break down after a million kilometers you europeans write software so much differently okay you guys you guys write a whole different level of bugs okay i'm not used to the eur these euro bugs they hit different okay they just hit different than our american bugs okay yeah what is even a kilometer what is a magnet planned obsolescence you y'all in a fantasy land if you think code like this isn't in your cars ooh gosh that is actually really terrifying yeah yeah american bugs do randomly sell all of your data okay that's a it's a different it's a it's an oopsy daisy that happens we accidentally sell all your data it's different it's different it feels different you know checking the date is hard it is hard a rather funny situation was encountered on another train that refused to work on november 21 2022 even though it was not in maintenance at the time the computer reported that the compressor had failed although the mechan mechanic said that everything was fine with the compressor unfortunately the train still does not raise the pantographs i'm not sure what a pantograph is analysis of the computer code detected a condition forcing the failure which sounded like this if the day is greater than or equal to 21 and the month is greater than or equal to 11 and if the year is greater than 2021 then report a compressor failure how much do you want to bet this is just some stupid test code that someone did that they're like ain't no way this will still be running in 10 years don't worry i'll take out the code i'll remember this little situation these euro bugs they just hit different the situation was funny because the train had been scheduled for service on november 21 the year before the breakdown but the condition did not work then by coincidence the terrain went into maintenance a while earlier and was not put back into service until january 2022 and the sophisticated logic condition described above no longer met this date sophisticated ain't nothing sophist there ain't nothing sophisticated by this logic presumably it was the software developers lack of skill in constructing ifs that made it necessary to wait till the skill isue it's such a skill issue you literally i'm just let you know that this developer just lacks the the required ability to construct if statements i have never heard such a brutal this is the most brutal code review i've ever heard of you lack the necess necessary skill in constructing if statements there is nothing nothing better than that this was so good this was so good i like that i like that a lot imagine not even using a proper datetime class oh my goodness oh my goodness that's so funny all right let's keep on going other surprises were soon discovered among them was the blocking of a when one of its components is replaced verified by its serial number an option to undo the lockout was discovered this did not require setting flags at the computer memory level just the right sequence of button clicks in the cab and on the onboard computer screen when the news of of the successful launch of the impulse hit the media the trains received oh we already read that i remember this we wait we already did this we already did all that here's the here's the skill set ah there we go all right skill issue dude i dude i am having some serious skill issues going on right now hardware surprise surprises lurked not not only in the software of the computers in one train set researchers discovered a device signed as the udp can converter this sucks this just sucks presumably enabling remote communication with the trin removing it did not make anything stop working analysis showed that the onboard computer was sending lock status information to this device and that the device itself was connected to a gsm modem they could just turn it off remotely literally just ah turn that crap off the information that the sp i mean i guess they don't technically know if they receive it because they went with udp information that the sps maintenance center succeeded in repairing new eggs broken train set quickly found its way to another company as well it turned out that it' be quite common problem in warclaw they analyzed 13 impulses but there were also broken ones running in k kog mai one two in opo four in ca and one in wow these are serial newag serially terrible if statement constructors serially terrible if statement constructors foreign and one in warsa fortunately each was able to repair using the tool developed by our researchers that removes the software locks from the onboard computer in total the researchers analy analyzed the software of 29 trains and in all but five they found surprises beyond the official operating instruction what's next hopefully suing we leave it to the readers and customers of this company to assess the solution solutions used by the manufacturer interestingly although there is litigation in the case it is hard to find the institution in poland that has done anything beyond kindly expressing interest in the matter we are not aware of any action taken either by the office of consumer and comp competition protection that is so good this is such a funny name we ensure that companies don't do shitty things but we don't want to touch that one or by the railway transport office which would seem to be compet competent to let's see seems to be competent to eliminate from the market practices that are dam damaging to local government organizations that are incurring considerable losses and to passengers who are forced to travel in crowds or use substitute transport for months the only institution that has taken action that we are aware of is c cert pul pka notified of the discovery by researchers from the comments we received it appears that c pula has notified the relevant authorities and in this case is being handled by law enforcement agencies dang imagine you were so bad at constructing if statements that you got called the police got called you got the police called on you for skill issues obvious it it does i mean it's hard not to think that some of these are a malicious like to lock a train per like to like craz lock a train if it's in any area where it can be fixed this is criminally bad code skill police call the skill police like this feels this is wild and then the only one then the only one that doesn't get borked is the one that happens to be your location looks fine honestly re you got to hit me with why all right proxy sniper you got to hit me why you got to hit me why on this one you got to tell me that they had these things that just locked down the train and the only one that didn't lock down the train checked for a testing flag which was their which was the the original creator new eggs place of fixing the bad part is in absence of laws that guarantee that you can't do this sort of thing i'm not actually sure it's illegal yeah that's fair honestly johnny morg thank you for the tier one i mean but you're you're absolutely right you're absolutely right if there is no technical laws against sabotage which i don't know if there's code based sabotaging it feels kind of sabotaging illegally if this isn't dude this if statement is so bad we're going to call the police this if statement is so bad you got you go to jail you go straight go straight to jail or you have contractual obligations as a company when selling a product yes but they were able to continue to make the maintenances so once they weren't the ones making the maintenances then somebody else had to do it and they maybe they just knew all maybe they had the super secret manual of all the hacks let's see i'm sure there there's an ambiguous law that covers malicious intent yeah sounds like vendor locking yeah i would i mean i'd be i am personally surprised you wanted a train we sold you a train it worked for a million miles a million kilometers anyways that's wild this is this is crazy i'm sure this happens way more frequently than you realize i'm sure there's a bunch of crazy stuff when it comes to cars and hardware because you can't really inspect it i'm sure that whatever is wrong here just imagine all the crap that goes into tracking your data and selling it to advertisers how much worse it is and how much more disgusting and and vile it probably is i mean remember backdoor backd door wang backd door wang fully you know he put it all in right in the code in git he was he was committing fraud those software locks are for some reason i i sure there are for some reason imagine they update the code in each maintenance imagine the part that is a expiration date i i i i'm not saying some of them are more clearly malicious or at least feel more malicious from the just look like this saying that your train will just shut down and stop working if you are within any competitor's repair place for more than 10 days but ours has this extra lock like that just looks a little weird i'm just saying that i totally get like this one right here this one's funny because this one's clearly not this one's clearly not an issue this one clearly is just someone being skill issued out of their mind so bad that they're going to call the police on it justin john deere buys newe yeah john deere levels of scummy i don't know anything about john wait if statements cost $5 these ones cost way more than $5 a month it makes sense to lock but why after 10 days and why permanently lock it up and why not lock it yours i'm just saying it seems odd i didn't read till the end yeah it's just a congratulations and then there's there's this one all right anyways interesting i know of a case in which ron had closed down one of their factories for uh for certain parts that were used for some air defense radars when it lost the contract to an italian competitor who had undercut them during a bid all the while sourcing the the set parts from them and had to spend a decade to produce replacements jeez isn't this called protectionism i'm not sure what this is called i have a hard time comprehending it cuz i also don't work in software or i mean in hardware i work in soft i literally work in software i don't work in hardware and i don't like i've never when i did work in hardware this just wasn't a thing i don't work at soft dude i'm just literally just an influencer that's all i am i'm just an influencer react sucks don't wait which one am i supposed to say i just i just i just love c i love c i'm just a tik tock andy i love c