did you hear about superfish this year yes this is the lenovo laptop scandal isn't it yeah this is this is the bit of software that was installed on pretty much every consumer lenovo laptop that i mean it was so bad that the us department of homeland security issued an advisory saying this needs to be uninstalled and to understand why it's so bad we need to understand man ine middle attacks there have been a lot of techniques for kind of intercepting traffic for a long long time one of the earliest ones i remember is is called arp spoofing or arp poisoning so you you've got your router sitting in the middle cuz all router have a little aerial and and some lights on them and you've got computers you know connected to this and what you do is you you bring your computer along to a open wi-fi network something like that connect your computer and you comp just announces as hello i'm now the router i mean i'm simplifying massively here but basically the network is built on trust and so the computers just kind of believe it and so the computers and the rout are sending all their packets to you first and then you're forwarding them on to the right location so everything is going through you and 10 15 years ago this was terrible cuz pretty much everything was sent in plain text email passwords websites everything was going through in plain text so you can just sit there and provided your computer was fast enough your network card was good enough you could see every bit of traffic on this network work and just kind of slurp all the passwords out obviously massively illegal without the consent of everyone on the network so don't do that but i mean the solution to that is ssl your computer sitting here and the the server out here cuz all servers look like computers from the 1990s your computer sends a request saying hello i would like to talk securely this is the protocols i can support this is this is my details and the server sends back yeah okay here is my public key and i know computer file has has done you've done public and private key before yeah he sat behind [music] me so yeah go watch his video about public and private key crypto if you if you want to know the details of that basically the server sends back a long series of numbers that your computer can sign messages with these and encrypt messages with these and they can only be unlocked by that server because maths i'm not going to try and explain more than that you can lock messages only they can unlock them which is great cuz cuz your attacker who is sitting in the middle here and reading everything will just see noise except all we've really done is mve the problem back a stage because that first bit that that hello i would like to talk securely yeah okay here's my private key that has to go in plain text and someone in the middle can change that they can take that that public key that was sent by the server and just go no i'm going to have that here's my public key instead you're actually going here and then here your computer here doesn't know the difference it then encrypts the message with the attacker's public key sends it back here attacker opens it decrypts it reads it yeah goes okay and then sends the message that should have been sent from your computer or properly encrypted server goes all right we've got an encrypted connection going on here sends the encrypted packet the attacker who who can do this now unlocks it goes yeah all right and then re-encrypts it with their key sends it on to you and now every single communication is going through the attacker no one knows anything's wrong that is your that's your classic man- on the-middle attack the solution to this is something called signed certificates and this is why setting up a secure server on the web costs a little bit of money right now i mean it may not in future the electronic frontier foundation and milla are trying to set up a thing to make this free hopefully by the end of the year it will be but the the idea is that there is a third party vouching for the set of public keys that you're exchanging i've had to do this so i i set up a a secure server about a year ago now u what i had to do is i when i was setting it up i was typing in right the it's going to run this website it's going to be on this address it's going to use these protocols i'm now going to generate this set of public and private keys and then over an existing secure connection one that i knew to be good i send that private key off to something called cic how do i draw a certificate authority i think it's going to be a a faceless office or why don't we do a factory and then we know that that's kind of ind we're going to the internet factory there we go the factory of padlock factory of the interet yeah all right well there we go we got we got a padlock factory there no it's not a padlock i've drawn a padlock here it's not it's it's a set of keys this is what they're called public and private keys i generate my keys i i make them and i send them over over a connection i know to be secure to to this company and there's like half a dozen big ones in the world maybe 50 100 or so small regional ones and what they do is they check all right these keys we've got are they definitely from this server yes and if you want one of the kind of green green padlocks with your company name on it they they will ask you to i don't know fax something on headed paper something like that it probably is still a fax machine actually which is why it's so expensive you know need to keep the fax machine running they get this they check it's coming from the right server they check it's the right keys and then they do maths to them and those keys are now signed by that company with their own private key which no one else has so now when i do that initial back and forth so person comes along they talk to my server and they say hello i would like to talk securely and my server says all right here is my public key it's been signed by those folks over there and the compan says ah oh yeah okay that's that's great and and if the attacker changes one bit of those keys i mean the in the computer sense one one or zero in there the maths doesn't add up anymore and more than that not only does the maths not add up they can't generate any new keys and sign them because they don't have the private key from any of these big companies so the attacker completely out of luck if they change it it would be like when you try logging into a public wi-fi network and it pops up hey you need to log in we need your details sometimes that's a man in the middle of attack they are taking the stuff you're trying to send to the server and they're getting in the way and sending actually no we're going to we're going to send back our page instead this warning we popup saying we're meant to be on a secure connection to gmail but we're not panic everything's wrong big red screen which most people have now trained themselves to click through but you know you try okay the attacker can't intercept the keys anymore not without sending up all sorts of red flags which is fine but again all we've done is we've moved the problem back of stage because how do you know which certificate authorities to trust and that's when for for end users for people like you or me web browsing that is when you do have to take it on trust cuz when you bought your smartphone well i bought this i trusted apple they installed a list of maybe probably about 100 certificate authorities those those those factories on there and they install their public keys on there so they they don't really go over the air to start off with they're pre-installed with with your device if you install a web browser you'll that'll be over a connection you know to be secure hopefully and you install that you say right i'm trusting these companies because my browser manufacturer trusts them so okay we now have keys on this server signed by by the factory here and that factory is trusted by whoever made your browser or your device so we have this complete network of trust that's set up that means the attacker can't change the keys and there are two obvious weak points there one is the certificate authority if you can get them to fraudulently sign keys then all the people that trust them are completely out of luck and that happened that happened to a a dutch certificate authority that is now bankrupt because no one trusts them somehow they they got conned coerced bribed no no one knows but they generated a completely valid signed certificate for google they had no right to do that no permission to do that but they generated a certificate for the whole of google with their signature on it saying we trust this and that somehow made it to iran where someone managed a massive man-in-the-middle attack on enormous numbers of iranian web users so they were all seeing a big green padlock with google written in it if they looked at the details which a couple of people like if if you're paranoid you check the details on this and someone is asking why is this certificate for google signed by someone in the netherlands that doesn't make sense and that was how it was found out like that that wasn't a genuine google certificate but most people wouldn't know that they're they're talking to gmail they're seeing a big green google certificate in there they think all's well so they're basically looking at their gmail emails but it's all going through somewhere else it's all going through an attacker the keys that are being replaced they couldn't do them for every website but they done it for this one they' done it for google so every bit of google traffic that went through they were swapping out the keys opening everything looking at it sw and this is all happening in milliseconds obviously open it store it put the new keys on it that you've got send it onwards and it's it's terri it's a devastating attack if you can pull that off and there is a a genuine concern that governments can do this governments can go to certificate authorities and say right this is the government here we need you to generate some fake certificates or they can just steal the private keys if they can steal the certificate authority's private keys then they can generate their own keys without even the authority knowing i mean it's it's a devastating attack if they can pull it off can they i mean i'd be surprised if the nsa couldn't do that somehow whether they actually choose to do it is another matter because if they do and it gets found out not only have they bankrupted a fairly major company who no one trusts anymore but they've blown their cover so i suspect that yeah they can do it and they use it in very very rare situations when they haven't got another option whether they should i'm not getting into that debate so that's one weak spot the other is the list of trusted authorities on your phone or on your computer because if an attacker can get an extra entry in there it's they can get themselves in there then they can just generate new keys on the fly and every single connection will be intercepted so that's what superfish did they wanted to insert advertising superfish was a program that took your google searches and added a little bit more advertising in in it for them which which is a terrible idea but google switch to secure searching for everyone so superfish which it's such a bad idea they installed themselves as a trusted certificate provider and it wasn't even sitting out on the networks this little program sitting on your own computer looking at all your traffic and doing a man-in-the-middle attack on it and inserting their own adverts that authority is sitting on your computer signing keys on the fly which means that the private key the numbers that should never ever be seen is sitting on your computer and can be extracted it was the same on every single computer so as soon as one attacker pulled it off one computer every single installation is vulnerable because every single computer that has superfish trusts superfish so if someone in the middle pretends to be superfish which they can do because they have that private key then that attacker can man ine middle every single secure website out there and they know you've got it cuz they can see lenovo on the back of your computer in the coffee shop you know there's there's there's way there's uninstallers out there now the noo promised never to do it again super fish as far as i know does not exist as a as a bit of software anymore but it's one shortsighted company that used every ignorant shortcut in the book to try and make a few adverts appear just because of that tens of thousands maybe hundreds of thousands of computers i don't know perhaps a i i don't know how many they make in a year but all those were made vulnerable to a really really terrible attack just because one company wanted to sell a few ants and it's very very difficult for people who go into a bad place and use a card because if you complain to your bank then the strip club owner will just say he was with four girls all night and l4,000 is what that costs at our place how long have you not been recording a really good question this is because i'm an idiot i love it we're three4 of the way through and he says why am i not recording we did that for the drone footage in chobble we had a we had a like a monitor on the on the drone footage with a remote link and we you know we're getting all sorts of shop i just look in and go that gopro is not rolling oh bring the drone back down change the battery in the drone oh man