what i've been wondering is you know if you've got a lot of pictures of horses and you really want to turn them into a lot of pictures of zebras how are you gonna do that, right? marker pen. yeah, marker pen, just draw some lines there. yeah, that is quicker today we're going to talk about cycle-gan, which is a really interesting innovation in generative adversarial networks(gans) now rob has already covered this in one of his videos what a gan is and what it's used for typically generating images of interest. pictures of trees, pictures of people, pictures of buildings, you know, you can train gans to do these kind of things what's interesting about gans? is that you actually have two networks you have one their work that's learning to generate images and you have a second network that's learning to try and tell the difference between the generated ones and some example real images and by training the both together you force the generator to produce more realistic looking images there's another domain that gans are useful, right which is not generating an image from scratch it's turning an image from one domain into another so for example you might take a photo to try and make you look like a painting or you might take a black-and-white photo and try and make it a colored photo or something like this there are lots of ways to do this kind of style transfer but gans are one of the ways you could do it it's gonna be slightly different to what what was talking about because in this case we have an image going in, right? and not just noise and we have an image coming out so one way you could train this is just with a standard kind of encoder decoder network like we've talked about before so you might have an image let's say here so this is a photograph and you have a kind of encoder decoder networks like this that we're gonna call our generator and then it outputs another image these aren't typically too big but they usually do filter the network down and back up again and then we have i know an artist impression or something like that of the picture now one way we could train this is to get a bunch of paintings and a bunch of photos of where those paintings were sort of captured font, right or commission a bunch of artists to go out and paint the load of stuff that we have the photograph for and then we've got this supervised training data that we could use we could just put in pairs of photo what it's meant to look like in painting form and then even train a net weather hopefully we'll map one to the other and the idea i guess is that you then put in a new photo? but it's never seen and it does a nice job of painting it right? that's the hope so this is like a kind of basic level of training up a network to produce some kind of style transfer but the problem is that it's a bit of a pain to have to get these pairs of data, right? so a lot of the time the data isn't paired a lot of time. we have a lot of pictures of paintings we have a lot of pictures of photos, but it all look completely different places so producing a mapping between one and the other is a little bit more difficult what a gam does is has a discriminator here? so this is going to be a discriminator and this is is it a real or fake image the bet of a discriminator gets at? detecting the fake paintings the better mix generators will have to get converting photos to paintings, right? that would be the idea and this works pretty well why and it works well for generating photos and third foot changing photos into other domains but gans have a lot of problems with training that make them quite difficult to use in practice one of them is something called mode collapse imagine that we are trying to produce again now that takes a picture horse and converts it into a picture of a zebra so what's happening is we put in a random picture of a horse and then the discriminators? is it a real zebra or fakes everywhere? and if it's determined to be a fake this generators gonna have to get better at changing that horse into a zebra horses into zebras is a kind of arbitrary problem that you might wonder what why we do in that well for fun mostly but also because actually it's just a textual check text will change the shape of a zebra is approximately the same as a shape of a horse which makes this problem slightly easier, right? we're talking about adding stripes we're not talking about totally changing the shape of the object the problem is that let's imagine that the generators have realized for discriminator how in terminator worked and just said okay i'm going to produce this exact same picture a zebra this is gonna look bad by the way. so this is my picture of a zebra how did i am good is it right again again again would have been better an untrained can work. i've been better now so let's suppose the generator generate this same picture every time any picture of a horse cause it just generates that picture it's a simple you asked was ever. here's who's ever it's the only one you're getting man this is something called mode collapse. the idea is that the generator has now completely failed to produce interesting pictures just producing the same picture every time imagine we wanted a generator that produce digits like six five four three, and this was determining whether they were real did you or not? well if you just produce six every time it's problem is so much easier and we discriminate it can't complain about that because they are technically digits. this is the exact same problem so cycle gann is essentially a two gun system that deals with this very problem so how does it do it? well, what we have is we have two guns. alright, because if one is good then two better and what we try to do is we're trying to make sure that not only are we taking our image and turning into something that looks good. and it's in it's indistinguishable from a real one but also that we can then go back again to prove that we haven't just generated the same license image. it's got nothing to do with the input, right? so, this is our input we have a generator a generator network g so this is g which is going to generate a picture of a let's say as of a zebra then we have another network f alright which is taking pictures of zebras and turning them back into pictures of horses so there's two guns and there's going to be two discriminators, right? this is a scream later here saying is this a real picture of a zebra? question mark to a discriminator and when as a discriminator here saying is this a real picture of a horse? so there's a lot of loss functions being applied here what's a loss function a loss function is a function we use to calculate how wrong or right a particular network is so in this case the loss function is you were supposed to say this was a real image. and you said it was a fake image so your arrow, is that is that much right? without going to any numbers. that's basically what it does right, but this is how we train these things, right? you calculate a loss just say look you were supposed to say this was a fake zebra but actually you the wheels emperor so next time change your weight so that you say it was a feint ever that's what the loss function is for. so a horse comes in the g generator turns it into a zebra, theoretically right. this goes into the f function it turns it back into a horse and then we have a final loss which is what is the difference? between this horse here and this horse here because if we can't recreate the exact same image then we just produce a different picture whereas everywhere but it's that's cheating my for this to work we have to convert this horse into a zebra not just produce a picture of his ever you see what i mean? right the same with something like star transfer to a monet painting, right? we take a photograph we turn it into a monet painting. it looks great but if we can't turn it back then what you've done is just draw a male painting for me it's got nothing to do with the input so in some sense this g and f function are inverses of one another one does of a function and the other one undoes the function what's interesting about cycle gain apart from the fact this kind of a loop here is they have this loss that also measures a distance between this image and this image. so not only ensure that these are both producing realistic-looking inputs and outputs, but that these two at the end of the same and you can do it both ways you can go horse to zebra to horse and measure this distance here and to make sure they're same and you can go zebra to horse as ever and make sure this distance is the same right so you can work in both ways you can put f first or g first so this is exactly how you train it you take a number of images of horses and a number of images of zippers and then you train it just like again you say well, here's a horse image go in. was it a real image or not? right, and sometimes you give the discriminative real images. sometimes you give it fake images and it tries to get better with that you don't put it through after to toe it back into a horse back discrimination is also working to make sure this f function is better and then you make sure these two are the same as well one way of looking at this is that you're trying to separate out what the content of images and what a style of images i'm the content should be the same alright the content of the horse image and the zebra image should be the same because if it's not you won't be able retrieve one from the other the style is you know aspect how it looks my is it a painting? is it a zebras at horse? these are things that we can apply later kind of to the base image. that makes sense and this can be applied to a whole array of different problems like this kids in medical. imaging right? we're looking at it in plant. imaging it's used for style transfer so in the paper alone, there was about 10 different examples of things you can do you can kate you can take pencil drawings and turn them into into men doings of an object so like, you know a boy of a shoe - an actual picture of a shoe you can go from photos to monet paintings to van gogh paintings you can go from horses to zebras apples to oranges and the list goes on right and if you have a look online you'll see all kinds of weird wonderful things that people are using this cycle can and variants of it too to do is a resolution. good. no it's okay, right the the resolutions are get so this kind of size of training data we're talking about 30 centimeters is in the hundreds of pixels squared so 2 to 500 pixels squared usually training them takes all the memory once they're trained you can put through so if what we say inference time, you can put through bigger images and there were ways you could train it so that it will work on bigger images when it actually gets to applying it right, but the images i've been testing on a smaller 512 by 512 something like that. we're not converting for herod is yet? there are there is work that maybe we'll talk about overtime lifestyle gang which does try and produce higher resolution output what you'll find i think if you watch a video of a cycle gun being applied to every frame of an image it's gonna be little bit noisy is you're gonna have to take steps it tries to move that out. there's a few videos of like parts of 2001 a space odyssey as a picasso painting where every frame is a picasso painting it's quite something to look at right but there's a bit of noise because you know the input changes even slightly some is going to change on the output right and so it sort of flickers to get it to get it to be smooth you're gonna have to do some kind of extra processing so i've come on this right you can you can download the code online. we'll put a link in the description you can download it as long as you've got all graphics card you can start putting random pictures of horses in turn them into random pictures of zebras and feel bit pleased of yourself these kind of gans are being used for all kinds of things that you see like a super resolution for example way taking a very low resolution image and you want to sort of blow it up so we can see a lot of fine detail you know, that's sort of csi. it harms in arts it zoom in on that. i have some concerns about this because one thing to remember is that these are trained to look nice. they're not trained to be an accurate representation of the ground truth specifically right? there's no if you take a blurry image and you know, i'm saying this to cover my own back more anything else if you take a blurry image and you zoom it up and it looks like me, that's probably a coincidence you can't trust that it was actually me maybe more but it makes you know but my point is like you're not gonna be a loser in a court of law because it could be argued that it just created an interesting looking face. it's not created the actual face from these few pixels this it's gonna be a while before we're looking at networks that can actually work out what truly someone look like if you look at the input and output of this cycle can for example you'll see that it'll take a horse and turn into a zebra and when it turns it back the images are close but they're not the same often. the grant is a little bit muted i think probably because there's ever tend to be on dryer grass. i'm sort of the plains and stuff, right? so it changes the rest of the image as well to deal with this so these interesting things there does so super-resolution. it's one thing that's used for medical imaging converting from one domain of medical image like an mri to a ct scan right? i'm quite worried i wouldn't use case for that is but you know there's a lot these sort of things can be done the recent samson video where they had people's faces and things like deep fakes right, which are i would just say morally questionable, but these are all things generated using these joseph's adversarial networks you're taking inputs which are you know noise or other images or pose? estimations if you're trying to make a face do and when it's generating an image what looks like that thing so there's lots of ways of controlling what different bits of this do to get an output that you want encryption and specifically kind of modern encryption and how it works now before we jump straight into something like the advanced encryption standard. i wanted to talk about sp networks or substitution permutation networks because they are the basis for a lot of modern cryptography not all of it, but a lot of symmetrical