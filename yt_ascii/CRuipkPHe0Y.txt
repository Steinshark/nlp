hello and welcome back to the second video in the iron man visual effects tutorial series this week the main topic is rigging and it's much more exciting than the last video i promise this is where we left off last time all of the parts of the mesh are separated into individual sections so the focus of this video is going to be setting up the main armature to be able to control things like the movement of the arms and legs and also setting up some drivers so we can control things like the flaps with external controls like i showed in the trailer someone's commented on one of my videos last quin if you're watching this i hope that's how you pronounce your name he commented on the trailer saying are you really doing a full tutorial series i hope this answers your question step one is going to be adding the armature and if you go to edit preferences and enable the rigofy add-on then we can cheat a little bit and use a pre-made one so we search for riggefy and turn this on and that will give us access to some extra armature shapes that we can use as presets so if you press shift a for the add menu we can come down to armature and then add a human meta rig we're not going to use all of these bones especially the face parts because obviously we don't have a face that's going to be moving but what it does give us is basic controls for the legs and the hands especially the fingers this is quite annoying to set up manually so this kind of takes care of that step for us to be able to see it better through the suit you can come down to the armature settings and under viewport display you can turn on in front and as you can see now wherever you look at it from it always displays on top of the suit so the first thing to do is just select it and then scale it by pressing s until it's about the same size as the suit so the main things i'm looking at are where the hips end up and where the shoulders end up for those joints then once it's about the right scale i'm going to press tab to go into edit mode and delete some of the bones we don't need so i'm going to get rid of these and the hip bones and i'm going to get rid of these ones under the ankles because we're going to make our own for them and i'm also just going to delete all of the bones for the head because we're not going to use any of these also while you're in edit mode if you press n to open up this menu on the side and go to the tools tab you can turn on x mirror and this will basically mirror the actions of the armature on the other side and it means you basically only have to set up one side of the rig which is quite nice speaking of which we need to move some of these bones to be a little bit more in the center of the mesh so hit three to go into side view and then we can just basically take these and manually move them into a position that looks a bit more appropriate i'm also going to move the hip bones to be more like the center of this circle because that's essentially where they're going to rotate from move the knee bones to be more in the center of where the knee joint is as well then i'm going to bring the ankle down so it's closer to where the ankle actually is and then just make the toes the right shape as well we don't actually need these shoulder joints here because there's no shoulder movement in the suit because it's a rigid structure obviously so i can press x and delete those bones for the arms you have to be a bit more specific about where you put the bones because you want them to be to move from a very specific point for example where the shoulder joint is so the best way to do that is to select the arm go into edit mode and then press l on the sphere to select it and then if you press shift s and then do cursor to selected that will snap the 3d cursor to the very center of this sphere so then what you can do is grab the armature and then grab where the shoulder joint is and press shift s and do selection to cursor and now later when we move this bone in pose mode it's going to orient from exactly where the shoulder should move then we can do the same thing for snapping it to the elbow so we want it to be dead in the center and a good reference for that is these two circle bits on the edges of the elbows so i'm going to press l on both of these and select them and then if i do shift s and cursor to selected it will basically find the average center point which is in the middle of those two which is exactly where we want it to be so then once again select the armature go into edit mode select the elbow joint press shift s and then selection to cursor then we want to do the same thing for the wrist as well so i'm going to select an area of the wrist i'm just going to loop select the edges here this is going to be where i want the wrist joint to be and that will snap the wrist over there i'm going to box select all of the bits of the hand to just manually move it into place for now so it's a bit closer to where i want it to be and now we have to move all of the finger bones to be in the correct places as you can probably see there's a bit too many bones here at the moment so we don't need these original bones for the hand so what i'm going to do is just go in and delete these for now press x delete bones the best way to do this is using two orthographic views so if you do it from the front like this and get them all in the correct sideways perspective then you can jump to the top view and make any adjustments and then if you line them up from two views that should kind of triangulate and make it in the center so i'm going to jump into front view for now and position the thumb bones first it's a little bit tricky to see which ones are which in some of the views so just make sure you're selecting the right ones so now from the front view they look pretty good but then if you go into the top view you can see some of them are a little bit crooked the thumb is completely off so you can now go in and just tighten these up a little bit as well now as you can see that's pretty much exactly in the center of all the fingers you can have a quick rotate around see if there's any you want to move a bit more now annoyingly the fingers on the other side don't line up perfectly so as you can see they're a little bit off which means the armature either needs to be moved or we can duplicate the mesh and then kind of flip it i'm going to try that first because it's probably a bit more simple so i'm going to hide the armature for now and then box select all of these parts and then just press x and delete them and then box select this side of the arm if you press shift s and do cursor to world origin that will snap the 3d cursor down here to the center of the world then if you press full stop change your pivot point to 3d cursor so everything orients around the center i'm going to press shift d to duplicate this arm and then without clicking scale or s x minus one now ideally if i press alt h these should line up the only unfortunate thing is now the naming conventions we set up for all of these parts will be left instead of right because it's duplicated the left hand side so if i hide the armature i'm just going to go in and make sure all of these are named correctly so basically hit f2 and then change it from l to r now we unhide the armature everything should be perfectly mirrored the one thing i am going to change is currently the arms are a little bit of an angle they're kind of 45 degrees twisted which you don't really want so if you tap into edit mode and just select both of them press alt r that will reset their rotations which should mean they're pretty much 90 degrees so this is like rigging 101 you've set up all the main bones kind of similar to what a human skeleton would be like the next thing to do is make an ik system for the legs ik stands for inverse kinematics and it's like i showed in the trailer how i was moving one part of the leg and the knee would bend and the thigh would move at the same time so to do this you have to add a couple of extra bones the first one is a control bone which goes on the ankle so i'm going to tab into edit mode select the ankle press e to extrude and then y to just extrude in the y axis we actually don't want these to be connected to the rest of the armature so press alt p with that selected and do clear parent so now it looks like it's connected and it's in the right place but actually you can move it independently then do a similar thing on the knee so select the knee joint press e to extrude y to go in the y axis this time i'm going to move it forward a bit and then click and again we don't want it to be connected to the rest of the skeleton so press alt p clear parent and for this one you actually want to move it out away from the knee so press g and then y to move it in the y axis move it to about here and then just rotate it 90 degrees as well so it's pointing upwards and this is going to be the knee target so basically the knee will always be pointing at this bone no matter where you move the leg now i'm going to hit ctrl tab to go into pose mode and just name the extra bones that we've created so what we want to call these ones on the feet is foot ik dot l because it's the left one and then this is going to be foot ik dot r this one's going to be target knee dot l and this one's going to be target knee dot r so at the moment when you move this it's going to move like a normal bone so to turn it into an ik system you select the control bone on the foot and then shift select the shin bone and press ctrl shift c which is the shortcut to add a constraint and the constraint we want to add is called inverse kinematics which is ik which i mentioned earlier and if you grab the foot control bone now and move it you can see that it's actually moving the rest of the rig now obviously this isn't quite correct yet there's a couple of things we have to change so the first thing we want to do is add the pole target which is these bones here in front of the kneecaps so if you grab the eyedropper tool you can select the rig so for this you just want to select the whole rig overall and then under this a bone box appears and you can tell it what bone is the pole target so in this case it's going to be target knee dot l the next thing you want to do is change the chain length this is basically how many bones there are between where the ik system starts and where it should finish so in this case the chain length is two because there's two bones there and now everything else is snapped back to how it should be except the foot is rotated 90 degrees and to fix that you change the pole angle so moving this will basically rotate the bones in the chain so in our case we want this to be minus 90 and that will reset the foot to be facing straight ahead how it should be and now the ik system is working so i grab the ik foot control and move this you can see that this is now working how you would expect a leg to work and on top of that moving this bone in front for the pole target will move where the knee is pointing so that's looking really cool now we just have to do the same thing to the other side now comes the fun part we're going to attach the iron man suit to the rig so i'm going to do this systematically start at the bottom and make our way up the way to do it is select the part of the mesh you want to parent then shift select the armature and then press ctrl tab which puts you into pose mode and then you select just the bone you want to parent that part of the mesh too and press ctrl p and then instead of doing with automatic weights you just do parent to bone and now if we move this you can see it's moving that part of the iron man mesh and now it's just rinse and repeat so select the foot then shift select the armature control tab into pose mode select the foot press control p parent to bone again i'm not going to do this whole thing on camera because it's going to take a little while it's worth mentioning at this point that you should parent all of the other individual flaps to the bones as well so for example these flaps at the back they should be connected to the shin bone because they're going to move with the rest of the shim the fingers are definitely the most painful bit it's just a case of kind of going through and manually doing each one so as you can see here all of the fingers are now parented to the correct bones and then the hand can also move and it moves all of the fingers so at this point the rig is pretty much done as you can see we can move all the different parts of the body how we would like some of the joints should only be able to move in one direction like the knees should only be able to move kind of backwards and forwards so what you can do is select the bone press n and then under item you can limit the rotation so for example this bone should only be able to rotate in the x-axis so if i lock all the other axes then it will only move in that direction same thing for the feet so you press r and then work out which way they're meant to rotate it's the x-axis again next thing to do is add some constraints to the fingers so you don't have to go in and rotate them all manually we're going to add a constraint so the finger bends all of the three sections of the finger just by moving one bone the way to do that is called a copy rotation constraint so basically you want to select the first bone and then the second bone in the chain press ctrl shift c and then copy rotation and then if you go to the bone constraints tab what we want to do is set both of these to be local space instead of weld space and now if we rotate the first bone you can see it bends the second bone at the same way then essentially you want to do the same thing to the second and third bones in the chain so select them both copy rotation change both of these to local space and now if we move the first bone all three fingers will move in unison again we probably want to limit the rotation of this bone because as you can see if i rotate it from anywhere other than the side view it does this crazy thing so what we want to do is lock the rotation on whatever axis it is in this case the x axis so i'm going to lock the w y and z do these to all of the fingers as well as making the animation easier because you only have to move one bone you can also now hide the bones that you don't need so i can select all of these and move them to a different bone layer and now they're hidden from the viewport so grabbing these is even easier because there's nothing else in the way same thing goes for the legs we can hide the thigh shin and feet bones by just moving them to a separate view layer as well because the only controls we need to be able to access to move the legs are the ik foot control which does the leg and the rotation of the foot and then the toes as well here the next step i like to do from here is create some customized control shaped bones before we do that we need to make one extra bone that's going to be like the main control for the whole rig that everything's going to be attached to so to make that i'm going to select the rig go into edit mode and then with the 3d cursor at the center of the world i'm going to press shift a which will add another bone and rotate it by minus 90 degrees and then just move it backwards a little bit as well so basically what i want to do is connect all the main controls that everything else is attached to to this main root bone so i can move this bone and move everything in the mesh at the same time so at the moment that's the pole targets for the knees the base of the spine and also the ik foot controls so i'm going to go into edit mode select all of those and then shift select the root bone and press control p and make parent with keep offset and what that's going to do is attach everything to the main root bone now if i click that and drag you can move the whole iron man suit but this looks kind of ridiculous having a massive bone on the floor so now what i want to do is make some custom control shapes for the root bone i start off with a mesh of a circle and then i turn the divisions down to 24 and go into edit mode and then i select the three vertices that are kind of in the diagonals from each other if that makes sense and then what i do is set my pivot point to the 3d cursor which again is in the center of the world and i scale these in a little bit which makes this kind of cool shape and then if i hit f2 i'm going to name this root shape and i'm also going to move this into a new collection which is going to be called bone shapes because i want to be able to hide this later so once that shape is made you select the rig go into pose mode select the bone you want to change and then in the viewport display there's the custom object box and if i type in here root shape now at the moment it's slightly offset based on where the bone was in edit mode so to correct for this instead of moving the actual armature what you want to do is ctrl tab back into object mode and select the original shape that you made from the circle and then move this in edit mode so for example if i hit g y i can now slide it around and i basically want to line up with the center of the iron man feet and then once that's done if i hide the bone shapes collection you can see that that's left us with this so this is the same bone that was on the floor it just looks different next up i like to turn the control points into empties so i'm going to press shift a and then go to empty and let's do a sphere then if i hit f2 name this target shape what i can do is go into pose mode select the targets select target shape if it's a bit big what you can do is just change the scale of the bone so i'm going to set this to something like 0.35 do the same to this one and then once that's done move the empty into the bone shape so that it disappears from the viewport then in pose mode these are a really nice easy way of seeing where the targets are next up for the spine bones i'm probably just going to do circles for the torso i'm going to make something that comes over the shoulders a bit and kind of mimics the shape of a torso so i'm going to use a circle for this one as well so if i jump into edit mode and then go into wireframe and grab the outside edges of the circle if i press o to go into proportional editing and then g and z i can basically move these down in proportional editing mode and make a nice smooth shape and then select the torso bone set this to torso shape and it's a completely the wrong orientation so we're going to change that go into edit mode and kind of move it until it's looking more correct and something like that looks pretty good and as you can see we're gradually going through and getting rid of all of the shapes of the armature and just replacing them with custom shapes which looks a lot cooler i'm just going to do some simple circles for the neck and head as well i think the arms i'm just going to leave as they are because they're kind of simple to see what the arms are doing but i am going to change the fingers to be the same as the pole targets so if i select this custom shape what was it target shape yeah and then set the scale to be like 0.3 so now with the fingers if i select all of these and then make sure i set my pivot point to individual origins i can rotate them so there we go that is the entire rig sum it up we have the root shape which we can move the whole suit with then we have some controls for the toes we have the foot ik bone which allows us to move the entire leg i've just noticed that the targets are too close because if you move the leg too far out then it will start rotating like crazy so in edit mode just grab both of these press gy move them a bit further away and that should fix that then we have the root shape for the spine which allows us to do this we have the core torso the neck the head and then the arms the forearms and then the hands like we did earlier you want to restrict the forearms to only move in one axis because obviously they shouldn't be able to move like this because this is a mechanical hinge on the elbow so that's the whole rig for the body controls now all we had to do is set up some drivers to make the flaps open and close the first thing you want to do is set the origin of the geometry to be wherever the rotation is supposed to happen so in this case it's probably going to be from about here so what i'm going to do is jump into edit mode and i'm going to select the vertices where i want the rotation to occur from so for example in between these two then what i'm going to do is press shift s snap the cursor to that selection and then tap out of edit mode come up to the object menu and under set origin do origin to 3d cursor and that's going to set the origin point of this flap to be right there and essentially now it can rotate from that point i'm also going to move this into a closed position because it's easier to animate it to open than it is perfectly shut then to create the custom slider to control this i'm going to add a plane and i'm going to rotate it in the x-axis by 90 degrees and then i'm going to scale it in the x-axis a little bit to this sort of size then in edit mode i'm going to press x and delete only faces which will leave us with this outline and then i'm also going to move it up so that the bottom of it aligns with the center of the world like this if you hold ctrl it'll snap by increments i'm going to hit f2 and name this leg flap domain and now i'm going to create a circle which is going to be the actual point of the slider that goes up and down so shift a empty circle scale it down a bit so it fits inside of here obviously f2 rename this to leg flap control and now we just set it up so it can't move outside of this domain the first thing is really easy we can just limit it to only move in the z axis by disabling the x and y location i'm also going to select the control and then the domain and then control p to parent it so wherever the domain moves the slider will move with it then to stop it moving outside of the domain you can add a constraint called limit location if you set the owner space from world to local that means wherever you move the domain it will still maintain its local coordinates and then we just want to enable maximum and minimum zed location minimum will be zero and maximum will be two and now as you can see it can't go below zero and it can't go above the top of the domain i'm going to add some text onto this just so that we can see what it is move it on to the top of the domain and then if you search for convert to we want to convert to a mesh from text which means it will turn it into geometry and then you can select the text and then the domain and just press ctrl j and there'll be one object and now the whole thing will move as one now i'm just going to bring this over here and i'm also going to scale it down by 0.5 so it's a bit more of a manageable size now we want to link the leg flaps rotation onto the slider so to do that select the leg flap press n to open the item properties and then on x location right click and go add driver if you accidentally come off a bit like that just right click again and do edit driver and it will bring it back up the only things you have to change are the objects and in this case it's going to be the circle that we added so this is going to be leg flap control then for type you want to change it to z location because wherever the circle is in the z axis we want that to control the rotation and then change space from world space to local space and now if i move this up and down you can see the leg flap opens then we can mirror this onto the side by right clicking copy driver and then select the other leg flap and then paste driver so as you can see they both move at the same time so essentially now you just do that for all of them the leg flaps are a little bit more technical because they start in an open position and they're not quite in the right place how the model was set up originally to rotate to close so what i've done is move them manually into a closed position then what i'm going to do is press ctrl a with all of them selected and then click all transforms we're just going to apply that and set this as like their rest pose for where they're going to be when they're closed so i'm going to set the origin points to be kind of where the hinges should be and now if i select all of them and i can rotate on the z-axis they all rotate then what we can do is add a driver so if i select one of the flaps add a driver to the zed rotation first of all i need to make another one of these sliders so i'm going to rename this to be shim flaps domain and shin flaps control then if i select the flap again edit driver set the object to be shin flaps control z location local space then when i move this up and down this rotates so then we can copy this to one of the other ones so copy driver and i'm going to copy this onto this one here and paste driver now they should both move at the same time however if i paste it onto this one we'll see what happens and i do this you can see it rotates the wrong way cause it rotates inwards so what we want to do is invert that so if you go on this one and do edit driver you want to just add a minus in front of this and var stands for variable which is just the number of rotation basically so if i do minus far and then i move this up and down you can see it now rotates in the opposite direction so then i can select this one copy the driver to the outside flap and now the whole lot should move like that the circle rotations for the knee and hip are essentially the same thing so again i'm going to create an extra control point and then i'm going to zoom in on the knee joint and make sure that it's exactly 90 degrees i basically want to rotate it on the z-axis until the circles kind of line up and now if we rotate it on the x-axis it spins in place like this and then lock the y and z-rotation and then on the x-rotation add driver and then if i grab this move it up and down you can see the knee joint spins also if you want them to spin a bit faster so for example for this if i move it up and down you can see the actual range of motion isn't very much what you can do is go to the driver edit driver and then you can change this to be var times like five for example and that will basically multiply it by whatever number you type in so that's probably a bit fast but if i do like maybe two now it will spin twice as fast which looks a bit better and the same thing goes for the spine as well so for example here the spine is kind of opening a bit too much i probably don't want it to go that far you can multiply it by something like 0.6 and that will make it basically only move 60 as much copy the driver onto all the other ones and now if i move this up and down the spine opens the shoulder pad ones are a little bit more fiddly the first thing you want to do is set the origin point to be in the center of these two circles so i'm going to select both of them shift s cursor to selected and then object set origin origin to 3d cursor and then what you want to do again like the knee joints is make these perfectly line up so once that's done i'm going to apply the transforms and then i'm going to reset the origin point to be in the center because it moves it when you apply the transforms and then from there we're going to restrict the x and z rotation so it's only the y axis and then add a driver onto the y axis and then if we move this up and down that moves again this one's a bit too strong so i'm going to do edit driver and do var times 0.45 and then again we have to do the inverse to the other side so copy this driver paste the driver onto the y axis and then edit driver and just put a minus in front of this to make it go in the opposite direction now we move that slider these both rotate and there we go that's all of them i never thought i'd have to do that twice took me long enough for the first video now i've repeated all that work a second time but this is it in action so i select all of these control points and move them up and down and that is going to conclude this tutorial this is probably quite a long video this has been a couple of hours of recording at least and my throat's very sore again but that is the entire process for rigging the suit next week's video is going to be doing the textures and the photo realistic materials for the entire suit thanks very much for watching all of the project files are on patreon if you're interested in picking them up and saving yourself some work i'll see you guys in the next video