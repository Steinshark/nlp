we're going to talk about a classic problem in mathematics. this problem is 400 years old. it's about sphere packing. the question is, what is the best way to pack spheres? and by best i mean, what is the densest way of packing spheres. and it's thought that the best way of packing spheres is 74.05%. so if you were packing a container, it would be 74 percent full. now it's been thought that is the best way of packing spheres for 400 years, and it was finally proven in the 1990s. however the referees, when they looked through the proof, thought they were 99% certain that the proof was right. so that's kind of, slightly unsatisfying. so then they started a, a 15-year project to really make sure that this is correct, and they've rewritten the proof in very formal mathematical language which allows a computer to automatically check the proof, which was finally accepted in 2017. finally proving the conjecture about how densely you can pack spheres. but the problem itself goes back to sir walter raleigh, of all people! sir walter raleigh is very famous in britain, but he's an explorer. he's the guy who put his coat over a puddle so elizabeth the first could walk over a puddle. he invented the potato, and other lies. very famous in britain, i know. and he wanted to know the best way of packing his cannonballs on his ships. so he asked his mathematician, because everyone should have a mathematician, a guy called thomas harriot. and so he started looking through the best ways of packing cannonballs. so perhaps one of the obvious ways of packing spheres would be something like this. which is a pyramid shape, well with a triangle base, so a tetrahedron. you see people stacking oranges or something in the supermarket, that would be one way of doing it. but another obvious way of packing spheres would be a square base pyramid. let's try that. let's try that instead, break this apart. let's try and make a square base pyramid. just a couple of extras. here we go. now it's obvious where to fill the next layer, because we're going to fill these dimples here, so let's do that. so we can fill these holes with our next layer of spheres. i'm gonna put that one there, let's put this one here, let's put this one here. and if we're lucky we should be able to crown this with our last one, like that. so we get a square pyramid. so that's another way of doing it. perhaps another obvious one would be with a hexagonal base, so we'll get a look at that too. so let's try and make a hexagonal base. so i'm gonna have a central one there, let's make a hexagon around the centre. and then for the next layer we would fill in those obvious dimples. so there would be one there perhaps, one there perhaps, let's do one there. and i could crown this off with another one. but what i wanted to show you, and this is what thomas harriot noticed, is that all those packings are actually equivalent - they're all the same. and they all have the same density as well, which is going to be this 74.05%. so you might be able to see that the hexagonal packing is the same as the tetrahedron one, it's the same kind of a packing layer-by-layer. but this is less obvious i wanted to point out. this is also the same as the square base pyramid, but it's tilted on its side, look there. can you see that square there? so that square would be the square base of the square based pyramid, but it's just tilted on its side. so all these things are absolutely equivalent. they have the same density, which is  74.05%. actually thomas harriot's pal, which is johannes kepler, who you may know, decided that this would probably be the most dense packing possible. so this is now known as kepler's conjecture, that this is the best possible, which is the 74.05% figure. so let's have a look where that figure comes from. incidentally this is one of the early beginnings of how atoms work, or how we started to learn the structure of atoms. if these spheres were atoms, then this kind of packing is what you find in, i don't know, aluminium or copper, if these were the atoms of copper. or in crystals, like, just table salt. if you look at a crystal like that you get this kind of packing. but let's look at where that figure comes from. so here's a small square based pyramid. now this just repeats forever, if just imagine that repeating forever that would be the idea of packing. what about if we can cut this up into some sort of unit that we can then just repeat? then if we work out the density of the unit, that does the whole thing. okay, let's do that. what i'm gonna do is i'm gonna slice up this pyramid into a box. i'm gonna cut a horizontal line across the top layer, i'm gonna cut a horizontal line across the bottom layer. so i've cut them in half. and now i'm gonna cut four vertical lines, so now i've created a box. and that box, if you repeat it, will give you the whole packing. so now i want to know the density of the spheres inside that box. well, that box contains exactly one sphere. we've got half a sphere from the top, and then from the bottom layer i cut it in half and then i cut it in quarters. so i've got four eighths of a sphere. so altogether, that would make one complete sphere. so what is the volume of one sphere? well, there's a formula for that. so that is 4 pi over 3; well r cubed, but let's just say it has radius 1 because there's no reason why not. so i'm just going to say it's 4 pi over 3. so, that'd be the volume of the sphere. now the box that i've made, well we've cut it across and vertically and so on. it would have a base of 2 by 2, so it'd be an area of 4, and then we times that by the height. with a bit of pythagoras you can work out that the height is root 2. so the box would have a volume of 4 root 2. so now to find out the density we're gonna divide the volume of the sphere by the volume of the box. so if we divide through, you might be able to see we're going to get a cancel out here with these fours. the density's going to be pi over 3 root 2. and that figure is something like zero point seven four zero four eight, and so on. and that is where our 74.05% figure comes from. that is the density of these obvious packings. and it might seem obvious that that would be the best way of doing it. i think so. i think it's obviously the most dense. but proving it's the most dense - that was actually quite difficult. so one of the first people who tried to take on this and see if they could prove that this was the best was gauss. gauss, one of our great mathematicians, his name comes up a lot in these things. and what he did show was that this was the best packing, the most dense packing, if the structure is regular. but he didn't show if it was always the best. so maybe there's an irregular packing that would be better than this - that is possible. so this was still an open problem. it actually became a very famous problem. it became one of david hilbert's problems which was a set of problems for 20th century mathematicians. it was his'th. eventually though it was proven in the 1990s by a guy called thomas hales, with samuel ferguson. and what they did is they slightly changed the way we were thinking about this. so i'm going to try and show you what they did. i'm trying to give you the gist of the idea, it'll be a bit hand waving, but we're going to try our best. so imagine a sphere packing in three-dimensional space. it's going on infinitely, and imagine it's as full as possible as well. so there aren't gaps that are big enough to fit any extra spheres in, so this is as full as possible. now each sphere is defined by its centre. so instead of a problem of packing spheres, you can think of it off the problem of points in space. so like a network of points in space. if each sphere had a radius of 1, then these points would have to be at least two units apart. so what they did is they started looking at the local structure near a given sphere. i'll show you the sort of thing i mean. if we had, say, one of the hexagonal packings - let's do that. let's say we have this centre sphere here, the local structure to that would be these six spheres going around the equator. there would be three spheres at the top, and three spheres below it. so that would be the local structure around that hexagonal packing. now, they would give the local structure a score. now that's just a number, there's a technical definition for that, but they would give it a number. now if each local structure has a score less than the hexagonal packing score, then they've proven the conjecture. so that means that the hexagonal packing would be the densest packing. so now the question was, is there a local structure that has a score greater than the hexagonal packing? is there a counterexample? so what they did is they created a list of five thousand potential counter examples. eventually they actually whittled that down a bit to about 100, and then they just checked them. they just checked them one at a time to see the score, and if each one has a score less than the hexagonal packing you can dismiss it. and eventually they were able to dismiss all 100 of these potential counter examples, which means there are no counter examples, and that proves the conjecture. that means that the hexagonal packing is indeed the densest packing possible at 74.05%. and it was a series of papers throughout the 90s, and the theoretical stuff is traditional mathematics. and then when they started checking through these counter examples that was what was done by computer; and this is why they were slightly unsure if the proof was 100% correct. because you can't check the computer's working, really. so that's why they started this project, this 15-year project it turned out to be, where they wanted to formulise the proof. so they turned to their proof into this extremely formal mathematical language, which was formal enough that a computer can automatically check it. (brady: d'you think that's pretty efficient? if you were like-) i think that's pretty efficient. actually, because i know, people have tried to do this experimentally. so if you were transporting grain, or something that's like a sphere, and you just let it loosely settle down. i think you get naturally something like 64%. so clearly if you make a structured packing like this you're getting something much better than that. so the conjecture was finally proven which means that 74.05% is the densest packing of spheres, including all possible regular packings, all possible irregular packings. and it has some rather surprising applications as well. so it can be applied to, if you're looking at the structures of atoms, surprisingly i think it can also be used in how we transmit messages around on the internet today. (brady: i can't see any link there...) this is the first of a sphere trilogy with dr grime. see the video description for more information about the others. and our thanks to brilliant for supporting the series. brilliant is a website, you should know them by now. they're full of great courses and quizzes and all sorts of puzzles you can do, to help kind of well make you smarter. get you thinking about things differently. there's mathematics, science, computer science - and all this content is just so beautifully designed. it's really elegant. it's really fun to do as well. if you'd like to have a look at them, and i recommend you have a look at them, there's lots of stuff for free on the site go to brilliant.org/numberphile if you use the /numberphile, they'll know you came from here but you'll also get 20% off if you decide to sign up for their premium service, which unlocks all the goodies you could want. check them out, brilliant.org/numberphile, our thanks to them for supporting this series