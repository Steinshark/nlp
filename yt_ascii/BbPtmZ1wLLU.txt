the saint rust ramadog this is an update on some things that are going wrong i assume i assume there's some some warnings here if this happens to be about the drama i'll be sad but i don't know what it's about i honestly haven't read it i don't know i just assume that it has there's some malware issues going on so let's find out august 24th 2000 and 223 five minute read research babies all right phylum routinely identifies malware and other supply chain attacks targeting high value critical assets and organize let's see an organization software developers most recently we've reported a flurry of sophisticated attacks targeting javascript developers respawning malware on pi pi or pipel and we're first to identify the north korean state actress or actors publishing and malicious packages to npm with our fairly recent edition of crates io support today we're dealing with a thwarted supply chain attack against rust developers okay okay yikes yikes the staging the campaign okay ooh it's kind of exciting it's kind of exciting i you know i like to read these things in other ecosystems we routinely see a common pattern prior to the publication of large-scale typo squat campaigns interesting an attack type of squats several popular packages in a given ecosystem this makes perfect sense you see this all the time it's like my biggest scare is installing like i always check dashes versus underscores every time it freaks me out this is an ad is this an ad oh i hope it's i i don't think this is an ad but this is typo squad okay let's just say you have a crate called you know called like a foo bar so you squat foo bar right it's just enough for you to think it's something without it being a thing just like if you go to like what's it called what is it openai.com is this actual open ai i can never tell because their website looks like it was written with htmx but somehow even worse than what htmx would do for a while i think open ai didn't actually go to open ai it went to some other ah place right it went to somewhere else and it was totally annoying and then you'd have to go read like google that's the real version oh yeah i forgot it it just always sucks whitehouse.comwhitehouse.gov yeah exactly so that would be typo squatting the attack publishes benign versions of these packages that contain little to no code it'd probably be even better if you publish the actual code and you mirror the project that would be like 5000 iq right i am scared by the light sometimes later typically days or weeks later the attacker publishes an update with some callback mechanisms for communicating with the attacker the attacker publishes additional versions containing more overtly malicious payloads the package publication to creates io were no different though they didn't get as far on august 14 2023 our automated system notified us of a potential typo squad package by the user and mma perf ask me anything perf post grease version 1.0 this one this package was not malicious and contained virtually no code at all here's the main rs file joke hmm this is it this is okay okay the initial state of the package poses no threat to any user that installs it the next day on august 15 2023 the actor published two additional packages in addition to updating the original postgres package the package removed the main dot rso please tell me in favor of a lib.rs okay okay postgres and if config and rv vrv i don't know what that one is i don't know or x rv rv xrvrv i can't even read it if config i don't know that one either it must be if underscore config right following the pattern we outlined above several more packages were released on august 16 2023. okay in these versions a build rs was added now that is where it gets scary this is where yeah if config would have would have treat i still don't know what the problem i honestly don't even know what the problem is right this looks at but when build rs when you see build rs you got to know that that's where it really goes down was added which includes functionality for communicating host information back to an attacker on top of build rs we see a telegram token for a channel id damn bot token doesn't even hide it does it even hide it the package checks out the presence of a file mutex located at envar outdoor if it exists we exit early if it doesn't we recreate it and continue execution next information about the host is retrieved request blocking get this thing json oh my goodness look at all this stuff look at all this stuff look at look would you look at it this common pattern we see with credential steelers in other ecosystems finally the message containing this information is dispatched to the previously defined telegram channel call back platform message format query right here bot token channel id message request blocking get this damn telegram and discord are popular channels used by attackers what happened to good old irc you know honestly great call why aren't we using irc for these sophisticated attacks or more succinct succinctly in these versions the attacker added functionality to send information about the target back to the telegram channel they are monitoring querying the telegram channel using a provided token doesn't yield much information and we are unable to determine if any successful callbacks had occurred so what you might be tempted to ask does this seem so bad or what as previously mentioned this has the hallmarks of early preparations for broader campaign typically we will see one or two paths taken by the attacker from here upon receiving a successful callback from one of their packages the attacker will publish subsequent versions with additional malicious capabilities pulling secret or sensitive files having proven out there sometimes crude callback infrastructure the attacker will publish many more packages very quickly in an attempt to cast a wider net before package registry takes down their malware i mean this would be very hard to detect like i mean the thing is is crates.io how would you ever detect this right you i mean the sophistication of that would be so hard in both cases the attackers ramping up for their attack in hopes of successfully compromising developers the best case scenario is to prevent the attack from continuing in the first place which is exactly what we did reporting to crates io on august 16 2023 phylum phylum phylum made a contact with the rust foundation trademarked stamped it copyrighted to inform them of what appeared to be a staging behavior for can for a malware campaign they responded promptly and informed us that they agreed these packages looked like clear malware and forwarded a message to the crates io team well let's say a short while later they confirmed the removal of these packages and informed us that the user's account had been locked out as a result as one might expect from the rust community this exchange was pleasant and the remediation resulted in a quick removal of the offending packages what's a rust dev to do well actually izzy just don't execute build rs by default yeah but you know what's gonna happen right like the problem is is that isn't necessarily like a good answer to the solution because okay let's just say you have that right it's what are you gonna do well you're going to end up doing what everybody else will do you'll make a flag that says just do all build our asses because i don't want to have to specify each one i'm willing to build and then it will go and do that right you're gonna have some dash r for build all build rs's and then that's what you're going to use and everyone's gonna use it and it's going to become the default behavior and so it becomes this really awful lack of security security and so i've never believed that was ever an answer phylum has a vested interest in the rust ecosystem as where were stations at heart our infrastructure our api our open source cli and our open source sandbox are all written in rust while we enjoy identifying and blocking these software supply chain attacks preventing and mitigating their impact on the rust ecosystem as a direct benefits to the community and so we're far that we're very fond of okay that's reasonable the as most attacks typically occur during package installation or build it only makes sense to attempt to determine whether or not a package contains behavior congruent with malware before the package is allowed to execute thus we've developed a cargo extension that transparently queries the phylum api for information about package before it is allowed to build this extension ships as part of the open source phylum cli and is as simple as this phylum cargo build nice okay i actually think that's a pretty good way to do it i'm on board with that i'm on board with something where you can opt into having a third-party service do that obviously could be a little bit trixie you know what i mean but yeah i like it i mean i like it overall in addition to this long as like long as this thing is open source i assume it is because they said open source yeah open source cli this is good long as it's open source and you can see everything about a part of it to me that's that's pretty reasonable in addition to this we have developed an open source the sandbox that limits access to the disk and environment variables i think they call that docker and we've rolled this into our cli which is available for the npm pip and yarn extensions this adds another layer of protection to the package installation by a building slash installing packages in a locked down environment after they have been verified against our phylum api classic docker right there we are looking to adding the sandbox to other extensions that would be greatly appreciated community feedback nice okay is there someone said there was this was an advertisement this looks great it's hard to say with any degree of certainty whether or not this campaign would have evolved into something more nefarious we can say this is what we've seen play out many times before in many other ecosystems and the outcome was always the same i always felt like this is like exactly the way it's going to happen you know no matter how hard you try no matter how safe your language is they're still you know there's still ways to get around things and so no matter what security auditing all that kind of stuff it's like the impossible feat that every developer should do but nobody actually does and so you know i don't my i i really do actually like this idea of having a third party service because you know what i fat finger some installations and it installs something and then i end up like trying to use it and realize i have to use something else and i don't remember if i ever take it out of my cargo you know my cargo build or my cargo tamil i don't know if i ever take out all those things what happened if i just keep weapon if i'm a victim right now i'm a victim anyways something to think about with access to ssh keys production infrastructure and company ip developers are now extremely valuable target it is prudent that we have a community and remains skeptical of most packages and libraries we use in the software we write i mean maybe prudent is correct but prudent is impractical to make this task easier phylum will continue to scan every package published to open source looking for software supply and chain attacks targeting developers and organizations for their work blocking attacks before they had a chance to get off ground yeah like you know like during gosh not so many months ago remember there was that oss package that was used by a lot of people that would check to see if you if your ip is in russia and if it was it would attempt to delete your operating system i don't know if you saw that but it's like even packages that are quote unquote good put in some pretty they can put in stuff that would be considered a malicious item right that would just delete that would just rmrf you and so you know it's things to think about which is like can you really ever stay up to date always can you really actually perfectly protect yourself we're probably much more vulnerable it's  up yeah it's super up but we're probably much more vulnerable than you realize if it's not an ad it's sure self-promoting yeah sure self-promoting it's about a it's about a company i mean but think about it just take a second here and think about the good they're actually doing though you know never doubt a company never doubt a company that will talk about itself when it does good okay it's gonna always happen but really the fact that they're doing this think about how many shitty packages make it onto npm think about how many millions upon millions upon millions of packages are on npm right now right you know that's crazy it's crazy and so they built a surface that scans and does stuff to it and keeps track of it and tries to come up with a way to be able to identify it i don't care if they self-promote they're also providing what i would argue a net good i'm again i'm only looking at what they're saying right here okay i'm not looking at anything else i just assume that this very obviously self potentially aggrandizing article is purely about all the net wins that they've had this is still a huge daunting task and i'm happy someone's doing it can we all agree that this if config business how many people would have got hit by ifconfig how many people right it would have been wild it would have been wild right so i can appreciate that i can appreciate that clappy clap clap clap clap clap not me don't do rust not my problem message i know so no one rust in production doesn't exist and got him remember guys eighty percent of security issues can be solved by simply allocating five minutes of your work to do trivial tasks i'm not gonna lie to you that statistic sounds made up and that's probably fake but it's probably not a bad idea to do trivial things okay this is great this was actually a really good article and i'm actually shocked that like postgres with two s's easily typo if if config this one seems like the biggest one i would have definitely been had right there you know what i mean easily been had by that one maybe not so much this one two s's is kind of hard you know i think if you're gonna do a a a mistype you you don't want to go with double characters especially at the end you definitely want to go with something that's like uh post grease right you want to definitely you wanna be a little bit more sophisticated right you want it to be a swap of lettering not necessarily oh or you know post grease queen ql right you you wanna yeah or yeah postgres yeah post aggress ql would be a good one because that seems like something people could easily mess up right you want a little bit you know you'll want a little bit you want you want to feel good about it post geese they're running a long con i introduced fake malware into various packages managers to get people to install them they're rappers for security three introduce malware into their security rappers for profit ooh the long con i never even thought about that the ultimate con is the p i mean it it makes sense historically speaking anyone that promises you peace or safety or security from any position of authority has almost used that promise of peace safety and security to oppress people it's almost classically the number one number one way people come into power is that kind of promise and so this i didn't even see it it's right there in front of me this whole time the longest con of all time gosh it's the ones you trust the most the name is the primogen