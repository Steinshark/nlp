what steps have you taken to find out about this i i ran it on my own machine actually that's not quite true i ran it on a virtual machine so i installed a virtual xp machine unpatched from this current patch it wasn't connected to the internet i downloaded the w to cry xe and ran it and my fathers encrypted and it popped up the warning message this isn't something people should try at home right i no i would i would advise against it right so there's nothing there's nothing inherently scary about the software in the sense that if it's not connected to the net it won't propagate and if you don't have anything valuable on your machine you aren't going to lose any files but on the other hand i'm not running it here on a university network because i don't want to be the first person to introduce it to nothing him so you know just on the off chance right so let's not let's not open that door so where do we start on this mess what what is it okay first of all what's it called so i call it w a decrypter or w a crypter it's been w a cry one a cry one a cry w a crypter w a decrypt one to decryptor 2 as far as i can tell the source code has one a cryptor in it a lot of people shorten this to one a cry and there's this sort of wnc y extension that it uses for its encrypted files which are which kind of spells one cry so yeah okay so i don't know i'm calling it wac crypter but i might just not mention it by name again because we all know what we're talking about it's ransomware right so ransomware is any troan or worm or virus that in essence encrypts your files and then tries to charge you money to reverse that process without giving them too much credit for obvious reasons it's a fairly smart way of of performing crime because if an antivirus is not immediately on the ball then the damage is already done and a lot of the time you won't get the key back unless you pay and so you have to then either restore from backup which a lot of people don't have and or you have to accept that your files are gone or you have to pay and so it's no surprise that sort of the biggest stuff in the news recently in terms of attacks have been ransomware because of the immediate impact they have on standard users there are lots and lots of other kinds of malware you know banking fraud malware and key loggers and things and botn net code which is also a really big problem but perhaps to seize less news because it doesn't attack the nhs for those of you that don't live in england you might you know not know a huge amount about the ns v national health service is our taxpayer funded health service right so we all pay taxes and then those taxes contribute to health health service and we all get health care perhaps we all need to calm the rhetoric down slightly you know the nhs itself is not under attack the nice thing for the media is if you if you can have your headline say attack on the health service then you're going to get a lot of hits right so that's the first thing that's happened and in fact actually only a small subset of of healthcare machines have been taken down by this ransomware and a lot of it's been precautionary so bring down a server just on the off chance it gets it until we can be sure but nothing on the same network has the has the trojan ai worm on it so yeah so it's it's a big deal and it's infected a lot of machines but there are a lot of other big ransomwares out there right crypto wall had made millions of develop of dollars for its developers for example so this isn't the only one it's not the first and regrettably probably won't be the last let's talk about a bit about what happened right so on friday various machines started being infected by this now the exact nature of the initial infection i don't think is known right now it might be by the time this video goes out right so maybe i'll be out of date already but probably emails right so which makes it essentially a troan because an email goes out with a with a spear fishing attack or a fishing attack that sort of says you should click this for whatever reason and tricks a user into doing it now you don't need to trick many users to get a return on your investment in some sense because once they get infected that's a lot of money this trojen or this worm is a little bit unusual in that it actually carries a self-replicating payload most ransomware doesn't do this most ransomware the idea is basically to email as many people as possible some of them some small subset of them will be tricked into clicking it they will be the ones that hopefully pay the ransom that's the the logic of it this one uses an exploit that was first found by the nsa and exploited windows so this vulnerability has existed in windows for quite a while i mean it's exists in windows xp that was around in 2001 and so on and it seem to have disappeared sometime around windows 10 right so it was patched in march and we don't know if i think the vulnerability doesn't already exist in windows 10 so so it was patched in march in in windows 7 yes and for any for any operating system that microsoft is currently actively rolling out patches for which is to say windows 7 i don't think windows v anymore there are plenty of copies of windows rightly or wrongly but still have this vulnerability now this is a vulnerability in the smb protocol which is usually used for file sharing across networks very common because you imagine large organizations like to share files from a central server to all their smaller machines rather than having everyone store all the files all the time so what happens when this worm lands is so this worm will start with an email probably or someone will actually deliver it by usb that seems less likely but but probably an email you only need one person on the network to click on it and they get the ransomware and then it starts to sniff out on port 445 for other unpatched installations so this is a directed exploit which will be able to run this same code on the target machine and then they spread and so on and that's why it spread so quickly this runability was discovered by the nsa quite a while ago five or six years ago we think we don't know exactly because they don't tell us and rather than tell microsoft about this exploit they decided to sit on it with the with the idea that they could then use it in their own exploit so their exploit kit became eternal blue that's that's the code name for this particular exploit and in some sense no more was heard about it right for for a while it probably got used by the government agencies to perform their c terrorism tasks and so on until they were themselves hacked by another group called the shadow brokers who decided to try and sell some of these tools and then just released them on the internet so microsoft patched this vulnerability in march and then in april the shadow brokers released eternal blue the code for it onto the net it was only a matter of time before someone put this onto a self replicating piece of ransomware right because and the quicker you do it the more people who are still unpatched that you get right and then damage and shoes the key difference really with this from this ransomware to the previous ransomware that we've seen is the fact that it can self-propagate right sometimes these things get built into self-replicating programs but in this one this eternal blue exploit essentially means that your machine if it's not patched you you don't have to click yes right another machine will will upload the payload to it and it will run it no questions asked and it might if you're running a server which has shadow volume copies and things and backs up back up and restore it might ask you for a a yes or no response later in the process but a bit late you know after a lot of things have already been encrypted so most trojans if you're very vigilant about running email attachments you'll never get them because you just see oh it's a troan or it's it's i don't want to go go to that website it looks malicious and so you don't you don't get them even if you don't have an antivirus but if you haven't got this update you can still get it despite the fact that you haven't done anything apart from perhaps being a bit lazy about your updates sometime over the weekend obviously lots of researchers were looking into this into this not so i i was looking into it and running it purely for interest right you know i don't i'm not writing any tools to get rid of it or anything anything clever but there are lots of researchers so what they will do is they will run this in a virtual machine or in a special sort of samp box where it's isolated find out what it does and try and work out how they could stop it try and work out how they could take the role of a command and control server for example and tell it just to to stop or something like this now a researcher malware tech who whose blog is really interesting and we'll link to it in the bottom they basically stumbled across for kill switch for this because they were looking at what it did and it pulled this it checked for the existence of this unregistered internet address so it basically said it did a dns look up and said who is this who's got this internet address and no one had it so their first response was well if we register that internet address we then get communication from all the installations of this and we can sort of track how many people have got this it's it's interesting from a research point of view we can see how it's spread but in fact what actually happened within the code was if it if this web address existed it just stopped running the hypothesis is that it's doing a kind of volkswagen emission situation where it realizes it's running in some kind of lab environment and shuts down but basically as soon as they registered this web address all future installations of w crypta w decrypto shut down immediately upon starting up which was obviously quite good news so inadvertently they they saved a lot of people a lot of time and effort and maybe money that isn't the end to this story i mean presumably people have seen that that yeah so there's been multiple versions of this with tweak settings and different where they probably rem i think they've essentially just tried to hexedit out the kill switch and run it again right and and yes that's that's not unexpected maare tech said this was going to come it's very it's to be expected because the code is not difficult to change to avoid the whole kill switch right obviously their their attempt at circumventing some of the researchers abilities has failed and it's inadvertently reduced the impact of the virus or the worm so they'll just release it again and they'll send out another huge bunch of emails now hopefully people are now aware this exists and people are aggressively updating their systems and it will have less impact but some people are bound to get it again i think china is being hit pretty hard today it's going through china at the moment so it tends to sort of hit networks and spread about until people sort of realize what's going on and put a stop to it not everyone has got this right i haven't got it right you haven't got it no one are notting as far as we know has got it and that's because these smb ports are blocked internally by our firewall as they're coming in they're blocked so you an an infected nhs machine can't target a university of not computer because the ports are blocked many of the networks would have been compromised and networks where a machine inside the network has been compromised and it's spread around the internals of a network the majority of ransomware is aosion in the sense that it it masquerades as something else and appears on your computer usually through an email attachment this one is both aosion in that sense because that probably is probably what happened here but it's also a worm in the sense that it can propagate out itself using this exploit so this eternal blue exploit already exists and was known to the nsa for some time it's already been patched but a lot of people aren't installing updates as vigorously as they should be and also microsoft aren't routinely putting out updates for windows xp so anyone running windows xp and also now windows vista and so on will won't have had that update because it that's not what happens now in in a sort of unusual move microsoft has pushed an update to xp because of this of severity of this but that's unusual if you're running xp the first thing you should do is turn off your machine because you've got no business running xp but you aren't going to get many updates because that's not what microsoft are doing this is a bit like having a car that nobody makes parts for anymore it's exactly like that in fact a good analogy i think is is so people are blaming microsoft for this there's a lot of blame to go around microsoft shares some of the blame but in some ways what's happened is we're all driving around in 1940s fords and then when we have an accident we're complaining that the airbag didn't go off well there isn't an airag in the 1940s for that's why right so unless you take it into the garage and have one installed you know it's that kind of principle so yes microsoft wrote an operating system with this bugin right all operating systems have bugin all software has bugs in they patched it quickly and they they found it they patched it in march it's not in windows 10 anyway and they've aggressively put out patches for leg operating systems to try and combat it so they've at least trying to take all the steps they can to solve this the problem is that organiz big organizations like the nhs have legacy software let's say that drivers for scanners and you know mri machines and so on that maybe they bought 10 20 years ago that are still running xp because the software isn't compatible with modern versions of windows that's a whole a whole political issue that i i don't you know i don't know i don't have all the answers for so the cia leaks a few months ago showed the cia also has a sort of should we say a back catalog of exploits that they keep a hold of so the nsa and the cia will disclose some problems they find but if they find a bug a normal security researcher will privately disclose it to the company for them to release a patch and then will publicize it later partly for sort of media purposes and partly because then it encourages people to install the updates the nsa and other government agencies don't operate this policy all the time because they view some of these exploits as useful for combating terrorism and other criminal activity now that may be may or may not be the case but what's happened in this case is they've allowed themselves to be hacked by another group who has had no ethical concerns in just releasing all of it right so this actually goes neatly back to our endtoend encryption talk because i said that what you're doing with with introducing a back door is introducing a very big point of failure well that's exactly what's happened here right the nsa didn't tell anyone about this because they felt they could privately use it for the of of their country and that may have been the case but it's not the case anymore because someone's hacked them and released it so that's a huge problem when that sort of thing happens so there are already people i mean microsoft themselves in their blog have mentioned this already and ross anderson mentions it in his blog and we'll link both of those in the bottom that you know you can't they can't wipe their hands of this entirely they can say well you know we're doing this to counterterrorism but in some ways this is also their fault because it was their exploit that's been used the headlines today are all saying it's a wakeup call well really people like ross anderson and other security experts have been saying this for years right this isn't the first time we've noticed that old machines are vulnerable to attack so yeah maybe it's a wakeup call but people need to be aggressively installing the latest operating systems and updating as far as i know you can't turn off updates in windows 10 and that strikes me as quite a good idea because people will turn them off oh i don't want it to reset right now i'll turn it off and i'll resume it later and that's when they get hit by buy a piece of ransomware emergency breaking who sell in future the robo chauffeur which will actually drive you to work while you're sitting there packing some code and so you've then got the technical problems and the business problems of how do you produce software upgrades which marry