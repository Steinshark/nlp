we'll talk about one theorem that i learned when i was in high school and the seemingly miraculous methods to solve it which is my favorite thing from the training for the international math olympiad back in bulgaria the theorem is called ptolemy's theorem and the method will wait a few minutes before we get there well, let's start with something that everyone knows. what is the theorem brady that you think everyone knows? in geometry brady: pythagoras zvezda: absolutely. well, what do you know about it? brady:even i know this one a squared plus b squared is equal to c squared zvezda: all  people know this theorem, but do they know how to prove it? so ptolomeny's theorem is somehow related to this one so who do you think is stronger ptolemy or pythagoras? stronger stronger, they're both greeks well pythagoras is more famous that is true, but they have to compete with each other and we shall see i need another brown sheet already so we're going to draw a large circle we need four points on this circle they form our so-called cyclic quadrilateral it just means they lie on the circle and you can also draw the diagonals what would ptolemy tell us about these six segments? it's very beautiful it says if you multiply the opposite sides and add up those products you will get the product of the two diagonals so a b times c d plus a times b c must be equal to the product of the two diagonals ac times bt and this is what? ptolemies theorem tells us and it doesn't matter where those points on the circle as long as they in this order he's gonna work so this is a property about points on a circle now, let's see i said that pythagoras in ptolemies are related stronger if i can prove pythagoras knowing ptolemies theorem the thalamus is stronger okay so it would be like a parent or yeah soap ptolemy would be a parent of pythagoras it is possible certainly so if i draw a right triangle and then take exactly the same triangle and flip it over what kind of a shape do you think brady? i'm going to get mmm a rectangle it is precisely a rectangle so we have abcd for the vertices now a rectangle is a very symmetric figure it has all right angles, obviously so if two diagonals also happen to be equal then moreover they are intersection. oh, is it equal distances from each vertex? mm-hmm, so they must be on a circle those points exactly but there soon as we have four points on the circle. guess what happens? ptolemy you say yes potala me would kick him. yeah so now let us let us backtrack a little bit we started with the right triangle. let us name it sides a b and the diagonal will be c okay, but then this side should be a and this side should we be in the other diagonal should also be c mm-hmm. let's hit this picture with ptolemies so what do we have the product of the opposite sides a times a plus the product of the other opposite sides me times b must be equal to the product of the two diagonal c times c. hmm does this look like a theorem we've seen before it looks good. that is precisely the pythagorean theorem which means that ptolemy is stronger pythagorean theorem is a special case of ptolemies theorem, but ptolemies theorem can do a lot and so we create a new method today actually, i've known about this method for a long time that will solve thomas theorem so actually ptolemies can be proven in many different ways. if you google you will see lots of different proofs you will see a proof in plane geometry which is beautiful, but very tricky to come up with you can see technical proofs using trigonometry who likes those or using even complex numbers very sophisticated but none of these approaches really shows the true elegance and simplicity of thomas theorem none of them shows you why it is really true the new method that we will talk about today called inversion in the plane looks originally like a mysterious black box because it will turn our circle and ptolemy situation into something that the third grader can tackle so it will turn this whole picture into something very simple only three points that are lined up a1 b1 and c1 hmm, what could a third grader tell me about this picture? what is true brady? i in bay and then they and say makes a whole are correct if i add the two shorter ones, i must get the longer one look back at ptolemies theorem we are doing something similar. we're adding two things on getting a third one. what? indeed this be the same situation which in a different world in an inverted world and the answer is yes so what is inversion inversion is obviously some transformation of the plane it's same point some points to some other points so let's think about other transformations in the plane that we all know so what would be one that you brady have heard about like reflections and things that is that we doing correct? yeah, you can reflect across a line. yeah, that's not so perfectly good transformation. how about this one? that's called rotation about a point definitely how about this one that's called translation and there is another one when you click on a map to expand it to zoom it out or zoom in that's what's called a rescaling or dilation. so suppose i draw an elephant what do you think will the elephant look after each of those transformations? would it look like a rabbit or would it look like an elephant? it will keep its elephant nests, correct? it may kind of flip-flop but it will still look pretty much like an elephant. well, our inversion is a completely different anymore because we saw how it's transforming it's a circular picture into a linear one so it moves or something horrible two shapes if you take your nice elephant and hit it with that inversion what will turn out in the end is something that might look like a lot in shu from the movie completely ridiculous, so we need to have control over the situation what is going on? so for an inversion you need a circle into the boss. you can draw the circle anywhere in the plane you like and as big as you like ant we mark its center oh, let's say we take a point outside of this circle x. where will this point go? it's like a small algorithm here. you start to the point x. we connect it with the center. we draw a tangent through x until it hits the circle at t and then we draw a perpendicular to all x so our point x if it is outside of the circle will travel into the circle into x y this actually can happen on any point in the plane for instance if we take something very close here and we stiffy we connected to all we draw a changin and we drop a perpendicular that will be where y1 will go if i take any point outside the circle, where do you think it will go? it looks like we'll go inside the circle correct that can happen to any point outside the circle now we have more points to worry about what happens if you start with a point inside the circle well, we want to be consistent so the logical thing is to reverse this algorithm if i take a point z well i still need the ray through xion all because everything important looks like it's gonna lie there but then i have to backtrack and erect a perpendicular at z to this ray hitting the circle and finally drawing my tangent to the circle until it intersects our original array pinpoint z 1 so if you start inside the circle you go outside of the circle. that's what inversion does to you ok mmm, i think we're still missing a few points which points did i not talk about? the ones on the circle, correct? so suppose i take a point about u so u is on the circle. i'm going to treat it as if it is a point outside of the circle so we're going to apply our first algorithm. we connected to all next if you remember i'm supposed to draw a tangent to the circle through that point. ok. well, the point is already on the circle so it's just kind of kind of easy and the tangent will intersect the circle in our next point. oh, but that's boring to you already ok, and next i have to drop a perpendicular to my line until it intersects that ray ok, i'm gonna drop a perpendicular to this line but i'm already there so i literally have not moved from you so any point on the circle is going to go into itself and that kind of makes sense you will take outside of the plane thus infinite plane and you will squash it inside it will take the inside you will parade outside sprayed it all over but the points on the borderline are gonna stay fixed and not gonna move anywhere what happens to the center? the center looks like it's an inside point so we should apply our second algorithm, but can it possibly work? that center is a very strange point so the first thing we have to do by our second algorithm if you remember point z we need to connect it to the center. well, how do we connect it to the center? it's already one point how do you draw that? right? yeah, i don't have a ray here so we are already kind of stuck with our algorithm but maybe you'll say it doesn't matter which ray they just draw a random one. okay. there you go no problem next i'm supposed to erect a perpendicular certainly. no problem. i'm supposed to draw a tangent to the circle until oh we are in trouble. it's parallel. they parallel there is no way these two lines are going to intersect so you may say oh it goes somewhere it's infinity. okay in that direction, but what happens if i chose a different direction? it's gonna go in that direction at infinity for our purposes of proving ptolemies theorem we don't need to even bother with the center of inversion we will not define inversion at the center when you're asking. oh that that doesn't seem right. it should be defined everywhere beg your pardon if you for example know anything about functions one of the first function that would look like this is f of x equals to 1 over x brady. can i plug in any number here? i think we're in trouble we can't we'll do there so this function is not defined at zero, but it's a perfectly good function and you can see it all over the place so why not leave inversion not defined at the center now when i in middle school, they used to tease us with the following question. how can you catch all lions in africa? alright we'll build the fins are really strong fans around the circle where would you like to stay brady outside the circle inside the circle? i want to be free on the outside. oh that's where the lions are. so you're gonna make sure that inside the circle. there are no lines. i thought i was alone oh, well, okay only i want to be away from the law. okay, so you stay inside this lion? free circle and then you hit the world with inversion so all the lions outside they'll come in, but you will be safely outside and observing them well, i don't know if that's a worthy goal but you see the excitement of fifth graders how much they could foresee the power of inversion what are the basic properties of? inversion, we already saw a few of them points outside the circle go in points inside go out but do they do this randomly what happens if i apply inversion twice in a row? so point x from the outside is going to go into point x1 on the inside but if i do this, once again, i'll simply reverse my algorithm and go back to x so what happens is that? points in the plane are sort of married and they flip-flop from inside and outside. they have their chosen partner and all they can do is flip flop the only points that the singleton are those on the circle they stay put and oh we don't touch it we agreed so applying inversion twice in a row will simply not do anything to the plane it will keep the points wherever they are. this is super important because if you take your elephant and invert it to allah didn't show what would happen to not ensure if you hit it with inversion it will come back in resurrect itself as the end of they need another sheet you're gonna ruin these bows we saw that ptolemies theorem was originally situated on a circle, but miraculously that was turned into a lie now i want to know what happens to lines in the plane, but now some lines will be more special than others some lines will go through the center of inversion and other lines will go not through the center of inversions in different things will happen to them in each case now let us look at the first case where they go through the center if i take a point outside on this line, it will go inside the same line - its twin exactly, and then we'll flip flop the outside part of this line will go inside and the inside is going to go out and the points on the circle will just stay put of course we said we're not gonna touch the center of inversion so we don't care about it, but by and large they go to themselves, so they will still be lines exactly the same lines. you're not gonna see any difference before and after inversion so if i took all the points on the line and inverted them, i would draw the same line exactly well, that's pretty nothing happened to that line. but if the line is outside the circle or inside but most importantly not going through the center of the circle something wild is gonna happen. let's experiment so i'm gonna take a point x on this line connect it to the center draw a tangent drop a perpendicular. all right. well so far no surprises i knew that x was going to go inside the circle. mm-hmm, but let's experiment more now i'm going to take another point y draw a change n't and drop a perpendicular this is y1 so far. i don't see any surprise. do you think this line is gonna go into a line here? could it possibly go into a line? i don't think so because there is no line inside the circle. it's gonna be just a line segment at best but is it a lies? let us experiment we z draw attention and draw a perpendicular we already see that the points inside the circle and not anymore lying on the line on what shape do you think very did they lie? i reckon i can guess now yeah, i guess well, i reckon, we're gonna get so cool. yes, but what kind of a circle circles are of two types? they either pass through the center of inversion or they don't what did you guess will our circle pass through or will it not i think what i know because you told me oh, it doesn't map to anything. so oh actually matters a lot we just don't touch it. it's like the king who does not participate in the battle, but only oversees what's happening okay. now i can draw maybe one more point but let's try to draw it far away from oh maybe that will give us a clue. what happens to points that are far away from all where do they go? and the inversion close to o or far away from all now. remember those lines in africa the further way the lines are from our fans the closer to something they will go i am getting close to oh closer and closer and closer and you can go infinitely far away and you're gonna get infinitely close to our so actually if you continue doing this you will clearly see a shape of a circle now, of course, my picture is drawn by hand. so it looks more like an ellipse, but definitely you can see that that's not a line so it is a theorem that a line that does not go through the center will map to a circle that goes through the center. okay, and that is fundamental now it looks like we still need a lot of ground to cover but do we now how many circles are there with respect to inversion to? they either pass through the center of an version or they don't but i already have one the fastest. it's right here what do you think brady happens if i hit that circle wooden version you get your lawn back exactly absolutely, because doing inversion twice is gonna get us back where we started let us summarize so far lines through the center go to themselves lines not through the center go to circles through the center and conversely circles through the center go to lines not through the center. are we missing one type of figure here? i think we are and this is circles that don't go through the center of inversion a circle not through the center of inversion goes to another circle not through the center of inversion and in fact, that's a theorem and it can be proven using pairs of similar triangles just like any of the other theorems in this talk. we know properties of inversion now, we're back to thomas theorem let's see if we can prove it at our first attempt. so what i have here is our cyclic quadrilateral in other words four points on a circle and we are trying to prove something about the sides and the diagonals as palomas theorem says we want to simplify this picture. how can we simplify? obviously lines are preferable to circles they are simpler to work with can i turn this circle into a line yes with inversion, but i need to choose my center of inversion very carefully because different circles will go to different figures if you remember if a circle doesn't pass through the center of inversion it's just going to go to another circle that doesn't pass through the center of inversion and that's no use to us however, if a circle passes through the center of inversion schooner miraculously turned into a line through the center of inversion so where should the center of inversion be if i want to make a line out of this circle? what do you think brady? well, you've got infinite options yes, but there is one place where it must be it must be somewhere on the original circle for tommy so that the original circle passes through the center of inversion. yeah. all right. so let me just take something symmetric here looks oh excellent. now you are thinking i should draw the circle of inversion i don't have to actually all i care is about the shapes of figures after inversion not exactly where they are located so at any rate this circle through the center of inversion will turn into a line not through the center so i can just be bold and draw a line not through the center of inversion and declare that my circle goes there. why not now? we want to quickly figure out where do the points a g c and b go? you may be thinking well now i need the circle of inversion in order to do all of these tangents and all of these perpendiculars now we can be efficient. we can apply a little bit of logic for instance take point b. i know that point b has to go somewhere on this line because it is on our blue circle okay, so it has to be somewhere but also i know that it lies on array ob because that was our first step of the algorithm for inversion, so it has to lie both on this ray and to now align l so i think we figured out its here and the same way we can efficiently find the images of the other points so our cyclic quadrilateral now gets flattened on to a line and i do want to give a warning here i'm not saying that the size of the quadrilateral become line segments now, they will act become arcs of circles. most likely i am saying that the vertices are now lined up on the line great do you think that's really the best we can do it inversion? because a while ago i promise that inversion will make this picture look something that the third grader can cope with three points on a line and then we are adding up the two shortest segments to get the bigger one well, i mean you've got four so you could you could do that's not for a third grader now there are too many segments floating about here we really want simplicity and elegance okay, so we have to go back again to our choice for the center of inversion even though we are on the right track to choose it on the original thalamus circle meaning we're just a little bit too sloppy where exactly to place if i want to eliminate one of those points where should all be on one of the points exactly because we're not gonna even touch it we're gonna leave it there and forget about it as our center of inversion so since we promised we're going to end up with points a 1 b 1 c 1 which point shall we lose? g that's right. that is exactly where we want to place our center of inversion? now we have to cut and i have to draw another picture because i cannot just to copy. it's too messy our first attempt failed, but we don't give up the blue circle is now going to go into a line l but we have only three points to map points b c and a so we've got a 1 b 1 and c 1 okay, great. so that was what inversion promised us we can get it to this simplified situation. and we do now that if i add the length segments the two shorter ones i'm going to get the longer one a 1 b 1 plus b. see one is a 1 c 1 mmm so, what did we talk about what happens to distances on the inversion? no, we didn't but i actually need exactly to know what happens to the old distances here, i have 6 of them that participate in thomas theorem in terms of the new distances have a scale exactly, and we know that inversion is not like dilation or a scaling of the plane. he does actually quite horrible things to points for example, if you have two points that are very close to the center of inversion each of them is going to be mapped very very far away and that will enlarge the segments drastically so we need to derive a couple of formulas that will tell us exactly what happens to distances on the inversion so let's get started. this is the circle of inversion a point x outside the circle there is something that we have overlooked here there is a segment that is missing which one it is segment ot. that is super important first of all, it's hour long that's the radius of inversion but there is another i tango every time you draw a tangent. it is perpendicular to the radius so now when you look at this picture, you see a bunch of similar triangles there are three triangles in this picture too small and one large and they are all similar because they have the same angles i'm interested only in two of them in this small red one and in the large one. so, let's see what they will give us triangle oh t x1 is similar to triangle o x t and you can check that the right angle so matching so what do i need from this? i need a ratio of segments all t2o x1 is equal to o x2 all t all right big deal, but you know what? oh, geez shaymin, it's the radius so i can simplify this to multiplying the two distances from the center oh x and oh x 1/2 the radius squared which is a chi squared and this is our first distance formula in other words all the distance from the center times new distance from the center is always fixed it is r squared which actually explains the phenomena white points close to the center gonna be mapped very very far away because those two distances all the new have to balance each other to multiply to r squared so if one of them is small the other one has to be large and vice versa. okay, that's formula 1 now we need formula 2 right here so what we have here is another inversion? we really need to know what happens to any segment and the inversion not just two segments that contain the center because we found formulas for those but not two random other segments so what we have here is point a that goes to a 1 and b goes to b 1 if you want the weird the circle of inversion is it's somewhere like this in between them, but who cares about that? we don't need it. now again. we see two triangles here do you think they're similar the answer is yes, first of all, they share a common angle. that's good news and now what do we know about? these distances from the center we just had a formula if i multiply away or a 1 that will be the same as ob or b 1 but that turns into a ratio oh a to ob is equal to o be 1/2 oh a 1 obi-wan kenobe, right what we have here is a ratio of sides plus an angle makes two similar triangles and we can now read defects of this similarity we can well leave off defects can we say that report not to leap leap? when you are you're gathering the harvest we can okay, i can treat the effects. okay? we can read the effects of the similarity. first of all, what are the two triangles? we are talking about we have triangle oh a 1 b 1 is similar to triangle. oh but it's not gonna be it's gonna be b because the points flip-flop in this ratio, okay so now what i'm interested in only is the new distance between the points in terms of the old one so let's use some ratios a 1 b 1 over or a 1 is equal to a b over ob, all right that looks like a mess but we're gonna resolve it we're interested in the new distance a 1 v 1 so we solve for it. we push away one to the other side. we get a b times oh a 1 over ob now. this is a complete mishmash of new and old distances i have new distance a1 b1 here. i have all distances. i don't like this one. this is new i want my new distance to be completely expressed in something that happened before inversion so i have control over can we replace all a 1 the answer is? yes because we had our first formula that if i multiply the distances to the center of inversion this is always r squared so from here all a 1 will be some ratio of the radius and all a and we can simply plug it in and get this looks like a messy messy formula, but we really need to understand what it says all right, so it says new distance is equal to its predecessor the old distance times always r squared over all the distances to the center, so everything is expressed in terms of the world before inversion we are ready to finally prove ptolemies theorem. thank ok but you have to be excited how all of this misses stuff actually rusev i know you're excited, but you're not the one who is to edit the video afterwards okay final attempt, we are proving to ptolemy theorem, yeah, but we will apply our distance formula three times in the inverted world inverted world means really this red line here where everything mapped on the inversion so we have a 1 b 1 plus b 1 c 1 is a 1 c 1 now these are new distances so we can rewrite them in terms of our formula so new distances were the old distance times the radius squared over the old distances to the center, but the center is not all real its d so we will be talking about distances from a and b to the center, which is d in other words a g times b that alone is a1 b1 and we continue in a similar fashion we have all distance, bc times radius squared and then distance is true the centre which is g and finally ac times r squared over distances to the center hmm brady, what would you like to do when things repeat get rid of them? that's right so what do i get rid of them? you must be applicable if those are squares, correct? we divide everything inside by r squared and we miraculously understand that the radius of inversion did not matter here we just got rid on it ok next who likes denominators. can we get rid of them true? the answer is yes we just have to find the common denominator those three fractions now, they share a few things they have a g twice and c d twice and b d twice. so we will multiply everything by ad times bd times ct. that's the common denominator now if i multiply this fraction by this product we will in essence cancel the whole denominator and the only thing that will be left multiplied is cd so that cd must be multiplied by a b so we end up with a b times c g. does this remind us of something? ad times cd we have just multiplied the opposite sides of our cyclic quadrilateral this looks promising let's see if the rest will match bc from the numerator what's missing here? i think only a d is missing ad bc times ad opposite sides and that is equal to ac one of our diagonals times what's left bd the other diagonal we are done we have just shown ptolemies theorem is that easy? well, it wasn't an easy proof in the sense of the ideas that were used because inversion is definitely not easy and it is not a natural thing that one would just try on the spur of the moment but the actual computations and the proofs really boiled down to similar triangles and operations with fractions as well as realizing where to take our center of inversion. that was a key point it was worth away now you ask. is there anything else? useful that ptolemies theorem can prove the answer is yes not only the pythagorean theorem follows from ptolemies theory but a couple of really cool facts, let's look at them well, we've come this far why not watch the additional footage showing how ptolemies theorem reveals a link between pentagon's and the golden ratio so one of those rules is utterly impossible we've also got a little bit of extra footage about inversion in fact, this kind of property is used very often in solving problems with inversion thank you for bringing it up and if that's not enough you can go back and watch number files classic video about epic circles links are in all the usual places on screen down in the video description