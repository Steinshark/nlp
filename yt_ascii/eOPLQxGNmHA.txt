there's been this article recently a report about a hardware hack i just thought the interesting sort sure about what you think about it and whether it's something that is easy to do or always possible the original article alleged that certain servers being supplied to companies were being doctored for developers with extra hardware being added so that they could then be used to exfiltrate information from the companies. the report seems to have been discredited quite heavily by other parties whether it actually happened or not. i don't know. i'm not seen any of the servers i'm not a hardware or cyber security expert but it's certainly an interesting question to talk about well, what would you be wanting to do? and why would you want to say perhaps do it in? hardware so, i've got a server motherboard here so it's a standard machine but often servers come with extra support to make them configurable so this is an intel xeon processor and this is a for management control when installing lots of servers you will put them in racks of places in your data center you've got necessary storage cooling and things and one of the things you don't have to do is when something goes wrong you need to reboot your machine to have to sort of find out where the machine is turn it off and on again plug a keyboard and monitor in it to do any sort of maintenance on it so what modern servers do is they have these chips on there which generally computers in their own? right and they enable you to connect to the machine? even when it's switched off and do certain things with it, like turn it on turn it off and even interact with it so i've got a machine at home with all of these things in and if i just bring it up i'm now connected to it and it's got those things so i can look at the sensors see what the fan speed is i've got options to turn it off. turn it up. turn it back on again reset it on some of them i can either reflash the bios or the uefi in this case and generally managed to the server and to the full extent that i can actually bring up effectively a virtual console a virtual keyboard and display as it's done here where i can interact with the machine so i could login put a iso image of a cd or a dvd in there and install the operating system why would you be wanting to do this? and why would you decide to do it via hardware rather than just getting someone to run some malware? and so we need to sort of clot back and think about this. so the alleged what's happened, is that the third party? needed this decided they wanted to infiltrate hackney computers hackney computers made up an identification with actually be the company's live-in go to see should be animals were harmed in making this completely absurd hackney computers that ordered i say several thousand servers and so because when you're building that menu it's going to be a special order so, you know probably who they're going to and the the story goes that an extra chip was inserted onto the motherboard of those machines that were destined for hackney computers, i fully believe that it's possible to do this i think there's enough ways. you could connect things and actually what we want you to do we want you to get our code running inside their environment now if you think about a traditional companies where they traditionally lay out their data centers and their networks is that you'll have a perimeter firewall around things to stop things getting in it's a bit like the old fashioned medieval castle right once you're inside the castle wall you've got a moat around it and the drawbridge of the trough was just pulled up then you can't get in but if you've got someone inside already perhaps is away by a shining light shooting an arrow over the walls that they could communicate one possibility is that they've added a little bit of extra code into the board management control and that ship contains that extra code and then they've got a machine ok very low powered one on the inside of the network while that forward management control of the bmc is likely to be on a network which is limited in what it can connect to it's probably likely to be able to connect to other board management controllers on the same network and of course as we've seen you can connect to the board management controller you can then log into the machine. so one potential thing is that they use the board management control in the same way that we might put a raspberry pi or the cheap computer on the network and then we can use it as a staging pose to connect to other things these board management controls that can also do things like flash the bios? and so it's potential that actually this is used as a sort of a staging post to actually attack the machine itself and again, i think you would we have to assume that they didn't actually know what was going to be running here they could probably hazard a guess at the operating system and unlike the board management controller that machine probably is likely to be able to connect directly out to the internet perhaps to download software updates and things so normally when a machine is running you have different modes a cpu can be executing in you have a sort of mode where the machine has access to everything and that's where your operating system works and depending whether you're on x86 and armor six eight thousand machine it might make me known as ring zero kernel mode supervisor mode but at that level you've got full control of the hardware the machine if you can do that you can then stop it being seen by people using the machines you can hide it sort of rootkit as it tends to be known but you think i'll probably get it running as supervisor mode and there's two ways. you can do it one. you can find some sort of exploit some part of the operating system that isn't well written so that you can get it tricky to start running your code and so that's where you see the sort of exploits things you find some way of tricking the software to do something that didn't intend to do make use of that to take control of the system the other option is that you just get the code loaded in the place. it's the operating system so you modify the operating system itself when this machine shipped to hack me computers then pack free computers will install that operating system of choice and see what you can't modify that then but how does that operating system get loaded off? well that gets loaded off disk by another program called the bootloader and the bootloader is a program on the disk which gets loaded by the bios or the uefi and the bios of the uefi depending on the machine is on an eeprom on the motherboard which can be flashed by the board management controller and so you can see another potential way that you could hack the machine is that you say, okay i'll put some hardware on the machine which modifies the board management controller to modify the bios of the ufi to modify the bootloader after it's been loaded because the voice has the permission to do that at that point to modify the operating system after that's loaded to embed the malware i want to get executed and so it'd be a nightmare to be over because he running software which modifies software which modifies software? which modifies and i think i've got the right number of levels of indirection there actually, there is another way you could potentially trick things there in that we talk about ring zero being the lowest level but actually when we've added support for virtual machines and hypervisors is now a ring minus one as it tends to be referred to and so it's potentially possible that you could actually get a hypervisor running before anything else on the machine and so the machine was running in a virtualized environment that they didn't know about so that's another potential way of doing it and again you then have access to be able to scrape memory and find things that were the software you can put it on let it run delete it and it's as if it was never there type sort of thing with the hardware you can't really get into the dead center necessarily and take all the chips out that you've put in there so you probably will make the chips look like they're meant to be there like they're something else or hide them so the way a modern printed circuit board is constructed is a printed circuit board that scott several layers of fiberglass sandwiched together with traces of the tracks of the circuit running through them so you got the top layer and the bottom layer but often several three or four layers inside as well these only got six layer pcbs and things the story goes that actually now the chips are so small that they're embedded between the layers of the printed circuit board so that actually you wouldn't necessarily notice it. i think you'd want to design your hardware exploit still make it look like it was meant to be there it's only if you had sort of one with it and one without it that you perhaps noticed that there was something odd about that machine detecting it would be difficult. i mean the stories they've been sort of suggested are that they're detecting it mainly through odd network access and so again that suggests what the software is doing it is connecting just other machines that i was not expected to either inside the company or outside the company and accessing things in a way that you wouldn't expect you to do and that is probably your sort of best bet for detecting these sort of things is all these machines doing what you want them to do and the best way to do that is to sort of monitor your network and run software which is sort of learning what's expected traffic and non expected traffic and liking things because obviously if you've got a huge data center thousands of machines in it spotting the needle in the haystack is a tricky problem so they may not connect directly to a server and upload it all but it may well be that they just do a domain name lookup on certain domains depending on certain bits of data being there. and so and that's enough to tell people that actually ok this machine here is just that requested a specific domain that doesn't exist that means that it's found what we asked it to look for and we've just returned a specific ip address perhaps that says go and destroy all the machines at hackney computers or whatever is you wanted to do which means that we don't tend to use it very often horse is much further up the list so a correct and batteries further up the list as well. i mean, we all have phones we talk about batteries all the time. so if you hypothetically picked for words that were in the top 500 then suddenly the search base is 500 to the power 4