in this video i'm going to show you how to build the most interesting fun yet simple python project that you've ever seen now i know that's saying a lot but what we're going to do here is build an ai choose your own adventure game in under a hundred lines of code now i'm going to walk you through step by step and i promise you even if you're a beginner programmer you're going to be able to follow along here and you're going to have a fantastic project that is going to be a lot of fun to play with now for those of you that just want to dive right into the code i'll leave a time stamp down below but i did want to mention that we're going to be doing this using an open ai gpt model and integrating that with an apache cassandra database recently they added vector support and that means we can actually inject real-time data in a memory buffer into our ai model really really cool stuff i know it seems complicated but i promise i will break it down and it will be crystal clear now let's dive into a quick demo of the project so i'm going to run the code here quickly though i'll mention that a choose your own adventure game is a branching game where you have multiple different paths and kind of options that you can choose and each choice affects the choice in the future and eventually you're trying to go down the correct path these were really popular back in the day when i was a kid and i've built a bunch of hard-coded choose your own adventure games but they can be really tedious to write out so have a look at this welcome to whispering woods it is said that the lost gem of strandy lies hidden in these woods you must adventure deep into the depths of the forest to find it before we begin what weapons would you like to take with you now notice i can choose any weapons i want here different from a traditional chooser and adventure game so go with maybe shield and ax okay so i'm going to take those as my weapons very well you've chosen a shield in ax now let us enter the whispering woods and begin your quest okay let's see what it says next as you make your way through the forest you come across a fork in the path to the left lies a path of darkness and to the right lies a path of light let's go light that seems like the better option okay let's see what brings us you have chosen the path of light you continue down the path until you come to a clearing where a small cottage sits in the middle as you approach the door swings open in a mysterious figure beckons you inside will you enter yes i will okay let's see what we got here and you step inside and find yourself in a cozy room with a warm fire burning in the corner the mysterious figure greets you and tells you that the gemma serenity is hidden deep within the forest he then offers you a choice you can either go at it alone or with this help let's go alone now notice all the stuff you see here i didn't write this is being generated by the ai okay so keep that in mind very well you decide to go in alone do you enter the cave or do you turn back enter the cave i'm just trying to get it to a point where i either die or i find the stone so you guys can see how this ends you enter the cave as you make your way through you see a dragon do you want to sneak past or fight it let's fight the dragon and you attempt to fight the dragon but it proves too powerful for you you are quickly defeated and the dragon devours you whole the end there you go so this whole thing that you saw was generated by ai in real time as i was typing it and it uses memory so what that means is it knows all of the choices i've made previously so we can generate the next choice using contextual data really really interesting and i'm going to show you exactly how to build this now let's just quickly compare that to a traditional choose your own adventure game so this is some code i'm just going to quickly scroll through that would be a hard-coded version of that where you need to actually manually enter every single path every single option you need to check for a specific string you couldn't type what i typed where you do like an exclamation point at the end or you have a leading space so you kind of do a weird answer to the question you need to actually hard code all of this stuff out as you can see in here whereas what we're going to do is just give a really detailed prompt that describes how the game should be played and the ai is going to take over and handle all of it for us so i promise we're going to get into the code but stick with me here for a minute or two where i share with you some important information about how powerful what i'm going to show you actually is and how you can apply this outside of this simple tutorial so when we think about llms and these language models like chat gpt they're very impactful they can do a lot of really interesting stuff and the main benefit to us as developers is that they can reason based on information and a lot of times we'll want to take a model like this and use it in our application we want to implement generative ai now the main issue in bottleneck we're going to face here is that we don't really have a way at least many people don't know a way to inject real-time data into the model now what that means is that the model can only reason based on the data it was trained on right if it was trained back in september 2021 like chat gbt it doesn't know up-to-date information and it's going to give us kind of hallucinations where it's misrecalling things it's giving us the wrong data it doesn't know the answer to specific questions because it doesn't have the information to be able to answer what we're asking now at the same time these models have a very hard time remembering large chunks of information and recalling that data accurately go into a chat gpt window ask it a bunch of questions then ask it how many questions have i asked you and you're going to see quite quickly it'll get that wrong a lot even ask it to recall previous questions or prompts that you've given to it and again it's going to hallucinate and it will give you a lot of wrong answers so we as a developer need to mitigate that so that we can actually have a reliable generative ai tool that we can use and that can be production ready and user facing how do we do that well we need to essentially inject the data that we deem accurate and that we want the model to reason in in the prompt and then instruct the model to reason based on that information now this is a technique no known as rag or retrieval augmented generation now to go a step further what you can actually do is use the model ask it to tell you the information it needs and then based on its response retrieve the information feed it into the model and have it give you an accurate reply this is a big thing it's very trendy right now again rag rag anyways in this tutorial what i'm going to show you how to do is have a memory for our llm that means that we'll actually allow it to know all of the previous paths all of the previous replies so it can generate an accurate reply going forward for our choose your own adventure game so now comes the question how do we do all of that well obviously i'm going to show you here step by step but to be able to provide real-time data to an llm we need to have a very very fast database and in this video we're going to use a vector database provided from data stacks i've actually teamed up with them for this video they've sponsored it and provide a free vector database that you guys can use and you'll see exactly exactly why it's kind of the best tool for this type of application anyways what is a vector database well a vector database stores information as vectors in multi-dimensional space versus a tabular database or like your typical kind of sql database right this actually allows us to very very quickly search for information because we're searching in a multi-dimensional vector space where we can compare vectors together very quickly relative to searching in an index database that can kind of get out of hand when it gets very very large at small scale obviously none of this matters when you scale to the point where we're dealing with petabytes of data we have all kinds of information we'd want our llm to have access to we need to be able to retrieve that information instantly really really fast right so we need to use a vectorized database to do that or at least a very very fast database and this is the best one that i know of i'm going to show you how to set that up but again the vector database stores data in a different representation you can look it up it's actually really interesting how it works and it's kind of the ideal type of tool for something like an llm and the type of application we're going to build so as i was saying what we need for this to work is a vectorized database that can store and retrieve information for us now for that we're going to use the asterisk sandra database which is a fully managed service from datastacks who is the sponsor of this video so click the link in the description you can sign up with them for free you don't need credit card or anything like that and we can make an instance of this database for free and everything will be handled for us typically vector databases can be complicated to set up but in this case we just press like one or two buttons fill in some info and it will just create it for us and give us all the connection steps that'll walk you through alright so once you've signed in you should be brought to a page like this and what we can do is go and click create database now we're going to make a vector database again optimized for the ai application database name call this whatever you want i'm just going to call this choose your if we could spell this correctly own adventure looks like i need a language model to help me type for the key space name you can call this whatever you want i'm just going to go with database and then for the free tier you just have one region so just go with whatever the available one is and then same thing we're just going to go with google cloud or actually i guess you can choose one of these different options but i'm just going to use google cloud okay we're going to create this database and it's automatically going to be handled for us it's going to take a few minutes to provision and be set up once it's finished kind of being set up then i will show you how we can connect to it alright so our database has been created what we're going to do now is go over to connect and we're going to download the appropriate authorization and kind of connection things that we need so what we'll do is we'll follow along with a few steps that are actually down here this is going to allow us to connect to the database and create a place where we'll store the memory for our llm once we have all of that we'll actually connect to open ai we will then generate the prompt and we'll start actually creating the game it's going to take a little bit of time bear with me here i promise this is worth it really really cool application okay so we're going to go from overview to connect we're going to click on generate token we're going to download the token details into the same directory where our python script is so you can see here i'm in vs code you can open any editor you'd like i've created a python file tutorial.pi and inside that same directory very important in the same directory i've put my json file now obviously don't share that with people i'm just showing it here i'm going to delete the database afterwards okay next we're going to go to get bundle we're going to click on that we're going to click on our region and we're going to download the secret bundle again to the same directory where our python file is okay now next we need to install a few things but before we do that we are actually going to create a virtual environment where our code is going to live or where our dependencies are going to live if you're unfamiliar with a virtual environment this is an isolated container specifically for python where all of the python packages related to a project are going to be stored very useful when you have a lot of different projects and dependencies anyways what we're going to do here if you're on windows is you're going to open up powershell to do that if you're in vs code you can go the little plus button where the arrow is and just click on powershell if that's not an option you can go to the search bar and just type powershell and you can just run the commands that i'm going to show you from there as long as you're in the correct directory in powershell now if you are on mac or linux then what you're going to do is just open up a normal terminal environment and i'll tell you the corresponding command that you need to run so what we're going to do is we're going to say pip install virtual env now this is what will allow us to actually create the virtual environment if you're on mac or linux try pip3 install virtual env now i'm going to go ahead and run that you can see i already have it installed okay now that we have that we're going to type virtual env and then the name of the environment we want to make now typically you'll just call this env so i'm going to do env and this should be the same command for mac or linux okay so you see it created an env folder for us up here now what we're going to do is activate the virtual environment now this is where the command will differ depending if you're on mac or linux if you are on windows though you're going to type dot slash env slash scripts slash activate okay go ahead and hit enter and you're going to see a little kind of parenthesized env here which means you're in the virtual environment now if you're on mac or linux you're going to type source and then that same thing so it's going to be dot slash env slash grips slash if you do the slashes the right way activate okay and that should activate the virtual environment for you now to deactivate it you can just type deactivate and you'll get out of it but now that we're inside the virtual environment i'm just going to make this half screen again and we're going to follow along with the installation steps so we're going to go here to python because this is the drive we're using and we're going to first start by installing the cassandra driver so i'm going to right click there and click on pip install cassandra driver this is going to take a second once it's finished i'll be right back all right now while we're installing packages there's a few more that we need to install let me make this full screen here these don't come directly from that documentation what we're going to use is something known as lang chain which is going to allow us to interface with open ai so we're going to type pip install again inside of the virtual environment and we're going to install casio we're going to install lang chain like that open ai and then tick and it's actually not tick tock although it looks like it tick token like that okay so install these casio lang chain open ai tick token and that should give us all of the dependencies that we need there might be one or two more but i think that's pretty much it okay so while those install we're gonna go back to half screen here and we are going to now run the next steps here so we already have this directory we don't need that we're just going to go and we're going to copy all of the code here and we're going to paste this inside of our tutorial script once we have that we can actually close this window and we can start working from this okay so what this is going to do here is connect us to the database now we're going to modify this script slightly but this is just going to essentially test the connection and make sure it's working properly so all we need to do is we just need to go where all these files are and we need to rename them to whatever they are actually named in our directory so you can see here my cloud config secure connect bundle and this is named secure connect choose your own adventure dot zip okay that's correct that's fine we're going to scroll down you can see this right here this is not correct we need to change this name of our json file which is choose underscore your underscore if we could do this correctly on adventure like that and then token.json once that's there we're going to open up our terminal from our virtual environment we're going to run our python scripts we're going to say python and then this is called tutorial.pi so i'm going to run that and we're just going to make sure we get some output if we get this output right here or really anything that doesn't tell us an error occurred we're good and we have connected to our database all right so now that this is working we're just going to clean up the code a little bit and start adding some stuff so i'm just going to delete these comments here that we don't need and i'm going to go and just delete this kind of row code because we're not going to use that either now i'm going to create two variables that we're going to fill in in a second the first is going to be the astra underscore db underscore keyspace okay this is going to be whatever you named it when you were creating the database so in this case we called it database we're then going to have another variable here and it's going to be the open ai underscore api underscore key and this is going to be our openai api key which we'll retrieve later on now though what i'd like to do is i want to connect to the astrid database or to the cassandra astra database whatever you want to call it and i want to initialize memory so i'm going to show you how we create the memory then what we'll need to do is retrieve from memory and inject that into an open ai prompt so we're going to write a fair amount of code here i'll try my best to break it down step by step obviously if i'm too slow for you feel free to speed up the video so what i'm going to do down here is say message underscore history is equal to cassandra chat message history okay and we're going to import this from above so we're going to go up here to import and we're going to have a few things we need to import here we're going to say from langchain dot memory import and this is going to be cassandra chat message history if you see me looking to the side that's because i do have a cheat sheet open i don't have all of this memorized obviously but i'm going to type it out with you so i can explain it line by line okay so inside of message history we're going to essentially initialize a place in our vector database where we're going to store the log of the chat history for this specific application so we're going to say our session underscore id is equal to and you can make this literally anything you want this is just a unique key that will allow you to retrieve the session later on so if you actually wanted to store the progress of the choose your adventure game as long as you know what the session id is and you don't clear the history you can access this at any time you'll see what i mean in a second next we're going to say the session is equal to session which is the connection to our vector database we're then going to say the key space is equal to because you can have multiple key spaces the astra db keyspace and then we're going to say ttl underscore seconds is equal to 3600 this stands for the time to live seconds which means we are going to store all of this for a maximum of 60 minutes if it hits 60 minutes we're going to delete whatever was added inside of here automatically we're then going to say message history dot clear now that's going to clear the message history which is just going to delete all of it that means every time we rerun this application we'll get a new set of memory for the new instance of the game all right now that we've created message history we're going to use a wrapper around this that will allow us to easily add to the message history you'll see what i mean but all of this is coming from langchain if you're unfamiliar with lang chain this essentially allows us to set up pipelines for dealing with models like llms language models etc and a bunch of other stuff like databases you can see from linkchain.memory import this and this is a wrapper around the vector database right and same thing with a bunch of the other stuff we're going to use now actually from the same import line here sorry about the cut there guys we're going to import the conversation buffer memory like that we're then going to come down here and we're going to say that our cass underscore buff underscore memory is equal to cassandra not chat message history why do i keep doing cassandra this is conversation buffer memory and inside of here we're going to have our memory underscore key and you can make this equal to whatever you want but i'm gonna go with chat history and you'll see where we use that in a second and then i'm going to say my chat memory is equal to the message history now this is going to make it easier for us to load this into the open ai prompt which you're going to see in a second all right so we're actually almost there just bear with me here for a second we're going to go back up here we're gonna import a few things from lang chain again that we're going to use to interact with open ai we're going to say from lang chain dot llms imports and this is going to be open ai because that's the one that we're going to use you could use other ones as well we're then going to say from langjain dot and actually not dot we're just gonna say from link chain import llm chain and the prompt template okay we're going to go down here we're going to initialize a connection with openai so we're going to say llm is equal to open ai and we're going to pass the open ai underscore api underscore key equal to the open ai api key okay i think i spelled that correctly i believe i did so now we have our llm so we'll get this key in a second but for now we'll just write the code next we're going to say llm underscore chain is equal to llm chain and what we're going to do is connect this to our llm so we're going to say llm is equal to llm we're then going to say prompt is equal to and this is going to be a prompt which you'll see in a second and we're going to say our memory is equal to the cassandra buffer memory so what this is doing lang chain is just wrapping all the stuff that we need to do with a really easy to use api i know it seems weird because like where are you going to find all this information but this is just right from the documentation okay so that's kind of where i'm copying it from and how i've constructed this project now one thing that we do need to do now is we need to make something known as a prompt template now you may have seen this in some other videos of mine or some other applications but the template is a way where we dynamically inject data into kind of chachi bt or the llm or the prompt right that's what we're doing so i'm going to say prompt is equal to prompt template for the prompt template we specify the input variables that we're going to have which is our dynamic or changing data so we'll say input variables now the first variable is going to be chat history which matches with the name of our memory key okay so what we'll do actually let me just add the next one and then i'll explain this next we're going to say human input and then we're going to go here and we're going to say the template is equal to template and we're going to define a template here and we'll write this in a second okay so the idea is that we're going to have input variables that we're going to pass into this template you write the input variables like this chat underscore history now when i specify the input variables what will happen is we'll have some value for these we'll pass them into the template and then when we make a prediction we'll be using a template that contains this dynamic data so if you go through step by step here right i have my llm chain which now we're going to use our prompt for and we're using our buffer memory the buffer memory key is chat history meaning now when i use the llm it's going to take that memory and it's going to inject it inside of the prompt as the chat history key it's then up to us to provide the human input alright we're almost there now let's fill in the template and we'll actually start making some predictions now i'm going to copy in the template you can copy this from the link in the description all of the code will be available there but i'm not going to obviously type all of this out and let's read through this template okay so what i've done is i've specified what it is that i want the ai to be kind of responding to or how i want it to act now this template is fully customizable you can change this to be whatever you want and this is really going to be you defining the rules of your choose your own adventure story so if i read through this here it says you are now the guide of a mystical journey at whispering woods a traveler named alera seeks the lost gem of serenity you must navigate her through challenges choices and consequences dynamically adapting the tale based on the traveler's decisions your goal is to create a branching narrative experience where each choice leads to a new path ultimately determining alaris fate here are some rules to follow and this is where you're going to be specific and you're going to tell hey i want you to ask this type of question i want you to ask this first i want you to do this that's where you define the structure of the game it is going to be random but you can make it much more concrete if you make this prompt a lot more detailed so rules start asking the player to choose some kind of weapons you saw that that's what it did when i asked me have a few paths that lead to success us have some paths that lead to death if the user dies generate a response that explains the death and ends in the text the end i will search for this text to end the game so you're telling with natural language the ai model how you want it to generate a game for you which is really going to be the future of programming kind of a cool way to showcase that here anyways here is the chat history use this to understand what to say next boom provide the chat history here's the human input and then the ai is going to generate a response for us hopefully that makes a bit of sense but this is the template that we're now going to pass to the llm which will be chat gbt and now it's going to generate all of this stuff for the game for us we don't need to manually code it like we would have here with like all these if statements and print statements and all that crap we'd have in a traditional game we're almost there what we need to do now is make a prediction but before we can make a prediction we need to have our open api key so let me open up that site let me show you how we generate it alright so to generate your api key from openai you're going to go to platform.openai.com account slash api keys you can find this pretty easily from the website by clicking over your name if you click that it will say view your api key anyways we're going to take this url i'll leave this in the description paste it in the browser and we're going to go to create new secret now for this i'm just going to go with game it's going to create a secret key obviously i will delete this after the video you're going to copy the key and we're just going to take that and paste that here okay now we have our openai api key now that we have that we can start generating some predictions from our llm so to do that we say llm underscore chain dot predict like that and then we pass to this the human underscore input equal to and then whatever we want this to be so in this case let's just say start the game now what this will do is return a string to us so we're going to say response is equal to that and then we can print the response now notice that this human input variable matches with the input variable to my prompt template and we could have many other variables if you wanted to add those you just have to specify them here okay so if i go here now and i run my code so it's going to be python tutorial dot pi we should just get the output that begins the game for us and then i'll show you how we put this in a loop okay it actually gives us an issue here it says unknown key space database so it's possible that i entered the wrong keyspace name let me have a look and i'll be right back all right so it looks like i spelled the key space name wrong data bse hence why it wasn't appearing so let's just go over here and change that to be the correct name i'm sure you guys can spell better than i can so you probably didn't have that issue anyways let's clear and rerun this here and let's finger cross and hope it gives us the output let's see there you go welcome to whispering woods you have come in search of the lost gem before you embark on your journey you must choose a weapon will you take a sword staff but war ax boom and you see starts the game now what we want to do is put this in a loop and see that memory come into action where it starts generating us through the different paths so let's go down here and let's set up a little bit of a while loop for us so we're going to start by just saying choice is equal to and we're just going to say start like that we're going to say well true okay and then what we're going to do is we're going to generate the response based on the choice now the first choice i'm just hard coding because i want the first thing the user sees to be some output from the ai so we need to first just give it like a start prompt so it just generates that initial message okay we have that we are then going to say choice is equal to inputs we're going to say your reply like that however before we do that we're just going to look at the response so we're going to print the response i'm going to do dot strip now i'm just going to strip it so it gets rid of any leading or trailing white spaces or new line characters because sometimes the ai generates those we're going to print out the response and then we're going to say if the end in response then we're just going to break now the reason for that is again if we go look at our prompt remember i have a rule here and it says if you die have the end and a period contained in the response so now if that's the case right so if the end is there we're just going to break which is going to end the game for the user that's it now you can make this any search string you want but that's what i told the bot to generate so i'm going to look for that and then we should be good hopefully this makes sense it's a little while loop here but this is just going to run the game infinitely until we win or until we die essentially until the ai gives us the end okay so let's go in here zoom in a little bit and let's try this python tutorial.pi if you guys can take a second here there's a little bit of latency and it says welcome to the whispering woods what weapons will you choose let's go with ax and sword okay we're gonna dual wield here chosen ax and a sword good choice you know i must decide what path to take left right or straight let's go left okay you choose left as you venture further down the path you come across a large stone wall with a mysterious door what will you do open the door now look at this right you can type anything you want here kick down the door break the door run away like it's so dynamic because of the fact that we're using the ai which is why i really love this project anyways open the door you open the door cautiously and find yourself in a dark and ancient chamber as you explore the chamber you find the chest containing the gem you have success or you've succeeded sorry in your quest the end boom ends let's run it one more time okay and by the way if you want it to be longer you could just write in the rules you need to go down at least 10 paths or make 20 decisions before you reach the stone so if you want to make it harder you can just tell the ai make it harder in the prompt right okay welcome to whispering woods let's bring a shield okay and you've chosen shield which way do you go let's go left okay and you enter the temple find a large chest you open the chest leave it okay and let's see what we get here you leave the chest and continue your journey as you walk through on the path you come across a bridge do you want to cross the bridge cross it okay let's see what happens now you cross the bridge and make your way to a cottage as you approach the door you hear a loud rumbling suddenly a giant beast emerges you must fight for your life do you use your shield or try to run away use the shield so notice it's using a decision i made previously the shield in this decision right which you can continue to prompt the ai in that main prompt to do you raise your shield and prepare for battle the beast charge at you but your shield holds strong and you're able to fend off the attack you defeated the beast you found the lost gem congratulations the end okay maybe not the most thrilling end to a story but again you need to instruct it with what you want in the prompt which is really up to you guys so with that said that's going to start wrapping up the video here that's all the code again i'll make it all available from the link in the description so you can just download it and fill in the few variables and files and you'll just be good to go and that is how you make an ai choose your own adventure game i think this was a really really cool project i had a lot of fun building this and i think if you guys adjust this prompt and really add some more rules and give this some more structure you're going to get a really really interesting game and a really cool project thanks again to datastacks for sponsoring this video such a pleasure to work with them and really a cool project that we're able to generate here i hope you guys enjoyed and found some value if you did leave a like subscribe and i will see you in the next one [music]