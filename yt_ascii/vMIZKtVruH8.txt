i wanted to talk about crypto-jacking, right, which is, i mean the name itself it starts off in a good way sometimes called drive-by mining also a great name. this is the idea that we can trick someone instead of maybe putting a virus on their machine i mean it might still be a virus, but we can trick them into mining some cryptocurrency for us. and that way we make a profit think of it like an alternative in crime sensitive ransomware where you trying to get money off someone by taking control of their files. we're now just trying to use some of their cpu power to earn us some money right, so theoretically they mine some coins for us. they send them to us and then we we profit from those so this all came about because a company called coinhive decided that maybe instead of showing people adverts online they could just use a little bit of their cpu to mine you cryptocurrency while they're browsing and that way they don't have to look at adverts and you still get paid for your your website. right now that actually is not a bad idea or in some sense the idea would be but you go to let's say a newspaper and instead of seeing a load of banner ads you see a little ticker that says you're mining some cryptocurrency while you're on this website and you know we're gonna make a small amount of money off this in exchange for you not having any ads and reading the news for free, right? okay, and i mean the amount of money you're gonna spend a couple of minutes reading an article it's not very much right if you even if your cpus on a hundred percent, this is javascript so you you go to a website. it serves you a script which instructs your computer to start mining these coins the problem is that it wasn't long before people thought well, we don't maybe we should just not ask permission, right? we should we should have them mine all the coins all the time. right? and the other thing was that coin hive has a feature, which lets you only use let's say 60% of a cpu so there's some overhead for mouse events and things that are kind of important to keep the operating system running and of course the malware programmers thought, well you know, 100%, right? so i've just got this web server set up on my machine i've extended my classic blog. this is the world's best blog, of course, right? it looks good and it's got good content on it [...] with a nice banner ad which also happens to mine me some manero cryptocurrency. right so let's have a look, so you can see here i've got my blog before it's got my comments and my cat pictures i had before and it's also got this lovely banner ad which i made for my shop which is not a real shop. don't send me any money. you will also notice now if you look at my cpu monitor which i've also got running it's sitting on 100% and if we leave it for a minute we're going to start hearing my fan get louder and louder and louder because basically the entirety of my cpu is mining monero cryptocurrency now. i mean i didn't notice the mouse is still responding. i mean, you know it's a modern pc but you know, you wouldn't necessarily know apart from the fact that your fan has spun up. now, it's also not plugged in so the battery is going to be draining pretty fast. the good news is that this is already less common than it was just a few months ago because chrome, firefox you know antivirus vendors and things like this are all cracking down on these kind of scripts. now coinhive as i pointed out, is actually a legitimate company. they weren't intending on people abusing this service so they've now got an opt-in version where a little pop-up turns up and you can say i do opt-in for this time instead of ads or something like this, right that isn't blocked by browsers because that's a legitimate commercial alternative to ads but of course coinhive aren't the only people that are making these, right? so you're going to have clones you're going to have malware that does this and you can just imagine that instead of getting ransomware you'll just get something like this and runs on your pc instead and the same is true also for phones. so you might download an app, which seems too good to be true oh there's not even any adverts on this free game and maybe it's because it's using up extra of your cpu to mine crypto currency if you were doing this in bitcoin, you wouldn't you wouldn't get a look-in. essentially. i could mine with my cpu bitcoins, you know for hundreds of years and never get any, right? because compared to the size of the bitcoin network we've all their dedicated hardware. my cpu is a nonentity essentially manero is slightly different monero has a a hashing function, but it uses in the mining process which is quite hard to do on a gpu and so you get some but not a lot of benefit from having a dedicated rig, right? two times, maybe. given the cost of a graphics card not very good so actually you could have a lot of android phones competing with big graphics cards in monero specifically and and so in some sense there is a point to do it. now, that's one of the reasons it was designed this way to allow people on phones and things to mine. but it has this benefit that or benefit depending on who you are that it's a good target for this kind of malware, right? because if you have a website where everyone is mining monero for you. it's not gonna make you a huge amount of money but it'll make you some and monero is one of these currencies that's a little bit hard to keep a track of and so maybe you can get away of it that's that's the idea. my browser and my extensions block it, my antivirus on my machine blocks it, the university firewall blocks it. so, i'm currently i have all of those disabled and i'm rooting through my 4g phone connection. it works fine at home i know good or bad so, you know, like i say, vendors of things like antivirus are taking a lot of steps to to fix this. i'm gonna close this now because it's it's not that loud actually sean: it's basically the thing that says: "many things for sale, buy now." that's got some javascript [...] mike: well, yeah, i mean, this is just an image, but yeah ... just next to it is some script that does it. you could imagine that if i was running a like a newspaper website i'm being served ads by some ad company all i have to do to get in there is pay some money to have an advert deployed which also happens to have this script. no one's going to go to my blog, right? it's not online but also because no it's rubbish. so what i if i was an attacker it would be much smarter for me to try and take over a site where lots of people are going. this came into a news because in february 2018 an accessibility website that are just like screen reading and things like this was hacked and their javascript file had some monero mining code inserted into it and this website was serving javascript to about 4000 uk and us government websites among others including the information commissioner's office and various high-level government websites. this meant that when you went on those web sites to let's say find out about something important you were actually mining monero for the attackers not ideal sean: could you work out who did it? mike: absolutely, well no all you can all you know is i mean assuming ... sean: the wallet mike: all you know is the address that the monero is being mined to right and as usual you've got the traceability issues of that. if they use that address to buy like pizza to their house it might be slightly easier to find them. but if they try and hide it, it's gonna be harder this is the code that was inserted into all these government websites. this is not my code. my code is much simpler than this and it's also not obfuscated so this has been encoded to try and make it harder for anti-viruses to find and then this is deobfuscated version which is essentially looking up the coinhive javascript and then pointing it towards this address which you shouldn't mine monero for because they're malware writers. sean: they weren't even writing their own javascript, they were using coinhive's actual -- mike: yeah yeah, i mean, it's pretty lazy, really. yes, so i think now some are writing their own javascript or embedding it into java apps or for android phones and things like this but yes, when coinhive first came out. this wasn't i would say an unexpected side effect of their new idea. like i say they've kind of come up with a more legitimate way of doing this now and they have interesting things like captchas which do a little bit of hashing as an alternative to pick these images that have road signs in, right? just just do a little bit of cpu, which is interesting enough but yeah so i think going forward we're going to see fewer of these deployed in a browser unless they can find a way of getting around these new browser restrictions but they might start to find their way into more actual malware, right? maybe instead of encrypting everyone's files you just take over their cpu for a while and make some money that way or do both at the same time. both: or do you buy for the same time? mike: yeah, why not? sean: the free games thing is quite classic because i mean we're all used to just getting games for free and expecting you that purchases mike: yeah, when you download an app, it's got free access to your cpu. it could do this you'll know because your phone will get hot and your battery will go [... noise of draining battery ...] like this but that happens with some games that are poorly written anyway, so how do we know that? you've got a hope? i suppose that there's some vetting process on the apps, which might hopefully detect this kind of stuff but it's not always going to be easy to find and so you can expect a few of these to pop up from time to time we're going to say "document.write('')" okay, now that's it's going to write nothing to the screen, right? so my comment on my blog, it's just going to be a script that does nothing. okay, that's not very interesting so let's do something a bit more interesting our php file takes the cooking gives an image back so let's just show it on the screen, right? so image tag in html.  is the image tag ...