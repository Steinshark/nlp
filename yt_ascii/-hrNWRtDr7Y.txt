i think we've done fairly well actually
on turing, enigma - all this kind of thing. we've raced around bletchley park-
saw the colossus machine - which was for the tunny, or lorenz, cipher. there is
a bit missing in the middle: "why was colossus necessary why did they
need a computer?"  what was the nature of that traffic that colossus 
could help with? in one of our previous videos we've actually shown a picture of this weird
trace that they were getting off the airwaves. they showed it to the experts
at bletchley park and they said: "that's broadcast teleprinter traffic!" and we've
got to remind ourselves [that] they may not have had electronic computers back in the 1940s,
early on, but they certainly did have teleprinter machines. they were very
common - used in stock exchanges; used for foreign telegrams all sorts.
it looks a bit like a keyboard. as you press the keys there was a very
comforting 'splash splash splash' sound of the electromechanical things. because, as
well as sending five-, or maybe even seven-hole, pulses over the land-line, it was
also printing out, as you went, what it was you were typing. so, that technology
was just phenomenally well known. the staff at bletchley park were comforted, in
a way, that it was teleprinter traffic, but puzzled as to its precise nature.
however, they'd all been on cryptography training courses - or even
been instructors on cryptography training courses - and one of the stories
was:  "don't forget the vernam cipher!" so, again, in a previous video, there's more
details about this but a guy called vernam, who worked for bell labs, at&t, in the
late '20s / early 30s, had this idea of taking 5-hole teleprinter codes and
exclusive-oring them with an arbitrary letter, which was like a cipher key, and
coming out with a different letter. i'll just do one for you just to remind you
of the sort of principles  that went on.[looks at open booklet front page]  
probably available somewhere online: "code-breaking with the colossus computer". in the teleprinter code
the letter h is represented by 0 0 1 0 1 now if you take the letter f, that is 1 0 1 1 0 
and from numerous videos we've done about the nature of bitwise
exclusive-or it's now dead easy. exclusive-or says you do it bitwise. it is like an
addition but what happens is the result is 1 if and only if the two bits differ.
if they're the same then the answer is 0 so 0 exclusive-ord with  1 ?
they're different that's a 1.
 0 with 0 ? they're the same [so] it's a 0
1 with 1 ? 
they're the same; it's answer is a 0  0 with 1 is 1.   1 with 0 is 1 
the result, then, of exclusive oring f with h 
is to give you a cipher result of 1 0 0 1 1. you'd have
known this off by heart if you were at bletchley park in the middle '40s, but i
*don't* know it off by heart(!) but the answer is that it's the letter b. 
vernam said: "that's a great idea! if i provide a paper tape with a key on it, that's
random, i'll just, y'know, randomize them myself. i'll type in a great long random
key stream. if you exclusive-or these  5-bit patterns with each other, and the
other tape is the plaintext, top secret message, you want to send, then fine! that's a
superb way of encrypting it, you see". believe it or not, vernam and bell labs
actually patented this. but there's one huge problem in getting it to work,
because their idea was you have a 5 hole paper tape full of your plaintext - your
secret text you want to send - you have a gilbert-vernam-produced equivalent tape
with lots of random [key] and you just want to run them side-by-side through some
machine that reads that one; reads that one, exclusive-ors them and prints out
the encrypted result. and what's the problem if you
literally use two paper tapes?
keeping them in sync! they had huge difficulties with
differential slippage. so you either ended up with them not in line and not
working at all, or the wrong pattern being xord with the wrong pattern. so
in the end the feeling, i think was, among the cryptographic community: "this is a
promising technique but there's no way you want to be trying to synchronize two
stretchy bits of tape!" one bit of tape - fine. you can even keep track.
so there was a knowledge in the cipher world that sooner or later somebody
would produce the key stream, not on another tape, but automatically, as part
of the teleprinter process. you could have a bolt-on accessory to a
teleprinter that provided the 5-bit key stream automatically, either
electronically or electromechanically. and so this one that has become so
famous, which the allies at bletchley called "tunny" -  part of these 'fishy ciphers'. they
didn't know what machine was producing it. and our colleague jack copeland,
historian and who's on top of all these things says: "every time you mention
this you must mention that at bletchley park, if you called it 'lorenz' in 1941
they wouldn't have known what you were talking about!" the company that made the
machine - that did this traffic - was a mystery to them. they just called it
tunny. it wasn't just the mystery tunny machine there were other machines around.
i have to emphasize this. there was a hagelin cipher machine in sweden,
there was a siemens cipher machine. a lot of people were investigating this idea
of providing the keystream electromechanically and not on a
separate tape. so the overall picture, then, of exclusive-oring teletype
characters - the plaintext one with a key character and doing it character by
character by character by character. you could summarize it by saying that the
ciphertext that you prepare is a result of taking a
plaintext - and remember the + in a circle means exclusive-or. so that's
your basic equation: cipher text (c) is plain text (p) exclusive-ord, character-by-
character, with the key stream (k) like that. now we did a thing called "zigzag
decryption", which you can look up and you can see the details of that. to cut a long
story short the allies were very lucky in that, by using this special zigzag decryption, 
on a rather weak [and duplicated] message. they got a whole bunch of key out of it and
this was like gold dust. in the so-called research section at bletchley
- headed up by a guy called gerry morgan - [they] picked on a new recruit called bill
tutte. he was from cambridge, just like turing. but i empathize with bill tutte
because he started off doing chemistry! and had it been today he'd [possibly!] have moved
into computer science. but as it was then he gradually turned himself into a
mathematician. he loved doing puzzles; he went through his bletchley pre-training
learnt all about vernam's - and whatever. and they put him working on another cog
machine called the hagelin machine which was used for italian ciphers. it turned
out to be rather simpler than tunny and it was good training for him. they'd
got tons of stuff from this mystery [lorenz] machine which was defying analysis. bill
tutte was given the chance to make a name for himself by having a go at it. the
only extra information that gerry morgan gave him was the following. he said: do
you know the germans - just like we encountered on the enigma in the very
early days - are actually sending us the initial [cog-wheel] settings. before we got these
4000 characters the germans sent out what we are calling 'the indicator' "
and it's passed into fame and infamy - the indicator [looks at hqibpexezmug indicator from the tiltman break]
i always pronounce it to myself as "h quib pexxy zeemug" what you'll find in the literature is people
don't want to say it! it's called "zedmug", or "zeemug", whichever
side of the atlantic you're on  and with my mid-atlantic persona
please forgive me for switching from one to the other - just like that. so "zeemug" / "zedmug"
was the indicator setting at which they had this lucky [tiltman] break and could get
the key. morgan said to bill tutte, he said: "you know, the weird thing is we've looked
at these settings, they're always alphabetic and if we're assuming that it's a bit
like the hagelin, and if  there's lots of teeth on there and all this kind of stuff, they're only ever using [in the indicator] 
25 letters. except in one of these positions [dfb: i can't remember which it was now, i think it's
the fifth one along] in that position there's only ever 23 alphabetic letters!
we've saved up all the indicators we've ever had, and on that position they only
use 23 letters out of 26" so, with his training in mind, bill tutte said: "23 is a
prime number. interesting! i wonder if - a bit like the
hagelin machine - this thing is actually using cog wheels on each of the
bitstreams? five parallel bitstreams of a five-bit character. perhaps it's using
different wheels on different streams and messing about, that way, with the
patterns of 1s and 0s that gets exclusive-ord, you know, as part of the
key generation exclusive-or thing? i wonder if this is a cogs machine? if there's a 
23-toothed wheel somewhere? but then the rest are 25, right? 23 times 25 is 575. yeah! let's
start investigating. now i think, at this stage, before we get stuck into what
bill tutte did, we need to talk about possibilities of repetitions, depending
on the number of cog wheels you've got. let me put it to you like this. suppose
you have two very simple cog wheels indeed. so simple they'd never ever be
used in cryptography - but in some sense these things are on a common spindle, like that, and every time that [i.e. a cog] rotates it
moves on one position. in fact i'll use a red pen. i'm saying that this first wheel
has only got two possible positions it can either be there, or it can be there.
there's a rod, if you like, flipping from being upright there to upright down
there. thi one - the fact that it looks like a mercedes benz logo is purely
coincidental - this one has got three possible positions. let's call these two
positions, on the two-toothed wheel, a and b those are the two possible positions.
on the car logo - whatever that brand is - i don't know - let's just call it 1, 2 and 3.
the start position we can characterize as being a 1. then we click the spindle
and it moves on to the next stop position. a will turn into pointing
downwards and being b the 1 on the other hand, on the other one, will just
go to 2. so you get a1, b2. one more click. b will go back to a but 2 will go to 3 - [hence] a3. 
one more click - you'll go from a to b again, but the 3 will go back to 1. b will
go back to a again. 1 will go to 2. a will go back to b again. 2 will go to
3 and finally back to a1. it may not look relevant, but it is. this is looking
for repeats. when does a pattern repeat? and it depends on the number of teeth on
the wheel. so one looks at this and you think, all right, a1. how long before it
comes back to being a1? [counting patterns]  1 2 3 4 5 6 oh! what a coincidence! we've got a
two-position wheel we've got a three-position wheel. 3 times 2 is 6. it's easy! instant
mathematics! it's obviously the case that all you do is multiply the number
of teeth together? nope?! even sean is shaking his head - not quite. 
>> sean: causation and correlation ?
>> dfb: causation and correlation, yes. those of you who are numberphile
fans this is trivial stuff. you'll know it off backwards but for those who are less
familiar let's just now develop it one stage further and be the devil's
advocate. but this time we'll turn the "motorized" logo into being a cross
shape. it's a four-position cog here and i'll number it 1, 2, 3, 4.
now, since i've done this earlier i'll write out the sequence for you, as to what
happens here. it goes a1 b2 on to a3 on to b4 and back to a1. so, what's the repeat
length? fouur. but look - there's 4 on that there's 2 on that, it ought to be 8. why isn't
it 8? why is it only 4? and the answer is there are factors in common:
this [wheel] is 2 that [wheel] is 4. 
four is not a prime number. it's 2 times 2 so the factor of 2
is -- it's a common base, like doing lowest common denominators [least common multiples], 
y'know, when you're combining fractions you try and find out what's the thing on the bottom [line]
that's got everything in it, but is as small as possible. and that is what is
happening here. you don't want cog-wheels with factors in common because otherwise
your repeat length will be a lot shorter than you ever imagined. finally, i'll just
draw out the possibility for you. we'll do a 3 with a 4. and they now got a b c 1 2
3 4. what is the overall length of the repeat cycle? and the answer is it's 12
and you say 4 times 3 is 12. but 4 isn't a prime number! so why is it working out
ok again that you do just multiply them? the answer is that 3 and 4 are what's
called 'relatively prime'. although 4 isn't a prime number it doesn't have any
factors in common with 3. so therefore relatively prime - sometimes called
co-prime. the story will go, then, on the numbers of teeth on these wheels, we
think, in this machine, they'll either be a prime number, or if they ran out of
prime numbers and the prime number of teeth was getting a bit big, the
next best thing - because it is safe - is to use relatively prime numbers.
and in the long run we will find in this [lorenz] thing we're going to talk about,
that one of the cogs has got 26 teeth on it, which is not prime but it's 2 times
13. so - so long as that has no factors in common with anything else that's equally
safe. so this, then, was the backdrop of what they were expecting - what bill tutte
was expecting - it was that there would be a machine probably with several cogs in
it of some sort and the prime numbers of teeth would probably be involved. so,
remembering what gerry morgan had said to him about this - that one of these
positions had only got 23 possible alphabetic characters all the
rest had 25 - he said ok what about the product of 23 by 25? there aren't any
factors in common, you see, 23 is prime. "tell you what i'll do", he said "rather than
worrying about the whole character let me just look at the leftmost stream of
bits in all these characters". now, i would call that bitstream 1. what they did at
bletchley park was they called it 'impulse 1'. what i'm talking about is the stream
of bits from all of the characters, like y'know, the bit that's in the number one
position over all characters in the message, from one to five, left to right.
he started off with what he regarded as bitstream 1, the leftmost one.
he said: "remembering my training which said if you think there's going to be
repeats have a look for them?" and he said: "well, why not do two at once? if i do 23
times 25 i might be able to spot vertical runs happening every 23, if i
write them out in a block. i might see them at 25 because they're not going to
interfere, they're relatively prime. so, on an enormous sheet of paper and it doesn't matter 
whether it's turing, bill tutte  or a host of other workers at bletchley park, they
used acres of big sheets of paper, divided up into squares, to make notes on. 
and he said: "i wrote it out along a great long strip;
575 bits then another 575 then another 575. and, don't forget. this intercept was 4000 characters. so, he ended up with six and a half huge
long rows - all on this combined period of 575. and he said i was expecting to
look down vertically and find every 23 there was a bunch of 1s
or something like this, or every 25. he didn't see that looked at it
carefully and "... to my amazement" he said [as you look at it] i saw, going down these
five rows, a clear diagonal sequence of 1s, going like that but down the
diagonal! what did that tell me? i'd got the wrong period it wasn't 575, it was 574". 41 is a [prime] factor of 574.
so, as he says in his paper, if people say this genius bill tutte was straight on
to spotting 23 and 25 and it was the first thing he found ... no, he
didn't! he went off down the wrong trail temporarily but accidentally, with sheer
pure luck, found that the number 1 stream was having its 1s and 0s
that were added to it [and] was generated by a wheel, probably, with a periodicity of 41.
but the germans wouldn't be daft enough to make sure there's a blindingly
obvious repeat every 41. there'll be 'messing about' going on behind the
scenes. it will be 41 but it will perhaps be disguised. but maybe they
didn't totally succeed in disguising it enough. armed with 41 what he then did
[he] said right i'm gonna write down all of these sequences now, not on a 575
grid but on a grid of 41. so he writes out this impulse stream of 1s
and 0s but the tradition at bletchley was to use '.' for 0 and 'x' for 1. 
tutte says he can't understand why they did this. other people say " ...  it's all very
well, bill, for you mathematicians, wanting 1s and 0s but i find patterns
easier to spot with dots and crosses". i think i agree, actually. and when he put
out all these impulses - all 4,000 [per stream] of them - on a grid 41 across, you suddenly find
that - not on every row but on quite a few of them - there are certain patterns that
repeat. so the message from that is 'yes, there is a wheel with 41 teeth involved 
but there's almost certainly some extra stage where it's trying to
disguise what's going on. that might be another wheel with different teeth or
something's going on. it's not pure and simple. it wouldn't be - because it'd be
dead easy to decrypt if it was. but there is a sneaky suspicion 41 was involved.
so, bill tutte tells the rest of the research section who piled in and helped. because
what he points out - the next obvious thing to do is look at the number 2 stream, look
at the number 3 stream look at number 4 stream, look at the number five
stream. and when we've worked out what the initial wheels - how many teeth
they've got on - then we can take that away and start looking to see if we can
figure out how the excess stuff, that's trying to distort it, gets generated. and
to cut a very long story very short, after a few weeks work of probably 10
or 11 people, what they finally came up with was in this diagram here. they
decided that initially your stream from your teleprinter was put through 5
distinct cogs, one for each bitstream or 'impulse'. the numbers of teeth were 41, 31, 29, 26, 23 so, as tutte says, " ... eventually
if i'd not discovered the 41, i would have proved what a genius i was
because 23 *is* there. it's just that it's on stream 5, not stream 1. but it is
there, right! and then they managed to discover that the obscuring mechanism
was another set of wheels which sometimes turned on by one place and
sometimes didn't. and these have got 43 47 51 53 and 59
teeth. and the eagle-eyed among you who watch every single morsel of numberphile
will immediately jump on our necks and say 26 isn't prime. no - it isn't. it's 2
times 13 but it's relatively prime to everything else. equally 51 isn't prime,
it's 3 times 17. fine. so, if you use other "relative prime-nesses" you can't have
2s or 3s involved in their factors because they're taken up now. but that
was it. these two extra wheels at the bottom? there was another thing: they
could sort of understand why 10 wheels - two sets of of 5. well what do the
other two do? the other two - in a very complicated way - determine whether this
second set of wheels moves or stays still. and i think the germans were
hoping that by that mechanism they would confuse the allied decryption effort
even more. because the first set always move. you do a character-worth it'll click 
and they [the cogs] all move on. but they've got different numbers of teeth on them.
[the] second set sometimes moves, sometimes doesn't. by the end of the war the
feeling was from people like jack good and donald michie, who had a look at this
statistically. they said: you know by the time you got used to looking for whether
the wheels were moving - a 'stutter' we call it - you got to be able to 'spot the
stutter' and it was such a landmark, once you were really familiar with it, that
the germans actually did themselves a disfavour. they'd have been better off not
to put it in. they managed to get all of that structure out of it. what they
realized was their next big task was to say: ok - we know the number of teeth on
each wheel but what we don't know is the patterns on the wheels of 1s and
0s that they are contributing to the exclusive-or key characters. so, that was
another great long journey because they knew that, on the hagelin machine, so
it's probably similar on the tunny machine, that on every cog there
was a little slider which could set up or down. and in one position it
contributed a 0, but if you put it down it always contributed a 1. so, can
you imagine going ... the task of setting this wretched thing up! you've
got all of these cogs with all these teeth and if you add up the total number of
teeth of several hundred. and every one of these positions has got to be set up
with a 1 or a 0, according to this instruction manual. do you think they
changed them every day? not a chance! they [initially] only changed the wheel patterns
once a month. you've got the indicator that tells you what the 
[initial] wheel settings are. you can work for a whole month on trying to work out
what the wheel patterns are. once you've got it you can decrypt like mad. what
would happen if they ever stopped [started] saying: let's not put the indicator out. it only
helps them. [actually] it doesn't help them, it's totally secure. but it's pointless to put
it out. just like on enigma. so, in the middle of - early to middle of - 1942 they
stopped putting out the indicator. oh dear! calamity.