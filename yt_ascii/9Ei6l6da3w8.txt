hello this video is going to be part two of my green lantern visual effects tutorials the last one was the 3d side of it which was done in blender and in this video i'm going to be talking about the compositing which was all done in nuke okay so this is the main shot that has most of the compositing work as you can see it's a fairly big new script not too crazy but quite a lot going on and i'll also cover the compositing in the lampshot and the cg street stuff that was shown in the last video this actually took quite a bit of planning there's a few moving parts in this that i shot practically that made it a lot more convincing than trying to do the whole thing in cg and namely that is the lighting and the interaction with all of the green light on the walls and also the envelope that flies up at the end so as the suit transform happens this envelope flies off the sofa and kind of drifts in front of the frame okay so let's start from the beginning this is the comp obviously at the end the footage itself looks like this you can see there's quite a big difference there i set up two practical lights in this shot as you can see one is here which is where the lamp is i put a green gel over this so that it would cause some green light on me you can't really see it it's quite subtle it's more noticeable when i'm over here i think you can see it's just interacting with my hand a bit there and then the second light is just here to add this edge light on me i always think that if you have a really strong directional source of light when you're trying to combine live action and cg then it always looks a bit more convincing so i put it here and then painted it out so you can see it on the sofa and then when it transitions to the cg suit the cg suit also has this edge light which kind of helps to marry the two together so that's the main piece of footage and then after that i shot a separate plate which is this and for this i filmed a clean plate without the two lights so i just moved them and turned them off so we've got without the light on the sofa and without the light over here and then i just used a couple of masks here and here just a key mix one frame of those two held over the top so it looks like this so you can see that we're removing those lights then what i also did as you might have seen when i showed this a second ago is i took the light that has the green gel and i just slowly moved it around the entire room so i was lighting up all the walls the ceiling getting some nice reflections and casting some shadows from the light source and then once i did that i put frame holds on all of the frames where there were significant change in the lighting so as you can see we've got all of these and then just slowly combined them all so as you can see the more and more these mergers that happened the more we start to get a nice lit up plate so if you imagine i'm standing here and the suit is glowing this now feels like it's casting green light on the whole shot so then i take this and i screen it on top of the actual footage i also built an entirely clean plate for the background so that i could remove my body because obviously at some point i want the cg suit to be here so i don't want to be able to see my arms and legs and stuff so again that was just frame holding a couple of bits of the shot and then combining the two together and then when the animation of the suit starts happening and the room lights up i've done some animation in the mix of this merge node to get brighter so that looks something like this so then this gets merged on top of the footage and because it's screened on top you get some weird transparency stuff happening so i did a bit of roto to bring myself back so you can see my legs and stuff are no longer going see-through then after that i start to remove my body in the areas where the suit starts to take over so this is what that transition looks like and then obviously after that the next thing that has to go on top is the suit itself i pushed the look of the suit quite far in compositing as you can see if i turn all of this stuff off this is what it looked like just straight out of blender it's looking pretty good but it needs a lot of work to bed it into the shot so i did quite a lot of changing the black points and stuff to make it match a little bit of tweaking of the colors and i also separated out the glossy pass and just did a bit of grading to it just to make it match a bit better then there's some softening and some defocusing just to make the sharpness of the suit match the sharpness of my face in the background as you can see the blender render is absolutely razor sharp and everything else is a bit soft because it's quite grainy so i'm just trying to match that a bit better bit of a cool tip to make adding grain to stuff look a bit better when grain occurs on footage it doesn't just go across the whole thing uniformly you get more grain in the dark areas and less in the light areas so what i do whenever i put grain on stuff is i do another luminance key and i invert it which you can do by pressing this button up here so now the areas of the frame that are really bright are these black bits and everything else that's a bit darker now becomes these light colors and then i use a key mix to merge the grain over the top of the cg and i use this luminance key as a mask which means that more grain will be added into the darker areas so that just helps to make the grade interaction on the cg a little bit more realistic so this is the base render of the suit added over the top with no extra comp work the next thing that goes on is all the glows and everything this is made by shuffling out the emission pass the emission pass from blender is this custom painted texture that i made that has all of the individual lines the muscle fibers on the suit and then i just added a couple of extra bits to enhance some of the areas of the suit so for example i masked off the center section of the suit where the chest is and added its own glow to it to make that a bit stronger which looks like this and then i also created some separate masks that did this kind of pulsing thing which goes through the suit as well this is all done in 2d and i'm just revealing and taking away sections of the emission pass with rotor shapes it still looks quite 3d even though it's just being done in comp because the emission pass itself is obviously moving around on the 3d object so i thought this looked really cool and it helped to add some dimension and really exaggerate the muscle fiber texture of the suit so like i said that's done with rotor shapes it literally looks like this so it's just basically growing them from the center and using them as masks to isolate certain bits of the suit and then as you can see i'm plugging this into the emission pass as a mask which gives me this effect and then i put some more glows on this and when it's all combined together you get this sort of effect so then the glows go on top of the suit on top of the render and i think this really brings the suit to life it makes it look a lot cooler and then the final layer is this kind of green edge that comes out with the suit this just follows the edges of the suit as it's being revealed again this is all done completely in 2d the way it's made is i'm taking the render of the suit and then i'm using the same rotor shape that i use to reveal it so as you can see here i've got this rotor shape that's expanding with the suit and this is how it starts off on the chest and just slowly gets bigger and goes outwards the roger shape itself just looks like this it's literally just got a bit of a blur on it and then i'm using a slight fractal blur and this is adding this interesting noise texture to the edge which makes it look a lot more organic as the suit's moving outwards so you get all these kind of fractally bits happening here this fractal blur isn't something that's built into nuke it's just a little gizmo that someone made at work that i really liked but it's really simple so if you want to do the same thing it's just taking some noise textures and using them going into an eye distort which is distorting the footage so if i were to replicate this sort of effect you can add a noise texture change the size to be something a bit more like this then you can add an eye distort node and plug it into the rotor shape and you just want to shuffle the noise texture into a different channel so for example i can put this into motion and then add a copy node by pressing k plug the b into the rotor shape the a into the noise and then i'm just going to turn off these two and i'm going to copy the motion channel into this stream now you can see there's extra channels here we've got rgba then we also have forward and backward so then in the eye distort node i can set uv channels to be forward which is then going to use this noise texture to distort the mask and if i turn up the uv scale you can see that it's now distorting the rotor shape using the noise the fractal blur basically just does that all internally so you'd have to set it up each time which is quite handy so back to what i was talking about i used the same rotor shape that's revealing the suit to also mask off the suit here then i'm taking the alpha and eroding it slightly which looks like this and then i take this away from the original which looks like this and what this does is just give me the edge of the alpha then what i do is use this as a mask on the already masked out version of the suit so this is it cut off using the rotor shape just revealing the arms and legs and stuff then i use the eroded mask to then mask this again and that just gives me the leading edges of the suit when it's transitioning then i grade it to make it green which looks really cool quite nice and punchy and then add a bit of a glow as well and then this gets screened on top of everything else it starts off quite subtle so on this frame it's on zero and then it starts to build up so this is without with and then by here it's almost entirely mixed on and as you can see it's obviously quite a strong edge look i think this looks really nice it gives a leading edge to the whole transition effect which kind of draws your eye and makes it a bit more obvious what the suit is doing and where it's going and then after that it's really just lens flares and stuff so when the flash is happening this is awesome sort of smeary stuff that's on the lens that's just creating some optical effects i mentioned in the last video that it was quite difficult to get the head to feel like it was sticking to the cg suit and i can demonstrate that by just plugging the suit straight on top of everything else you'll be able to see that there's sections where my head is kind of drifting off the top of the suit the reason for that is just that the weight painting and stuff of the suit doesn't move in exactly the same way that my real neck is moving and stretching and distorting it's incredibly complicated and time consuming to get the cg to match exactly so i did the best that i could in blender just by hand animating it and then to make the head properly stick to the suit so it doesn't feel all floaty i did some compositing magic and when i say compositing magic what i actually mean is just transforming the head around a bit so that's what these two nodes are doing here this first one is fixing the head track so you can see if i turn this on and off that's exactly what it's doing i just went through frame by frame and slowly animated the position of my head just by a few pixels just to get it so that the neckline is always lining up with the neckline of the cg suit it took a little bit of time but it was really worth the effort because it makes the head feel like it's actually properly sticking now the way this is done is a little bit cheaty what i would have had to do if the background was lighter is roto my head off and then put it on top of the clean plate with me cleaned up so that i had a clean background but because it's so dark and the background is basically just a flat color i'm actually just transforming the whole background around by a few pixels as you can see here so where my head's moving the background of my kitchen is also moving with me it's quite cheating but again because it's so dark you really don't notice it at all and it saved me a lot of time having to roto my head i also did a bit of a luma key and just some masks on my face just to add a bit of green light onto here so it felt like this chest logo thing was actually adding some light onto my face and then finally this is the envelope so if i go to the input you can see exactly how it was done it's me flicking it up with my hand and desperately trying to get out the way in time i literally had to do about 20 takes of this until it landed in the correct place and didn't go over the top of my body and then i drew a pretty rough mask around it and blurred it quite a bit so that's what the mask looks like and then cut it out did a bit of grading just to match the shot so when it gets a bit greener and brighter i also keyframed the exposure and stuff on this version and then put that on top of everything i really liked adding the envelope it was a bit of an afterthought but it just helped to make everything feel a bit more grounded in reality because now the cg is casting actual real light that i filmed with using the light over here to paint the walls and then it's also interacting with a live-action object and then i also added a camera shake node down here just to add a little bit of a wobble so it makes that kind of moment where the suit bursts out to feel even more powerful and that is how i did this shot so once again just to recap this is what it looks like so that is how that shot was done let's go on to the lampshot here we go so this is the lamp shot i love the way this turned out it was a lot better than i was expecting and i ended up using this as the thumbnail just because like this moment here i think looks really awesome so again i started off with a similar way of thinking where i wanted the lighting interaction on my hand to be done practically so the way it was filmed as you saw in the breakdown was actually like this so i have this light here with the green gel on it to get that lighting interaction with my hand then obviously i filmed a clean plate that didn't have the lamp in it and combined the two then i did quite a bit of luma keys and stuff again and masking different areas of the frame and light them up and make them green again this really helped to make the cg feel like it's interacting with the environment more when i just chucked it on top without this you'll see what it looks like it's like this the green of this just didn't really feel justified so i ended up making the whole shot a lot more green and it almost feels like the lighting from this is casting on the background then obviously we have the cg lamp again there's not loads of comp work going on this so i turn all the effects and stuff off this is what it looked like before and this is after i think the lighting on this came out really good again i had the edge lighting just off a frame behind me here and you can see it on my arm and stuff and i set up a very similar lighting system in blender and also used the hdri from my living room so you get this white edge lighting also occurring on the cg lamp which helps to make it feel like my arm and the cg lamp are in the same place then in terms of everything else all i really did is turn up the spec pass and stuff a bit just to make it a bit shinier and then i brightened up the front of the lamp quite a lot where the particles were coming out just so the brightness felt a bit more justified so if i show you without it this is what it looks like and then obviously the particles and stuff go on top so without it it felt like these really bright objects were just kind of passing through the glass but not really interacting with it and it felt like this area should be a lot brighter so i just drew a circular mask on here and then did a couple of different grade nodes just with some transforms and stuff to make the alphas a little bit different so i used the first one that was bigger as like a secondary glow that was just quite wide and diffuse and then the first one is much more intense in the middle then the particles go on top as i showed in the last video the render actually came out of blender looking like this as i said last time i got this streaky look by turning the motion blur up really high in blender and then on top of that i'm using a noise texture to distort the particles like this the noise texture is animated so it has an expression on it that just makes it animate as the frames change on the shot and then this goes on top of the particles which makes them feel much more like energy and less like these individual dots that are just very clearly a particle system so then on top of that it's got a bit of a glow on it of course and i also did a secondary glow where i just did a load of blurs that were built up and i put that on top of everything as well so that's the particles with the glow and the distortion and then the secondary glow which is just like a very diffuse bigger one here then there's the second particles again these are the same sort of things they're just rendered with really high motion blur and then they're distorted like this using the same noise texture and then a glow and then these go over the top as well i think the two different particle systems add some nice variation originally i tried to get it all in one and it wasn't really working so i just did two completely different sims and then i just put the two renders on top then i just did a little bit of roto of my hand because as you can see here some of the particles and stuff were going through the ring and onto my hand which obviously you don't want so i cut that out and put it back on top then i did a very subtle flare which is just being done by taking this hot spot making it green and blurring it sideways loads i talked about this in a previous video there's just loads of blur nodes with different values then you plus them all together make it green and it makes this kind of cool anamorphically flare which is just very subtle on here as you can see and then finally more lens dirt because it always makes every shot look better i talked about this kind of setup in previous videos as well it's a couple of different images of lens dirt and stuff that i found online that i combine together so that's what this looks like and then you just blur the footage loads do a little bit of grading just to make it a bit brighter or whatever you really want for your shot and then you multiply these lens dirt images on top and this does a couple of things it makes them the color of the shot that's beneath it but it also makes them only appear on top of light things in the shot this works really nicely because it completely interacts with the footage so as this particle system disappears the lens dirt also disappears because the brightness that's driving them is vanishing so if i go off before the shot starts you can see here it's off and then as the particle system starts all these lens elements start to show on the screen and then as it fades down they also disappear as well so that is how that shot was done pretty cool again it's making good use of the practical lighting and then just a little bit of cleanup tweaking the colors of the plate with some luminance keys putting the cg on top then the particle systems go on top then some magically lens dirt stuff just to make it look nice and that is the final shot when i was envisioning this i wasn't really sure how it was going to turn out and this shot turned out a lot better than i was expecting like if you pulled it on a frame like this that looks great i was very happy if i do say so myself so that was that one and then finally let's talk about the cg shots so this is the script for the cg stuff it's actually quite straightforward most of the scene was all rendered in one pass so there wasn't a huge amount of compositing to do on it so to refresh your memory this is what the shot looks like this one was my favorite of all the street shots i think the camera angle and the way the camera animates and moves behind the car was really cool and quite dynamic it starts off with the background which is the sky and this is done using a big sphere and the blender camera so what i'm doing is taking an hdri of the sky i did a little bit of grading and stuff to it and warping it just to make it actually work for what i was trying to use it for then i'm using the camera from blender inside of this massive sphere to basically film this from the inside this works in essentially the same way that it works in blender except for i didn't want to render the sky into the blender render because then it would have been baked in whereas what i really want to do is have control over the exposure and stuff of it separately in compositing and also the defocusing and stuff then we have the render of the street which looks like this by default the only thing i really did in terms of playing around with the colors is i used lots of crypto mats just to tweak things in the shot so you can see here i'm making some of the posters on the bus a bit darker just because they were a bit eye-catching and distracting making some of the background buildings a bit darker making this back wall a bit less lit up and a bit more desaturated then just generally i made everything a bit more blue just to be a bit more in line with sort of color idea that i was going for and then finally i lifted the black point up quite a bit you can see the black points are really quite crushed on some of the buildings cg tends to have black points that are quite a lot darker than live action footage so one thing that i do on pretty much all full cg shots has just left the black point up a little bit which just makes it feel a little bit less contrasty then the cherry on top is i'm using a zd focus that's plugged into a kernel to defocus it with an actual kind of blocker look i guess i don't really know how to describe it what it means is it's doing a 3d focus just like a zd focus would do but it's using this as the lens kernel which means the boxer will look like this instead of just being perfect circles like it is normally then also just to make this ping a bit better i shuffle out the emission pass this is all the emission textures of some of the led screens in the bus stop led screens in the shops at the back car lights the street lights as well as you can see here and the street lights at the top and put an exponential glow on these to make them have some nice bloom and then i merge that over the top it's quite subtle but again just helps everything feel a bit more photo realistic then the cg green lantern goes on top this really has very little comp work done to it there we go that's what that looks like and then finally i've got a volume pass which i forgot to talk about in the last video this is probably something i should have mentioned in the cg section but i rendered a volume pass from blender there's just a big cube that encompasses the whole street so it's the whole shot and it just has a principled volume shader plugged into the volume input of the material and then some noise that's running through it as well then i rendered this on its own in its own collection with everything else set as a hold down which means it just gives me basically the areas of the fog that are lit up by the street lights and stuff in blender and then you also get this really cool effect where the headlights are lighting up the fog as well so you get this kind of dynamic light that's moving with the car and what this helps to do is just add lots of depth into the scene so if i put this over the top of the footage i merged it over quite subtly the mixed values on 0.25 but as you can see it just helps to lift everything up and feel a bit less like it's just a perfectly clean render so you get this kind of atmospheric interaction with the car on the front of the headlights and then it also changes the contrast levels as it goes further back into the screen where you get some more mist in the background it's not something you even really notice when you're looking at the shot but if i show obviously before and after it is there and it's actually making quite a lot of nice difference then again there's some lens dirt this is quite subtle on this shot i think you only see it for a few frames when headlights and stuff flashing past the camera is another good frame where you can see all the interaction from the headlights in the mist pass then i did a bit of a general defocus over the whole thing again just to make it a little bit softer and then finally for all of the cg shots i had this kind of setup that was just creating some of the artifacts of filming with a real lens so the first thing i'm doing is adding some very subtle chromatic aberration this is done just using a chromatic aberration node so you can see what it's doing on the street lights and stuff up here then i'm using a radial which is just like a circular mask in nuke i've inverted it so normally it looks like this and i've just pressed the invert button in the node which makes the edges white and the center black and then i'm using this in a key mix and i'm key mixing in the chromatic aberration using this as a mask which means you won't see any chromatic aberration in the middle just like a real lens but as it gets closer to the edge you'll start to see some of that color shifting as you can see here super super subtle but it's all things like this that help just to make a shot especially a full cg shot feel a bit more photo realistic then i'm adding lens distortion again another artifact of filming through a real lens that people often neglect on cg but it really helps gets rid of all these perfectly straight lines on the streets and makes everything a bit more curved i think this was a 35 mil lens so it's not super distorted but it just adds a bit of warping at the edges and then finally adding some green just like a real shot obviously because it's full cg and i'm also rendering this using optics denoising in blender the source renders are super super clean there's basically no noise in them at all so i'm doing the same trick that i showed before which is an inverted luma key which gives me all the dark areas of the frame and then i'm key mixing some grain over the top of this using that luma key as a mask so you can see the difference here if i just put the grain on the whole thing this is what it looks like but the bright parts in the frame shouldn't get this grainy because that's not how light works so with key mix you can see that the darker areas still get the grain but things that are lighter are a lot less intense and there we go that is how it was done so all the cg shots were done like that they're all pretty similar so i'm not going to talk about all of them but yeah i think it turned out really cool building the streets and everything took me about two weeks so to do all of that work just for four shots in the video that lasted about 12 seconds was a bit soul destroying but what can i say i love doing visual effects so there we go that's how i did it that is the conclusion to the two-part tutorial series on how i did the effects from the green lantern hopefully you guys have enjoyed i know that nuke videos are a bit more of a niche but i get loads of requests to do them because there's less nuke content on youtube as always all of the assets from these videos are on patreon if you're interested i'm going to upload one of these nuke scripts as well probably the the one of the suit transforming annoyingly i use nuke indie which is paid but obviously i want to upload the nuke script for nuke non-commercial so that everyone can use it for free so i'm gonna have to recomposite that shot at some point which i'll probably do in the next couple of days so that'll be on patreon all of the blender files are already on there so if you want to support what i do and you're interested in getting the project files and seeing how it's done they're on there and you're more than welcome to thank you very much for watching consider liking and subscribing if you enjoyed and i'll see you in the next video [music]