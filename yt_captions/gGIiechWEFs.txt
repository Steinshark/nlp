so we are going to look at object object detection with neural networks and we are going to see if us humans detect objects in the same way as neural networks and to do this we are going to trick the neural networks and see if we are tricked in the same way let's do some object detection we're going to take a picture of something so we've got some sunglasses here and then i will email that to myself so we've got the emailed image here which we called image nothing too technical so we can see the sunglasses there we're going to go to matlab and we are going to first of all we're going to load our network and then what we're going to do is we're going to get our image it's a pre-trained network done by someone else for object detection we have to resize it to 224x224 this is the size of image that resnet accepts so it has to be that size so we've got our image and then we can classify it and it'll give us two things back but the one we're most interested in is this variable called cat the category we write that out we've got some sunglasses in our image so what's going on there there is a repository of images online called imagenet and what this is is it's just an array of images that are annotated with an object that's in them and you can submit your neural network or your artificial intelligence to see how well you can classify these images so at the moment the record is about 91 and there's a thousand categories so this is a really difficult task so 91 is pretty good and looking at all of the categories as well they're not things like um cat and dog they're a certain breed of cat and a certain breed of dog so actually very difficult and i imagine most people probably get between 95 and 98 something like that i'm not exactly sure so resnet that we're using um gets about 70 71 which might seem quite low but when you've got a thousand categories it's actually really good and the reason we're using it as well is because it's a bit smaller than some of the other networks and because we're going to be running it a lot of times okay so there is a lot of data inside resnet it's a 44 megabyte download i think and probably about two-thirds of that are just raw numbers so there's millions and millions of parameters in resnet there's been some videos on convolutional neural networks before and this is what we've got here and with this amount of variables it's very hard to understand what's going on on the inside of the network so there are some videos with mike where he's talked about analyzing the layers of the convolutional network to find features and so on and so forth and this is really good however in the networks that are becoming very good at this type of thing there's a lot of layers and there's a lot of numbers in there and as human beings we just can't make sense of that much data it doesn't mean anything to us so how do we try and figure out a little bit of what's going on in here if you give resnet an image we will essentially get a vector of numbers so we've got a thousand categories any image could possibly be and it will give you a value and all these values will add up to one hopefully um specifying how likely it thinks a specific object is in that image so for instance that picture of the sunglasses might have been 0.1 cat or something like that yeah exactly that and we can actually see it on the screens we've got category and we've got res and res actually is this information so it's basically a vector of size 1000 which specifies these odds so if we just plot this when it comes up we should see that it was a likelihood of 0.68 something like that now the other probability is so low you can see a little bit of a spike so it was it thinks that something here so that big pointy spike in a bit that's sunglasses that's sunglasses and if we look at 766 so matlab counts from one but this list is zero so we're looking for seven six five a rocking chair close enough should we check another one it thinks there's a little bit of rocking chair that's like 422 so 421 banister i suppose with the wood a little bit of a chance but it's pretty sure that it's just a pair of sunglasses so you're right sometimes it's really not sure and you get a lot more peaks and it just happens to be the highest one and that's what it classifies um as the object in the image okay so resnet gives you a thousand numbers so if we just do a small one we've got zero point one zero point three and 0.6 so this could be cat dog giraffe so or think that 0.6 being the highest value um for this class it was only outputting three classes you would say it's this one which corresponds to a giraffe these numbers are actually very precise so they have um quite a few numbers after the decimal point so what we can do is we can have an image which we're going to give to resnet and we can focus on one of these classes so this number here 0.3 could be 0.317928 okay so very precise so small changes in the image will affect this if a giraffe is in our picture and 0.6 what we can do is we can just change one pixel in the image just one and we can see how this number changes okay so if it goes ever so slightly up what we could do is we could keep that change and if it goes ever so slightly down or doesn't change at all we can reject that change and if we do this over time we'll be able to make small changes which will change this number and hopefully increase it until that is the category that is seen in the image and not the giraffe so this this number will go down and this one will go up by only changing one pixel at a time and we can keep on doing this and incrementally move more towards a different classification so we're going to do this with a picture of the remote control this is something that we all know what this is uh this is my remote control um from home that i took a photo of what we're gonna do is we're gonna use this image and we are gonna try and trick resnet into misclassifying it and let's say we're gonna turn this remote control into something else so the classes i chose are coffee mug computer keyboard envelope golf ball and photocopier so we're trying to change the original image here of the remote control into another image according to resnet by just making these small incremental changes so we've got our remote control and then we can look and see what um the change that we're made to turn this into a coffee mug and here we go so that's it for all the changes it's made to the image it now thinks that that is over 99 likelihood of being a coffee mug can you see the coffee mug there if it is it's uh it's definitely by one of the more abstract artists exactly right and then we can go computer keyboard i mean there's some space here surrounded by some boundaries i mean it's loose some things happen this is an envelope doesn't like an envelope this is a photocopier and we have a golf ball here which is slightly different it just seems to me that there might be some attempt to get the dimples on the golf ball i mean again it's very very loose we can categorically say that if we gave that to a person they would say there's a remote control in that image and some noise and i can imagine that you know that's you've cropped that remote control to be on a white background but if that was say a carpet or something like that you wouldn't even notice the difference exactly yeah um especially if it was higher resolution as well and you're less able to see those dots um yeah that's very much the case um so something made me think after doing this maybe maybe there's something about remote control which is just inherently confusing maybe i picked a class which is difficult for it to recover from and move to a different class not ever trained to do that so i thought i'll give it a blank slate and start with a completely blank image and then see what representations would it make if it doesn't have to change anything it can just go from blank image to whatever it wants so the same thing just making one incremental change at a time and adding it up until it's 99 sure it's a certain glass this is our coffee mug that looks like the world at night from the iss with just a few lights over africa not a bad shot computer keyboard if we're being truly optimistic that could be a key but it's not the best rendition of a keyboard this is an envelope i say there's not much there but it's i mean these are all 99 sure so it is really sure that these are certain things so here's an interesting one actually the golf ball now it's definitely not a golf ball but it seems that there is an attempt there to make something that looks like the dimples in a golf ball if you're trying to give it the benefit of doubt and that's probably the feature that is most looking for that's what it thinks a golf ball is so not necessarily round per se but these dimples and the last one is the photocopier so something's going on in resnet in a way which we just can't rationalize i'm pretty sure that if you edited a picture and put some pixels in certain places we wouldn't be fooled by it so something like resnet could make a pretty decent attempt to a driverless car so it could probably stay within in between the lines do some accelerating and braking for motorway driving i think it would be pretty good but when you have things like this and things you can't really interpret very well like a little ray of sunshine reflecting off a water drop on a leaf like 20 yards over there and some other things you could get some strange behavior however on aggregate you wouldn't i think so it to actually make an effort to try and sort of spoof these networks and make them misclassify something um is like a dedicated task for it to happen naturally i think is exceptionally rare however um you just don't want it to happen at all and it'll be great if you could understand this and it would be it'd be great for sort of just our understanding and our happiness with this if it did draw a golf ball or something like that so when there's lots of blank space the envelope was quite sparse yeah there's not much going on in envelope so it looked like it made a lot more changes for a golf ball than an envelope but i was thinking how good can we get this i mean with the minimum number of changes minimum number of changes so because you mentioned it was on a white background so the change a bit more obvious but can we get it close enough so that it's really there's really not much going on there so obviously i've shot myself in the foot there with it being a white background because you can notice all the changes but what i did is i went back to my trusty friend the genetic algorithm which we spoke about on a previous video so if you're in the desert and you had one rucksack you'd have to fill it with the most valuable items and the fitness function of the genetic algorithm is just to try and maximize the value of a certain a certain category so the number attracts a certain category so that it changes it from being remote control so it doesn't have to be 99 but if the highest number if it's like for example 70 sure that it's a remote control but we're going to try and change um the likelihood of it being golf but we're going to try and increase that until the golf ball is higher than the original image remote control and we're going to see what that looks like and we're only going to give it a 100 pixels to play with so we've got 224 by 224 which is about 50 000. something like that um pixels and we're going to change 100 of them so can we change the um the categorization resnet gives the remote control by just changing 100 pixels you can which is good so we'll just go through the same five again um we've got our coffee mug here and there we go that's with 100 pixels being changed a lot less information there and that does just look like noise we can't do anything with that information and similarly with computer keyboard 100 pixels not too much of a change there compared to the others and this is our envelope very similar golf ball now doesn't really even have the concept of a dimple in the golf ball so it just looks like random noise and same with the photocopier and i think if we push this hard enough we could probably get it down to about 50 70 pixels or something like that these networks are exceptionally good at categorizing um which objects are are in images however they seem to be doing it in a very different way to us human beings it doesn't quite tie in with our intuition when we did this originally um we didn't know what was going to happen we didn't know if the genetic algorithm or iteratively hill climbing through the image would make something that looked like a coffee mug that would make sense we didn't know that but it turns out it just makes um garbage and puts it on the image and yeah change this classification in particular what we are doing is to 3d print these kind of systems such that in future they can actually be manufactured together with the robot body and have integrity and that's going to be slow except it's not slow because there's hardly any ones in here